<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Feature Summary &bull; Akka Edge</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="Akka Projection."/>
<link rel="canonical" href="https://doc.akka.io/docs/akka-edge/current/feature-summary.html"/>
<script type="text/javascript" src="lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="lib/foundation/dist/js/foundation.min.js"></script>
<link rel="stylesheet" type="text/css" href="lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="lib/foundation/dist/css/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<link rel="stylesheet" type="text/css" href="css/icons.css"/>
<link rel="stylesheet" type="text/css" href="css/page-8.css"/>
<link rel="stylesheet" type="text/css" href="css/banner-2.css"/>
<link rel="shortcut icon" href="images/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png"/>
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png"/>
<link rel="manifest" href="images/manifest.json"/>
<meta name="msapplication-TileImage" content="images/mstile-150x150.png"/>
<meta name="msapplication-TileColor" content="#15a9ce"/>
<meta name="theme-color" content="#15a9ce"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) start -->
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js"  type="text/javascript" charset="UTF-8" data-domain-script="28b912e7-09e9-43d5-91e4-3d1897044004" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) end -->
<!-- Google Tag Manager now loads Google Analytics and any other tracking scripts. GTM also performs respects a users cookie choices-->
<script type="text/javascript">
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KBJGH35');
</script>

</head>

<body id="underlay" data-toggler="nav-open">
<div id="lightbend-banner" class="lightbend-banner akka full-width" data-category="OSS Lightbend Banner Impression" data-label="Akka Banner Impression">
<div class="oss-wrapper">
<div class="oss-brand">
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Lightbend Logo - Akka Banner" href="https://www.lightbend.com">
<img class="lightbend-logo" src="images/banner-logos/lightbend-reverse.svg" alt="Lightbend" title="Lightbend">
</a>
</div>
<div class="oss-ad no-drop-down">
<nav id="lightbendRotator" class="lightbend-rotator">
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Promo Rotator - Introducing Akka Cloud to Edge Continuum. Build once for the Cloud. Seamlessly deploy to the Edge. [Learn more] - Akka Banner" href="https://www.lightbend.com/blog/akka-edge-unifying-the-cloud-and-edge">
Introducing Akka Cloud to Edge Continuum. Build once for the Cloud. Seamlessly deploy to the Edge. <span class="akka-btn">Learn more</span>
</a>
</nav>
</div>
</div>
</div>

<header class="site-header hide-for-large">
<div class="sticky-header clearfix">
<a href="https://akka.io"><img class="logo" src="images/akka-logo-reverse.svg"/></a>

<button class="menu-icon float-right" type="button" data-toggle="underlay overlay"></button>
</div>
<div id="overlay" class="overlay-nav" data-toggler="nav-open">
<header class="nav-header">
<div class="nav-header-title">
<h1><a href="index.html">Akka Edge</a></h1>
</div>
<div class="nav-header-version">
Version 1.5.1
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
</div>
</header>
<nav class="nav-toc">
<ul>
  <li><a href="overview.html" class="page">Architectural Overview</a></li>
  <li><a href="use-cases.html" class="page">Example Use Cases</a></li>
  <li><a href="feature-summary.html#feature-summary" class="active page">Feature Summary</a>
  <ul>
    <li><a href="feature-summary.html#projections-over-grpc" class="header">Projections over gRPC</a></li>
    <li><a href="feature-summary.html#replicated-event-sourcing-over-grpc" class="header">Replicated Event Sourcing over gRPC</a></li>
  </ul></li>
  <li><a href="guide.html" class="page">Guide</a></li>
  <li><a href="lightweight-deployments.html" class="page">Lightweight deployments</a></li>
</ul>
</nav>
</div>
</header>
<div class="site-content-wrapper">
<aside class="sticky-sidebar show-for-large">
<header class="nav-header sticky-sidebar-header">
<div class="nav-header-title">
<h1><a href="index.html">Akka Edge</a></h1>
</div>
<div class="nav-header-version">
Version 1.5.1
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
</div>
</header>
<nav class="site-nav sticky-sidebar-contents">
<div class="nav-toc">
<ul>
  <li><a href="overview.html" class="page">Architectural Overview</a></li>
  <li><a href="use-cases.html" class="page">Example Use Cases</a></li>
  <li><a href="feature-summary.html#feature-summary" class="active page">Feature Summary</a>
  <ul>
    <li><a href="feature-summary.html#projections-over-grpc" class="header">Projections over gRPC</a></li>
    <li><a href="feature-summary.html#replicated-event-sourcing-over-grpc" class="header">Replicated Event Sourcing over gRPC</a></li>
  </ul></li>
  <li><a href="guide.html" class="page">Guide</a></li>
  <li><a href="lightweight-deployments.html" class="page">Lightweight deployments</a></li>
</ul>
</div>
</nav>
<footer class="nav-footer sticky-sidebar-footer">
<a href="https://akka.io"><img class="logo" src="images/akka-logo-reverse.svg"/></a>

</footer>
</aside>
<main class="fixed-shift-for-large expanded row">
<section class="site-content small-12 column">
<article class="page-content row">
<div class="small-12 column" id="docs">
<h1><a href="#feature-summary" name="feature-summary" class="anchor"><span class="anchor-link"></span></a>Feature Summary</h1>
<p>Akka Edge has two main features:</p>
<ol>
  <li>Projections over gRPC - asynchronous brokerless service-to-service communication</li>
  <li>Replicated Event Sourcing over gRPC - active-active entities</li>
</ol>
<h2><a href="#projections-over-grpc" name="projections-over-grpc" class="anchor"><span class="anchor-link"></span></a>Projections over gRPC</h2>
<p>You would use Projections over gRPC to implement asynchronous brokerless communication between services implemented with Akka.</p>
<p>We often recommend asynchronous communication between Microservices by using a message broker, such as Kafka. With Projections over gRPC you could have the same advantages of loosely coupled and reliable message delivery without the burden and cost of operating the broker infrastructure. As a bonus, you would gain low-latency delivery of messages.</p>
<p><img src="images/projection-over-grpc.svg" alt="Diagram showing services using projections over gRPC with one producer and two consumers" /></p>
<p>Projections over gRPC uses the event journal on the producer side and Akka Projections event processing and offset tracking on the consumer side. The transparent data transfer between producers and consumers is implemented with gRPC.</p>
<p>The consumer starts an event stream by asking the producer to stream events from the consumer&rsquo;s last offset. Several consumer services can connect to the same producer service, and each consumer can process the events in its own pace independent of how fast the events are created or how fast other consumers can handle the events.</p>
<p>In the same way as for any Akka Projection, the consumer keeps track of the offset for the last event it has processed so that it can continue from the last offset in case of errors or restarts. Offsets are also used for event de-duplication to achieve exactly-once processing.</p>
<p>Filters can be used when a consumer is only interested in a subset of the entities. The filters can be defined on both the producer side and on the consumer side, and they can be changed at runtime.</p><div class="callout note "><div class="callout-title">Note</div>
<p>Events are stored on the producer side. There is no direct storage access between a consumer and producer. The offsets on the consumer side are also stored, but that is a different form of storage to that of the producer.</p></div>
<h3><a href="#edge-is-consumer" name="edge-is-consumer" class="anchor"><span class="anchor-link"></span></a>Edge is consumer</h3>
<p>This case describes when the edge service is the consumer of events.</p>
<p><img src="images/edge-consumer.svg" alt="Diagram showing projections over gRPC with edge as consumer" /></p>
<ul>
  <li>The edge consumer service connects to the producer service to initiate the event stream flowing from the producer.</li>
  <li>The edge consumer starts from the offset that it has stored, or from the beginning if no offset is stored.</li>
  <li>Events are read from the journal on the producer side and emitted to the replication stream.</li>
  <li>Events are handled on the consumer side and corresponding offset is stored.</li>
  <li>New events are emitted from the producer.</li>
  <li>The stream remains open until either side chooses to close it, or there is an error.</li>
</ul>
<p>The offsets on the consumer side are stored, but if the environment for the edge service does not have the capabilities to run a full database it can be a single Akka node with an embeddable storage such as the <a href="https://doc.akka.io/docs/akka-persistence-r2dbc/1.2.1/getting-started.html#using-h2">H2 database</a>.</p>
<p>Note that when using H2, the file mode is recommended to reduce memory requirements. That means that if the edge service is restarted with a different file system all previous events will be delivered to the consumer again.</p>
<p>To reduce the amount of events sent over the network you can use <a href="https://doc.akka.io/docs/akka-projection/1.5/grpc.html#starting-from-snapshots">snapshots as starting points</a>. You can also <a href="https://doc.akka.io/docs/akka-projection/1.5/grpc.html#start-from-custom-offset">start from custom offset</a>, e.g. an offset a few hours back in time.</p>
<p>When you have many edge consumer services connected to the same producer service it&rsquo;s recommended to enable the feature for <a href="https://doc.akka.io/docs/akka-projection/1.5/grpc.html#many-consumers">many consumers</a>. The purpose of that feature is to share the stream of events from storage and fan out to connected consumer streams.</p>
<h3><a href="#edge-is-producer" name="edge-is-producer" class="anchor"><span class="anchor-link"></span></a>Edge is producer</h3>
<p>This case describes when the edge service is the producer of events.</p>
<p><img src="images/edge-producer.svg" alt="Diagram showing projections over gRPC with edge as consumer" /></p>
<ul>
  <li>The edge producer service connects to the consumer service to initiate the event stream flowing from the producer.</li>
  <li>The edge producer starts from the offset that it has stored, or from the beginning if no offset is stored.</li>
  <li>Events are read from the journal on the producer side and emitted to the replication stream.</li>
  <li>The consumer writes incoming events directly to its journal, and acknowledge back to the producer.</li>
  <li>When acknowledged, the corresponding offset is stored on the producer side.</li>
  <li>New events are emitted from the producer.</li>
  <li>The stream remains open until either side chooses to close it, or there is an error.</li>
  <li>On the consumer side, separate projections can run over the local journal with events from all producers.</li>
</ul>
<p>There are actually two projections here. One projection for the event replication from producer to consumer, without application specific processing of the events other than transformation and filtering. Then a second, ordinary, projection on the consumer side to process the events.</p>
<p>Note that the connection is established from the edge service. For this you need to setup <a href="https://doc.akka.io/docs/akka-projection/1.5/grpc-producer-push.html">Akka Projection gRPC with producer push</a>.</p><div class="callout note "><div class="callout-title">Note</div>
<p>If you can establish the connection in the other direction, from the cloud consumer to the edge producer, you may instead use an ordinary <a href="https://doc.akka.io/docs/akka-projection/1.5/grpc.html">Akka Projection over gRPC</a> without the producer push mechanism. That is often difficult for the edge, but with a VPN solution it could be possible. Another challenge is that the cloud service would need to know about all edge services.</p></div>
<p>Events are stored on the producer side, but if the environment for the edge service does not have the capabilities to run a full database it can be a single Akka node with embeddable storage such as the <a href="https://doc.akka.io/docs/akka-persistence-r2dbc/1.2.1/getting-started.html#using-h2">H2 database</a>.</p>
<p>Note that the file mode of H2 is recommended to reduce memory requirements. That means that if the edge service is restarted with a different file system all stored events are lost. For some edge services that may be totally fine, for others it may not be an option.</p>
<h3><a href="#durable-state-as-source-of-events" name="durable-state-as-source-of-events" class="anchor"><span class="anchor-link"></span></a>Durable State as source of events</h3>
<p>Projections over gRPC requires events, and are therefore typically used with <code>EventSourcedBehavior</code>. <code>DurableStateBehavior</code> can also be the source of events and be used with Projections over gRPC. For <code>DurableStateBehavior</code> you need to use change events as described in <a href="https://doc.akka.io/docs/akka-projection/1.5/durable-state.html#sourceprovider-for-eventsbyslices">Changes from Durable State</a>.</p>
<h3><a href="#learn-more" name="learn-more" class="anchor"><span class="anchor-link"></span></a>Learn more</h3>
<ul>
  <li><a href="guide.html">Hands-on guide for implementing an Akka Edge application</a></li>
  <li><a href="https://doc.akka.io/docs/akka-projection/1.5/grpc.html">Reference documentation of Akka Projection gRPC</a></li>
  <li><a href="https://doc.akka.io/docs/akka-projection/1.5/grpc-producer-push.html">Reference documentation of Akka Projection gRPC with producer push</a></li>
</ul>
<h2><a href="#replicated-event-sourcing-over-grpc" name="replicated-event-sourcing-over-grpc" class="anchor"><span class="anchor-link"></span></a>Replicated Event Sourcing over gRPC</h2>
<p>You would use Replicated Event Sourcing over gRPC for entities that can be updated in more than one geographical location, such as edge Point-of-Presence (PoP) and different cloud regions. This makes it possible to implement patterns such as active-active and hot standby.</p>
<p><img src="images/edge-res.svg" alt="Diagram showing services using Replicated Event Sourcing over gRPC between cloud and edge services" /></p>
<p>Replicated Event Sourcing gives:</p>
<ul>
  <li>redundancy to tolerate failures in one location and still be operational</li>
  <li>serve requests from a location near the user to provide better responsiveness</li>
  <li>allow updates to an entity from several locations</li>
  <li>balance the load over many servers</li>
</ul>
<p>The replicas of the entities are running in separate Akka Clusters in the cloud and edge. A reliable event replication transport over gRPC is used between the Akka Clusters. The replica entities belong to the same logical Microservice, i.e. same <a href="https://martinfowler.com/bliki/BoundedContext.html">Bounded Context</a> in Domain-Driven Design (DDD) terminology.</p>
<p>Note that the connection is established from the edge service. For this you need to setup <a href="https://doc.akka.io/docs/akka-projection/1.5/grpc-replicated-event-sourcing-transport.html#edge-topology">Akka Replicated Event Sourcing gRPC with edge topology</a>.</p>
<p>Filters can be used to define that a subset of the entities should be replicated to certain locations. The filters can be changed at runtime.</p><div class="callout note "><div class="callout-title">Note</div>
<p>Events are stored in a database for each replica. There is no direct database access between a replica and the database of another replica, which means different databases, and even different database products, can be used for the replicas. For example, Postgres in the Cloud and H2 at the edge.</p></div>
<h3><a href="#learn-more" name="learn-more" class="anchor"><span class="anchor-link"></span></a>Learn more</h3>
<ul>
  <li>FIXME link to guide</li>
  <li><a href="https://doc.akka.io/docs/akka/2.9/typed/replicated-eventsourcing.html">Reference documentation of Akka Replicated Event Sourcing</a></li>
  <li><a href="https://doc.akka.io/docs/akka-projection/1.5/grpc-replicated-event-sourcing-transport.html">Reference documentation of Akka Replicated Event Sourcing over gRPC</a></li>
</ul>
</div>
</article>
<div class="row">
<div class="small-12 column">
<section class="nav-prev-next row">
<div class="nav-prev small-6 column">
<a href="use-cases.html"><i class="icon-prev"></i> <span class="link-prev">Example Use Cases</span></a>
</div>
<div class="nav-next small-6 column clearfix">
<a class="float-right" href="guide.html">Guide <i class="icon-next"></i></a>
</div>
</section>
</div>
</div>
<div class="source-github row">
Found an error in this documentation? The source code for this page can be found <a href="https://github.com/akka/akka-projection/tree/master/akka-edge-docs/src/main/paradox/feature-summary.md">here</a>.
Please feel free to edit and contribute a pull request.
</div>

<footer class="page-footer row clearfix">
<img class="akka-icon float-left show-for-medium" src="images/akka-icon.svg" />
<section class="copyright">
<div>Akka Edge is available under the <a href="https://www.lightbend.com/akka/license" target="_blank">Business Source License 1.1</a>.</div>
<p class="legal">
&copy; 2011-2023 <a href="https://www.lightbend.com" target="_blank">Lightbend, Inc.</a> |
<a href="https://www.lightbend.com/legal/licenses" target="_blank">Licenses</a> |
<a href="https://www.lightbend.com/legal/terms" target="_blank">Terms</a> |
<a href="https://www.lightbend.com/legal/privacy" target="_blank">Privacy Policy</a> |
<a href="https://akka.io/cookie/" target="_blank">Cookie Listing</a> |
<a class="optanon-toggle-display">Cookie Settings</a>
</p>
</section>

</footer>
</section>
</main>
</div>

<script type="text/javascript" src="js/scrollsneak.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="js/groups.js"></script>
<script type="text/javascript" src="js/page.js"></script>
<script type="text/javascript" src="js/snippets.js"></script>
<script type="text/javascript" src="js/magellan.js"></script>
<script type="text/javascript" src="js/metadata-toggle.js"></script>
<script type="text/javascript" src="js/lbHeader.js"></script>

<style type="text/css">@import "lib/prettify/prettify.css";</style>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(){window.prettyPrint && prettyPrint()});
//]]></script>
<!-- hook for including project specific javascript into the generated docs -->

</body>
</html>
