<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Routes · Akka HTTP</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='akka-http-docs'/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../js/page.js"></script>
<link rel="stylesheet" type="text/css" href="../../../lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="../../../lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="../../../css/page.css"/>

<!--
<link rel="shortcut icon" href="../../../images/favicon.ico" />
-->
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="../../../index.html" >
<span class="home-icon">⌂</span>Akka HTTP
</a>
<div class="version-number">
10.0.1
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../../../java.html">Java Documentation</a>
  <ul>
    <li><a href="../../../java/http/index.html">Akka HTTP</a>
    <ul>
      <li><a href="../../../java/http/introduction.html">Introduction</a></li>
      <li><a href="../../../java/http/configuration.html">Configuration</a></li>
      <li><a href="../../../java/http/common/index.html">Common Abstractions (Client- and Server-Side)</a></li>
      <li><a href="../../../java/http/implications-of-streaming-http-entity.html">Implications of the streaming nature of Request/Response Entities</a></li>
      <li><a href="../../../java/http/server-side/low-level-server-side-api.html">Low-Level Server-Side API</a></li>
      <li><a href="../../../java/http/routing-dsl/index.html">High-level Server-Side API</a></li>
      <li><a href="../../../java/http/server-side/websocket-support.html">Server-Side WebSocket Support</a></li>
      <li><a href="../../../java/http/client-side/index.html">Consuming HTTP-based Services (Client-Side)</a></li>
      <li><a href="../../../java/http/server-side-https-support.html">Server-Side HTTPS Support</a></li>
      <li><a href="../../../java/http/migration-guide/index.html">Migration Guides (Java)</a></li>
    </ul></li>
  </ul></li>
  <li><a href="../../../scala.html">Scala Documentation</a>
  <ul>
    <li><a href="../../../scala/http/index.html">Akka HTTP</a>
    <ul>
      <li><a href="../../../scala/http/introduction.html">Introduction</a></li>
      <li><a href="../../../scala/http/configuration.html">Configuration</a></li>
      <li><a href="../../../scala/http/common/index.html">Common Abstractions (Client- and Server-Side)</a></li>
      <li><a href="../../../scala/http/implications-of-streaming-http-entity.html">Implications of the streaming nature of Request/Response Entities</a></li>
      <li><a href="../../../scala/http/low-level-server-side-api.html">Low-Level Server-Side API</a></li>
      <li><a href="../../../scala/http/routing-dsl/index.html">High-level Server-Side API</a></li>
      <li><a href="../../../scala/http/websocket-support.html">Server-Side WebSocket Support</a></li>
      <li><a href="../../../scala/http/client-side/index.html">Consuming HTTP-based Services (Client-Side)</a></li>
      <li><a href="../../../scala/http/server-side-https-support.html">Server-Side HTTPS Support</a></li>
      <li><a href="../../../scala/http/handling-blocking-operations-in-akka-http-routes.html">Handling blocking operations in Akka HTTP</a></li>
      <li><a href="../../../scala/http/migration-guide/index.html">Migration Guides</a></li>
    </ul></li>
  </ul></li>
  <li><a href="../../../security.html">Security announcements</a></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<header class="site-header expanded row">
<div class="small-12 column">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title"><a href="../../../index.html">Akka HTTP</a></div>

<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column">
<nav class="site-nav">
<div class="nav-home">
<a href="../../../index.html" >
<span class="home-icon">⌂</span>Akka HTTP
</a>
<div class="version-number">
10.0.1
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../../../java.html">Java Documentation</a>
  <ul>
    <li><a href="../../../java/http/index.html">Akka HTTP</a>
    <ul>
      <li><a href="../../../java/http/introduction.html">Introduction</a></li>
      <li><a href="../../../java/http/configuration.html">Configuration</a></li>
      <li><a href="../../../java/http/common/index.html">Common Abstractions (Client- and Server-Side)</a></li>
      <li><a href="../../../java/http/implications-of-streaming-http-entity.html">Implications of the streaming nature of Request/Response Entities</a></li>
      <li><a href="../../../java/http/server-side/low-level-server-side-api.html">Low-Level Server-Side API</a></li>
      <li><a href="../../../java/http/routing-dsl/index.html">High-level Server-Side API</a></li>
      <li><a href="../../../java/http/server-side/websocket-support.html">Server-Side WebSocket Support</a></li>
      <li><a href="../../../java/http/client-side/index.html">Consuming HTTP-based Services (Client-Side)</a></li>
      <li><a href="../../../java/http/server-side-https-support.html">Server-Side HTTPS Support</a></li>
      <li><a href="../../../java/http/migration-guide/index.html">Migration Guides (Java)</a></li>
    </ul></li>
  </ul></li>
  <li><a href="../../../scala.html">Scala Documentation</a>
  <ul>
    <li><a href="../../../scala/http/index.html">Akka HTTP</a>
    <ul>
      <li><a href="../../../scala/http/introduction.html">Introduction</a></li>
      <li><a href="../../../scala/http/configuration.html">Configuration</a></li>
      <li><a href="../../../scala/http/common/index.html">Common Abstractions (Client- and Server-Side)</a></li>
      <li><a href="../../../scala/http/implications-of-streaming-http-entity.html">Implications of the streaming nature of Request/Response Entities</a></li>
      <li><a href="../../../scala/http/low-level-server-side-api.html">Low-Level Server-Side API</a></li>
      <li><a href="../../../scala/http/routing-dsl/index.html">High-level Server-Side API</a></li>
      <li><a href="../../../scala/http/websocket-support.html">Server-Side WebSocket Support</a></li>
      <li><a href="../../../scala/http/client-side/index.html">Consuming HTTP-based Services (Client-Side)</a></li>
      <li><a href="../../../scala/http/server-side-https-support.html">Server-Side HTTPS Support</a></li>
      <li><a href="../../../scala/http/handling-blocking-operations-in-akka-http-routes.html">Handling blocking operations in Akka HTTP</a></li>
      <li><a href="../../../scala/http/migration-guide/index.html">Migration Guides</a></li>
    </ul></li>
  </ul></li>
  <li><a href="../../../security.html">Security announcements</a></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column">
<section class="site-content">

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="../../../index.html">Akka HTTP</a></li>
  <li><a href="../../../scala.html">Scala Documentation</a></li>
  <li><a href="../../../scala/http/index.html">Akka HTTP</a></li>
  <li><a href="../../../scala/http/routing-dsl/index.html">High-level Server-Side API</a></li>
  <li>Routes</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<a id="routes"></a>
<h1><a href="#routes" name="routes" class="anchor"><span class="anchor-link"></span></a>Routes</h1>
<p>The &ldquo;Route&rdquo; is the central concept of Akka HTTP&rsquo;s Routing DSL. All the structures you build with the DSL, no matter whether they consists of a single line or span several hundred lines, are instances of this type:</p>
<pre class="prettyprint"><code class="language-scala">type Route = RequestContext =&gt; Future[RouteResult]
</code></pre>
<p>It&rsquo;s a simple alias for a function turning a <code>RequestContext</code> into a <code>Future[RouteResult]</code>.</p>
<p>Generally when a route receives a request (or rather a <code>RequestContext</code> for it) it can do one of these things:</p>
<ul>
  <li>Complete the request by returning the value of <code>requestContext.complete(...)</code></li>
  <li>Reject the request by returning the value of <code>requestContext.reject(...)</code> (see <a href="rejections.html#rejections-scala">Rejections</a>)</li>
  <li>Fail the request by returning the value of <code>requestContext.fail(...)</code> or by just throwing an exception (see <a href="exception-handling.html#exception-handling-scala">Exception Handling</a>)</li>
  <li>Do any kind of asynchronous processing and instantly return a <code>Future[RouteResult]</code> to be eventually completed later</li>
</ul>
<p>The first case is pretty clear, by calling <code>complete</code> a given response is sent to the client as reaction to the request. In the second case &ldquo;reject&rdquo; means that the route does not want to handle the request. You&rsquo;ll see further down in the section about route composition what this is good for.</p>
<p>A <code>Route</code> can be &ldquo;sealed&rdquo; using <code>Route.seal</code>, which relies on the in-scope <code>RejectionHandler</code> and <code>ExceptionHandler</code> instances to convert rejections and exceptions into appropriate HTTP responses for the client. <a href="routes.html#sealing-a-route">Sealing a Route</a> is described more in detail later. </p>
<p>Using <code>Route.handlerFlow</code> or <code>Route.asyncHandler</code> a <code>Route</code> can be lifted into a handler <code>Flow</code> or async handler function to be used with a <code>bindAndHandleXXX</code> call from the <a href="../low-level-server-side-api.html#http-low-level-server-side-api">Low-Level Server-Side API</a>.</p>
<p>Note: There is also an implicit conversion from <code>Route</code> to <code>Flow[HttpRequest, HttpResponse, Unit]</code> defined in the <code>RouteResult</code> companion, which relies on <code>Route.handlerFlow</code>.</p>
<a id="requestcontext"></a>
<h2><a href="#requestcontext" name="requestcontext" class="anchor"><span class="anchor-link"></span></a>RequestContext</h2>
<p>The request context wraps an <code>HttpRequest</code> instance to enrich it with additional information that are typically required by the routing logic, like an <code>ExecutionContext</code>, <code>Materializer</code>, <code>LoggingAdapter</code> and the configured <code>RoutingSettings</code>. It also contains the <code>unmatchedPath</code>, a value that describes how much of the request URI has not yet been matched by a <a href="directives/path-directives/index.html#pathdirectives">Path Directive</a>.</p>
<p>The <code>RequestContext</code> itself is immutable but contains several helper methods which allow for convenient creation of modified copies.</p>
<a id="routeresult"></a>
<h2><a href="#routeresult" name="routeresult" class="anchor"><span class="anchor-link"></span></a>RouteResult</h2>
<p><code>RouteResult</code> is a simple abstract data type (ADT) that models the possible non-error results of a <code>Route</code>. It is defined as such:</p>
<pre class="prettyprint"><code class="language-scala">sealed trait RouteResult

object RouteResult {
  final case class Complete(response: HttpResponse) extends RouteResult
  final case class Rejected(rejections: immutable.Seq[Rejection]) extends RouteResult
}
</code></pre>
<p>Usually you don&rsquo;t create any <code>RouteResult</code> instances yourself, but rather rely on the pre-defined <a href="directives/route-directives/index.html#routedirectives">RouteDirectives</a> (like <a href="directives/route-directives/complete.html#complete">complete</a>, <a href="directives/route-directives/reject.html#reject">reject</a> or <a href="directives/route-directives/redirect.html#redirect">redirect</a>) or the respective methods on the <a href="#requestcontext">RequestContext</a> instead.</p>
<h2><a href="#composing-routes" name="composing-routes" class="anchor"><span class="anchor-link"></span></a>Composing Routes</h2>
<p>There are three basic operations we need for building more complex routes from simpler ones:</p>
<ul>
  <li>Route transformation, which delegates processing to another, &ldquo;inner&rdquo; route but in the process changes some properties of either the incoming request, the outgoing response or both</li>
  <li>Route filtering, which only lets requests satisfying a given filter condition pass and rejects all others</li>
  <li>Route chaining, which tries a second route if a given first one was rejected</li>
</ul>
<p>The last point is achieved with the concatenation operator <code>~</code>, which is an extension method that becomes available when you <code>import akka.http.scaladsl.server.Directives._</code>. The first two points are provided by so-called <a href="directives/index.html#directives">Directives</a> of which a large number is already predefined by Akka HTTP and which you can also easily create yourself. <a href="directives/index.html#directives">Directives</a> deliver most of Akka HTTP&rsquo;s power and flexibility.</p>
<a id="the-routing-tree"></a>
<h2><a href="#the-routing-tree" name="the-routing-tree" class="anchor"><span class="anchor-link"></span></a>The Routing Tree</h2>
<p>Essentially, when you combine directives and custom routes via nesting and the <code>~</code> operator, you build a routing structure that forms a tree. When a request comes in it is injected into this tree at the root and flows down through all the branches in a depth-first manner until either some node completes it or it is fully rejected.</p>
<p>Consider this schematic example:</p>
<pre class="prettyprint"><code class="language-scala">val route =
  a {
    b {
      c {
        ... // route 1
      } ~
      d {
        ... // route 2
      } ~
      ... // route 3
    } ~
    e {
      ... // route 4
    }
  }
</code></pre>
<p>Here five directives form a routing tree.</p>
<ul>
  <li>Route 1 will only be reached if directives <code>a</code>, <code>b</code> and <code>c</code> all let the request pass through.</li>
  <li>Route 2 will run if <code>a</code> and <code>b</code> pass, <code>c</code> rejects and <code>d</code> passes.</li>
  <li>Route 3 will run if <code>a</code> and <code>b</code> pass, but <code>c</code> and <code>d</code> reject.</li>
</ul>
<p>Route 3 can therefore be seen as a &ldquo;catch-all&rdquo; route that only kicks in, if routes chained into preceding positions reject. This mechanism can make complex filtering logic quite easy to implement: simply put the most specific cases up front and the most general cases in the back.</p>
<h2><a href="#sealing-a-route" name="sealing-a-route" class="anchor"><span class="anchor-link"></span></a>Sealing a Route</h2>
<p>As described in <a href="rejections.html#rejections-scala">Rejections</a> and <a href="exception-handling.html#exception-handling-scala">Exception Handling</a>, there are generally two ways to handle rejections and exceptions.</p>
<ul>
  <li>Bring rejection/exception handlers into implicit scope at the top-level</li>
  <li>Supply handlers as arguments to <a href="directives/execution-directives/handleRejections.html#handlerejections">handleRejections</a> and <a href="directives/execution-directives/handleExceptions.html#handleexceptions">handleExceptions</a> directives</li>
</ul>
<p>In the first case your handlers will be &ldquo;sealed&rdquo;, (which means that it will receive the default handler as a fallback for all cases your handler doesn&rsquo;t handle itself) and used for all rejections/exceptions that are not handled within the route structure itself.</p>
<h3><a href="#route-seal-method-to-modify-httpresponse" name="route-seal-method-to-modify-httpresponse" class="anchor"><span class="anchor-link"></span></a>Route.seal() method to modify HttpResponse</h3>
<p>In application code, unlike <a href="testkit.html#testing-sealed-routes">test code</a>, you don&rsquo;t need to use the <code>Route.seal()</code> method to seal a route. As long as you bring implicit rejection and/or exception handlers to the top-level scope, your route is sealed. </p>
<p>However, you can use <code>Route.seal()</code> to perform modification on HttpResponse from the route. For example, if you want to add a special header, but still use the default rejection handler, then you can do the following. In the below case, the special header is added to rejected responses which did not match the route, as well as successful responses which matched the route.</p>
<pre class="prettyprint"><code class="language-scala">val route = respondWithHeader(RawHeader(&quot;special-header&quot;, &quot;you always have this even in 404&quot;)) {
  Route.seal(
    get {
      pathSingleSlash {
        complete { &quot;Captain on the bridge!&quot; }
      }
    }
  )
}</code></pre>
<div class="nav-next">
<p><strong>Next:</strong> <a href="../../../scala/http/routing-dsl/directives/index.html">Directives</a></p>
</div>
</div>
<div class="large-3 show-for-large column" data-sticky-container>
<nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
<div class="page-nav">
<div class="nav-title">On this page:</div>
<div class="nav-toc">
<ul>
  <li><a href="../../../scala/http/routing-dsl/routes.html#routes">Routes</a>
  <ul>
    <li><a href="../../../scala/http/routing-dsl/routes.html#requestcontext">RequestContext</a></li>
    <li><a href="../../../scala/http/routing-dsl/routes.html#routeresult">RouteResult</a></li>
    <li><a href="../../../scala/http/routing-dsl/routes.html#composing-routes">Composing Routes</a></li>
    <li><a href="../../../scala/http/routing-dsl/routes.html#the-routing-tree">The Routing Tree</a></li>
    <li><a href="../../../scala/http/routing-dsl/routes.html#sealing-a-route">Sealing a Route</a>
    <ul>
      <li><a href="../../../scala/http/routing-dsl/routes.html#route-seal-method-to-modify-httpresponse">Route.seal() method to modify HttpResponse</a></li>
    </ul></li>
  </ul></li>
</ul>
</div>
</div>
</nav>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2016</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="../../../lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../../../js/magellan.js"></script>

<style type="text/css">@import "../../../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../../../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../../../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>

</html>
