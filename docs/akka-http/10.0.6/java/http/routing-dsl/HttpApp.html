<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
  <title>HttpApp Bootstrap · Akka HTTP</title>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content='akka-http-docs'/>
  <link
      href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc"
      rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="../../../lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="../../../js/page.js"></script>
  <link rel="stylesheet" type="text/css" href="../../../lib/normalize.css/normalize.css"/>
  <link rel="stylesheet" type="text/css" href="../../../lib/foundation/dist/foundation.min.css"/>
  <link rel="stylesheet" type="text/css" href="../../../css/page.css"/>


  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"/>
</head>

<body>
<div class="off-canvas-wrapper">
  <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

    <div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
      <nav class="off-canvas-nav">
        <div class="nav-home">
        <a href="../../../index.html" >
        <span class="home-icon">⌂</span>Akka HTTP
        </a>
        <div class="version-number">
        10.0.6
        </div>
        </div>
        <div class="nav-toc">
        <ul>
          <li><a href="../../../security.html">Security announcements</a></li>
          <li><a href="../../../release-notes.html">Release Notes</a></li>
          <li><a href="../../../java.html">Java Documentation</a>
          <ul>
            <li><a href="../../../java/http/index.html">Akka HTTP</a>
            <ul>
              <li><a href="../../../java/http/introduction.html">Introduction</a></li>
              <li><a href="../../../java/http/configuration.html">Configuration</a></li>
              <li><a href="../../../java/http/common/index.html">Common Abstractions (Client- and Server-Side)</a></li>
              <li><a href="../../../java/http/implications-of-streaming-http-entity.html">Implications of the streaming nature of Request/Response Entities</a></li>
              <li><a href="../../../java/http/server-side/low-level-server-side-api.html">Low-Level Server-Side API</a></li>
              <li><a href="../../../java/http/routing-dsl/index.html">High-level Server-Side API</a></li>
              <li><a href="../../../java/http/server-side/websocket-support.html">Server-Side WebSocket Support</a></li>
              <li><a href="../../../java/http/client-side/index.html">Consuming HTTP-based Services (Client-Side)</a></li>
              <li><a href="../../../java/http/server-side-https-support.html">Server-Side HTTPS Support</a></li>
              <li><a href="../../../java/http/migration-guide/index.html">Migration Guides (Java)</a></li>
            </ul></li>
          </ul></li>
          <li><a href="../../../scala.html">Scala Documentation</a>
          <ul>
            <li><a href="../../../scala/http/index.html">Akka HTTP</a>
            <ul>
              <li><a href="../../../scala/http/introduction.html">Introduction</a></li>
              <li><a href="../../../scala/http/configuration.html">Configuration</a></li>
              <li><a href="../../../scala/http/common/index.html">Common Abstractions (Client- and Server-Side)</a></li>
              <li><a href="../../../scala/http/implications-of-streaming-http-entity.html">Implications of the streaming nature of Request/Response Entities</a></li>
              <li><a href="../../../scala/http/low-level-server-side-api.html">Low-Level Server-Side API</a></li>
              <li><a href="../../../scala/http/routing-dsl/index.html">High-level Server-Side API</a></li>
              <li><a href="../../../scala/http/websocket-support.html">Server-Side WebSocket Support</a></li>
              <li><a href="../../../scala/http/client-side/index.html">Consuming HTTP-based Services (Client-Side)</a></li>
              <li><a href="../../../scala/http/server-side-https-support.html">Server-Side HTTPS Support</a></li>
              <li><a href="../../../scala/http/handling-blocking-operations-in-akka-http-routes.html">Handling blocking operations in Akka HTTP</a></li>
              <li><a href="../../../scala/http/migration-guide/index.html">Migration Guides</a></li>
            </ul></li>
          </ul></li>
        </ul>
        </div>

      </nav>
    </div>

    <div class="off-canvas-content" data-off-canvas-content>

      <header class="site-header expanded row">
        <div class="small-12 column">
          <a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>

          <img src="../../../css/../mini-akka-logo.png" alt="Akka logo" style="float: left"/> <div class="title"><a href="../../../index.html">Akka HTTP</a></div>


          <div style="position: relative; right:0; min-width:25%" class="float-right">
            <input type="search" id="search" class="form-control" style="margin: 10px 0;" placeholder="Search the docs..."/>
          </div>

        </div>
      </header>

      <div class="expanded row">

        <div class="medium-3 large-2 show-for-medium column">

          <nav class="site-nav">
            <div class="nav-home">
            <a href="../../../index.html" >
            <span class="home-icon">⌂</span>Akka HTTP
            </a>
            <div class="version-number">
            10.0.6
            </div>
            </div>
            <div class="nav-toc">
            <ul>
              <li><a href="../../../security.html">Security announcements</a></li>
              <li><a href="../../../release-notes.html">Release Notes</a></li>
              <li><a href="../../../java.html">Java Documentation</a>
              <ul>
                <li><a href="../../../java/http/index.html">Akka HTTP</a>
                <ul>
                  <li><a href="../../../java/http/introduction.html">Introduction</a></li>
                  <li><a href="../../../java/http/configuration.html">Configuration</a></li>
                  <li><a href="../../../java/http/common/index.html">Common Abstractions (Client- and Server-Side)</a></li>
                  <li><a href="../../../java/http/implications-of-streaming-http-entity.html">Implications of the streaming nature of Request/Response Entities</a></li>
                  <li><a href="../../../java/http/server-side/low-level-server-side-api.html">Low-Level Server-Side API</a></li>
                  <li><a href="../../../java/http/routing-dsl/index.html">High-level Server-Side API</a></li>
                  <li><a href="../../../java/http/server-side/websocket-support.html">Server-Side WebSocket Support</a></li>
                  <li><a href="../../../java/http/client-side/index.html">Consuming HTTP-based Services (Client-Side)</a></li>
                  <li><a href="../../../java/http/server-side-https-support.html">Server-Side HTTPS Support</a></li>
                  <li><a href="../../../java/http/migration-guide/index.html">Migration Guides (Java)</a></li>
                </ul></li>
              </ul></li>
              <li><a href="../../../scala.html">Scala Documentation</a>
              <ul>
                <li><a href="../../../scala/http/index.html">Akka HTTP</a>
                <ul>
                  <li><a href="../../../scala/http/introduction.html">Introduction</a></li>
                  <li><a href="../../../scala/http/configuration.html">Configuration</a></li>
                  <li><a href="../../../scala/http/common/index.html">Common Abstractions (Client- and Server-Side)</a></li>
                  <li><a href="../../../scala/http/implications-of-streaming-http-entity.html">Implications of the streaming nature of Request/Response Entities</a></li>
                  <li><a href="../../../scala/http/low-level-server-side-api.html">Low-Level Server-Side API</a></li>
                  <li><a href="../../../scala/http/routing-dsl/index.html">High-level Server-Side API</a></li>
                  <li><a href="../../../scala/http/websocket-support.html">Server-Side WebSocket Support</a></li>
                  <li><a href="../../../scala/http/client-side/index.html">Consuming HTTP-based Services (Client-Side)</a></li>
                  <li><a href="../../../scala/http/server-side-https-support.html">Server-Side HTTPS Support</a></li>
                  <li><a href="../../../scala/http/handling-blocking-operations-in-akka-http-routes.html">Handling blocking operations in Akka HTTP</a></li>
                  <li><a href="../../../scala/http/migration-guide/index.html">Migration Guides</a></li>
                </ul></li>
              </ul></li>
            </ul>
            </div>

          </nav>
        </div>

        <div class="small-12 medium-9 large-10 column">
          <section class="site-content">

            <div class="page-header row">
              <div class="medium-12 show-for-medium column">
                <div class="nav-breadcrumbs">
                  <ul>
                    <li><a href="../../../index.html">Akka HTTP</a></li>
                    <li><a href="../../../java.html">Java Documentation</a></li>
                    <li><a href="../../../java/http/index.html">Akka HTTP</a></li>
                    <li><a href="../../../java/http/routing-dsl/index.html">High-level Server-Side API</a></li>
                    <li>HttpApp Bootstrap</li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="page-content row">
              <div class="small-12 large-9 column" id="docs">

<a id="http-app"></a>
<h1><a href="#httpapp-bootstrap" name="httpapp-bootstrap" class="anchor"><span class="anchor-link"></span></a>HttpApp Bootstrap</h1><div class="callout warning "><div class="callout-title">API may change</div>
<p>This is experimental and the API is subjected to change in future releases of Akka HTTP. For further information about this marker, see <a href="https://doc.akka.io/docs/akka/current/common/binary-compatibility-rules.html#The_@DoNotInherit_and_@ApiMayChange_markers">The @DoNotInherit and @ApiMayChange markers</a> in the Akka documentation.</p></div>
<div class="toc ">
<ul>
  <li><a href="../../../java/http/routing-dsl/HttpApp.html#introduction">Introduction</a></li>
  <li><a href="../../../java/http/routing-dsl/HttpApp.html#minimal-example">Minimal Example</a></li>
  <li><a href="../../../java/http/routing-dsl/HttpApp.html#reacting-to-bind-failures">Reacting to Bind Failures</a></li>
  <li><a href="../../../java/http/routing-dsl/HttpApp.html#providing-your-own-server-settings">Providing your own Server Settings</a></li>
  <li><a href="../../../java/http/routing-dsl/HttpApp.html#providing-your-own-actor-system">Providing your own Actor System</a></li>
  <li><a href="../../../java/http/routing-dsl/HttpApp.html#overriding-termination-signal">Overriding Termination Signal</a></li>
  <li><a href="../../../java/http/routing-dsl/HttpApp.html#getting-notified-on-server-shutdown">Getting Notified on Server Shutdown</a></li>
</ul>
</div>
<h2><a href="#introduction" name="introduction" class="anchor"><span class="anchor-link"></span></a>Introduction</h2>
<p>The objective of <code>HttpApp</code> is to help you start an HTTP server with just a few lines of code. This is accomplished just by extending <code>HttpApp</code> and implementing the <code>route()</code> method. If desired, <code>HttpApp</code> provides different hook methods that can be overridden to change its default behavior.</p>
<h2><a href="#minimal-example" name="minimal-example" class="anchor"><span class="anchor-link"></span></a>Minimal Example</h2>
<p>The following example shows how to start a server:</p>
<pre class="prettyprint"><code class="language-java">import akka.Done;
import akka.actor.ActorSystem;
import akka.http.javadsl.server.HttpApp;
import akka.http.javadsl.server.Route;
import java.util.Optional;
import java.util.concurrent.*;

// Server definition
class MinimalHttpApp extends HttpApp {
  @Override
  protected Route route() {
    return path(&quot;hello&quot;, () -&gt;
      get(() -&gt;
        complete(&quot;&lt;h1&gt;Say hello to akka-http&lt;/h1&gt;&quot;)
      )
    );
  }
}

// Starting the server
final MinimalHttpApp myServer = new MinimalHttpApp();
myServer.startServer(&quot;localhost&quot;, 8080);</code></pre>
<p>Firstly we define a <code>class</code> that extends <code>HttpApp</code> and we just implement the routes this server will handle. After that, we can start a server just by providing a <code>host</code> and a <code>port</code>. Calling <code>startServer</code> blocks the current thread until the server is signaled for termination. The default behavior of <code>HttpApp</code> is to start a server, and shut it down after <code>ENTER</code> is pressed. When the call to <code>startServer</code> returns the server is properly shut down.</p>
<h2><a href="#reacting-to-bind-failures" name="reacting-to-bind-failures" class="anchor"><span class="anchor-link"></span></a>Reacting to Bind Failures</h2>
<p><code>HttpApp</code> provides different hooks that will be called after a successful and unsuccessful initialization. For example, the server might not start due to the port being already in use, or because it is a privileged one.</p>
<p>Here you can see an example server that overrides the <code>postHttpBindingFailure</code> hook and prints the error to the console (this is also the default behavior)</p>
<pre class="prettyprint"><code class="language-java">import akka.Done;
import akka.actor.ActorSystem;
import akka.http.javadsl.server.HttpApp;
import akka.http.javadsl.server.Route;
import akka.http.javadsl.settings.ServerSettings;
import com.typesafe.config.ConfigFactory;
import java.util.Optional;
import java.util.concurrent.*;

// Server definition
class FailBindingOverrideHttpApp extends HttpApp {

  @Override
  protected Route route() {
    return path(&quot;hello&quot;, () -&gt;
      get(() -&gt;
        complete(&quot;&lt;h1&gt;Say hello to akka-http&lt;/h1&gt;&quot;)
      )
    );
  }

  @Override
  protected void postHttpBindingFailure(Throwable cause) {
    System.out.println(&quot;I can&#39;t bind!&quot;);
  }
}

// Starting the server
final FailBindingOverrideHttpApp myServer = new FailBindingOverrideHttpApp();
myServer.startServer(&quot;localhost&quot;, 80, ServerSettings.create(ConfigFactory.load()));</code></pre>
<p>So if the port <code>80</code> would be already taken by another app, the call to <code>startServer</code> returns immediately and the <code>postHttpBindingFailure</code> hook will be called.</p>
<h2><a href="#providing-your-own-server-settings" name="providing-your-own-server-settings" class="anchor"><span class="anchor-link"></span></a>Providing your own Server Settings</h2>
<p><code>HttpApp</code> reads the default <code>ServerSettings</code> when one is not provided. In case you want to provide different settings, you can simply pass it to <code>startServer</code> as illustrated in the following example:</p>
<pre class="prettyprint"><code class="language-java">import akka.Done;
import akka.actor.ActorSystem;
import akka.http.javadsl.server.HttpApp;
import akka.http.javadsl.server.Route;
import akka.http.javadsl.settings.ServerSettings;
import com.typesafe.config.ConfigFactory;
import java.util.Optional;
import java.util.concurrent.*;
// Starting the server
final MinimalHttpApp myServer = new MinimalHttpApp();
myServer.startServer(&quot;localhost&quot;, 8080, ServerSettings.create(ConfigFactory.load()));</code></pre>
<h2><a href="#providing-your-own-actor-system" name="providing-your-own-actor-system" class="anchor"><span class="anchor-link"></span></a>Providing your own Actor System</h2>
<p><code>HttpApp</code> creates its own <code>ActorSystem</code> instance when one is not provided. In case you already created an <code>ActorSystem</code> in your application you can pass it to <code>startServer</code> as illustrated in the following example:</p>
<pre class="prettyprint"><code class="language-java">import akka.Done;
import akka.actor.ActorSystem;
import akka.http.javadsl.server.HttpApp;
import akka.http.javadsl.server.Route;
import akka.http.javadsl.settings.ServerSettings;
import com.typesafe.config.ConfigFactory;
import java.util.Optional;
import java.util.concurrent.*;

// Server definition
class MinimalHttpApp extends HttpApp {
  @Override
  protected Route route() {
    return path(&quot;hello&quot;, () -&gt;
      get(() -&gt;
        complete(&quot;&lt;h1&gt;Say hello to akka-http&lt;/h1&gt;&quot;)
      )
    );
  }
}

// Starting the server
ActorSystem system = ActorSystem.apply(&quot;myOwn&quot;);
new MinimalHttpApp().startServer(&quot;localhost&quot;, 8080, ServerSettings.create(system), system);
// ActorSystem is not terminated after server shutdown
// It must be manually terminated
system.terminate();</code></pre>
<h2><a href="#overriding-termination-signal" name="overriding-termination-signal" class="anchor"><span class="anchor-link"></span></a>Overriding Termination Signal</h2>
<p>As already described previously, the default trigger that shuts down the server is pressing <code>ENTER</code>. For simple examples this is sufficient, but for bigger applications this is, most probably, not what you want to do. <code>HttpApp</code> can be configured to signal the server termination just by overriding the method <code>waitForShutdownSignal</code>. This method must return a <code>CompletionStage</code> that, when terminated, will shutdown the server.</p>
<p>This following example shows how to override the default termination signal:</p>
<pre class="prettyprint"><code class="language-java">import akka.Done;
import akka.actor.ActorSystem;
import akka.http.javadsl.server.HttpApp;
import akka.http.javadsl.server.Route;
import akka.http.javadsl.settings.ServerSettings;
import com.typesafe.config.ConfigFactory;
import java.util.Optional;
import java.util.concurrent.*;
import scala.concurrent.duration.Duration;
import scala.runtime.BoxedUnit;

import static akka.pattern.PatternsCS.after;

// Server definition
class SelfDestroyingHttpApp extends HttpApp {

  @Override
  protected Route route() {
    return path(&quot;hello&quot;, () -&gt;
      get(() -&gt;
          complete(&quot;&lt;h1&gt;Say hello to akka-http&lt;/h1&gt;&quot;)
      )
    );
  }

  @Override
  protected CompletionStage&lt;Done&gt; waitForShutdownSignal(ActorSystem system) {
    return after(Duration.apply(5, TimeUnit.SECONDS),
      system.scheduler(),
      system.dispatcher().prepare(),
      CompletableFuture.completedFuture(Done.getInstance()));
  }
}

// Starting the server
final SelfDestroyingHttpApp myServer = new SelfDestroyingHttpApp();
myServer.startServer(&quot;localhost&quot;, 8080, ServerSettings.create(ConfigFactory.load()));</code></pre>
<p>Here the termination signal is defined by a future that will be automatically completed after 5 seconds. </p>
<h2><a href="#getting-notified-on-server-shutdown" name="getting-notified-on-server-shutdown" class="anchor"><span class="anchor-link"></span></a>Getting Notified on Server Shutdown</h2>
<p>There are some cases in which you might want to clean up any resources you were using in your server. In order to do this in a coordinated way, you can override <code>HttpApp</code>&rsquo;s <code>postServerShutdown</code> method.</p>
<p>Here you can find an example:</p>
<pre class="prettyprint"><code class="language-java">import akka.Done;
import akka.actor.ActorSystem;
import akka.http.javadsl.server.HttpApp;
import akka.http.javadsl.server.Route;
import akka.http.javadsl.settings.ServerSettings;
import com.typesafe.config.ConfigFactory;
import java.util.Optional;
import java.util.concurrent.*;

// Server definition
class PostShutdownOverrideHttpApp extends HttpApp {

  @Override
  protected Route route() {
    return path(&quot;hello&quot;, () -&gt;
      get(() -&gt;
        complete(&quot;&lt;h1&gt;Say hello to akka-http&lt;/h1&gt;&quot;)
      )
    );
  }

  private void cleanUpResources() {
  }

  @Override
  protected void postServerShutdown(Optional&lt;Throwable&gt; failure, ActorSystem system) {
    cleanUpResources();
  }
}

// Starting the server
ActorSystem system = ActorSystem.apply(&quot;myActorSystem&quot;);
new PostShutdownOverrideHttpApp().startServer(&quot;localhost&quot;, 8080, ServerSettings.create(system), system);</code></pre>
<p>The <code>postServerShutdown</code> method will be only called once the server attempt to shutdown has completed. Please notice that in the exception that this method is called with, may be null. It will be a non-null one only when <code>unbind</code> fails to stop the server.</p>

                <div>
                  <div class="source-github">
                  The source code for this page can be found <a href="http://github.com/akka/akka-http/tree/master/docs/src/main/paradox/java/http/routing-dsl/HttpApp.md">here</a>.
                  </div>

                </div>

                <div class="nav-next">
                  <p><strong>Next:</strong> <a href="../../../java/http/server-side/websocket-support.html">Server-Side WebSocket Support</a></p>
                </div>
              </div>
              <div class="large-3 show-for-large column" data-sticky-container>
                <nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
                  <div class="page-nav">
                    <div class="nav-title">On this page:</div>
                    <div class="nav-toc">
                      <ul>
                        <li><a href="../../../java/http/routing-dsl/HttpApp.html#httpapp-bootstrap">HttpApp Bootstrap</a>
                        <ul>
                          <li><a href="../../../java/http/routing-dsl/HttpApp.html#introduction">Introduction</a></li>
                          <li><a href="../../../java/http/routing-dsl/HttpApp.html#minimal-example">Minimal Example</a></li>
                          <li><a href="../../../java/http/routing-dsl/HttpApp.html#reacting-to-bind-failures">Reacting to Bind Failures</a></li>
                          <li><a href="../../../java/http/routing-dsl/HttpApp.html#providing-your-own-server-settings">Providing your own Server Settings</a></li>
                          <li><a href="../../../java/http/routing-dsl/HttpApp.html#providing-your-own-actor-system">Providing your own Actor System</a></li>
                          <li><a href="../../../java/http/routing-dsl/HttpApp.html#overriding-termination-signal">Overriding Termination Signal</a></li>
                          <li><a href="../../../java/http/routing-dsl/HttpApp.html#getting-notified-on-server-shutdown">Getting Notified on Server Shutdown</a></li>
                        </ul></li>
                      </ul>
                    </div>
                  </div>
                </nav>
              </div>
            </div>

          </section>
        </div>

      </div>

      <footer class="site-footer">

        <section class="site-footer-base">
          <div class="expanded row">
            <div class="small-12 large-12 column">
              <div class="row site-footer-content clearfix">
                <div class="float-right">
		  Last updated: May 03, 2017
		</div>
                <div class="float-left">
		  &copy; 2017 <a href="https://www.lightbend.com/">Lightbend Inc.</a>
		  <span class="license">Akka HTTP is Open Source and available under the Apache 2 License.</span>
                </div>
              </div>
            </div>
          </div>
        </section>
      </footer>

    </div>
  </div>
</div>

<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
<style>.algolia-autocomplete { display: block !important }</style>
<script type="text/javascript">
  var version = '10.0.6'; // replaced by paradox

  var lang = "scala";
  var path = window.location.pathname;
  if (path.includes("/java/") || path.includes("java.html")) {
    lang = "java";
  }

  docsearch({
    apiKey: '0ccbb8bf5148554a406fbf07df0a93b9',
    indexName: 'akka-http',
    inputSelector: '#search',
    algoliaOptions: {'facetFilters': ["version:" + version, "language:" + lang]},
    debug: false // Set debug to true if you want to inspect the dropdown
  });
</script>
</body>

<script type="text/javascript" src="../../../lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../../../js/magellan.js"></script>

<style type="text/css">@import "../../../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../../../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../../../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function () {
  window.prettyPrint && prettyPrint()
});</script>

</html>
