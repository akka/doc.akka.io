<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>withRequestTimeout &bull; Akka HTTP</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="Akka HTTP: Modern, fast, asynchronous, streaming-first HTTP server and client."/><link rel="canonical" href="https://doc.akka.io/docs/akka-http/10.0/java/http/routing-dsl/directives/timeout-directives/withRequestTimeout.html"/>
<script type="text/javascript" src="../../../../../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../../lib/foundation/dist/js/foundation.min.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../../lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="../../../../../lib/foundation/dist/css/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<link rel="stylesheet" type="text/css" href="../../../../../css/icons.css"/>
<link rel="stylesheet" type="text/css" href="../../../../../css/page.css"/>
<link rel="shortcut icon" href="../../../../../images/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="../../../../../images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../../../../images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../../../images/favicon-16x16.png">
<link rel="manifest" href="../../../../../images/manifest.json">
<meta name="msapplication-TileImage" content="../../../../../images/mstile-150x150.png">
<meta name="msapplication-TileColor" content="#15a9ce">
<meta name="theme-color" content="#15a9ce">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!--Google Analytics-->
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-21117439-1']);
_gaq.push(['_setDomainName', 'akka.io']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})()
</script>
<!--Google Analytics & Marketo-->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-23127719-1', 'lightbend.com', {'allowLinker': true, 'name': 'tsTracker'});
ga('tsTracker.require', 'linker');
ga('tsTracker.linker:autoLink', ['lightbend.com','playframework.com','scala-lang.org','scaladays.org','spray.io','akka.io','scala-sbt.org','scala-ide.org']);
ga('tsTracker.send', 'pageview');
(function() {
var didInit = false;
function initMunchkin() {
if(didInit === false) {
didInit = true;
Munchkin.init('558-NCX-702');
}
}
var s = document.createElement('script');
s.type = 'text/javascript';
s.async = true;
s.src = '//munchkin.marketo.net/munchkin.js';
s.onreadystatechange = function() {
if (this.readyState == 'complete' || this.readyState == 'loaded') {
initMunchkin();
}
};
s.onload = initMunchkin;
document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>

</head>

<body id="underlay" data-toggler="nav-open">

<header class="site-header hide-for-large">
<div class="sticky-header clearfix">
<a href="https://akka.io"><img class="logo" src="../../../../../images/akka-logo-reverse.svg"></a>

<button class="menu-icon float-right" type="button" data-toggle="underlay overlay"></button>
</div>
<div id="overlay" class="overlay-nav" data-toggler="nav-open">
<header class="nav-header">
<div class="nav-header-title">
<h1><a href="../../../../../java/http/index.html">Akka HTTP</a></h1>
</div>
<div class="nav-header-version">
Version 10.0.11
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Languages"><option class="group" value="group-scala">Scala</option><option class="group" value="group-java">Java</option></select>
</div>
<div id="overlay-search-container" class="nav-header-search">
<input id="overlay-search" type="search" class="search" placeholder="Search"/>
</div>
</header>
<nav class="nav-toc">
<ul>
  <li><a href="../../../../../java/http/security.html" class="page">Security Announcements</a></li>
  <li><a href="../../../../../java/http/introduction.html" class="page">Introduction</a></li>
  <li><a href="../../../../../java/http/configuration.html" class="page">Configuration</a></li>
  <li><a href="../../../../../java/http/common/index.html" class="page">Common Abstractions (Client- and Server-Side)</a></li>
  <li><a href="../../../../../java/http/implications-of-streaming-http-entity.html" class="page">Implications of the streaming nature of Request/Response Entities</a></li>
  <li><a href="../../../../../java/http/server-side/index.html" class="page">Server-Side API</a></li>
  <li><a href="../../../../../java/http/routing-dsl/index.html" class="page">High-level Server-Side API</a>
  <ul>
    <li><a href="../../../../../java/http/routing-dsl/index.html#minimal-example" class="header">Minimal Example</a></li>
    <li><a href="../../../../../java/http/routing-dsl/index.html#handling-http-server-failures-in-the-high-level-api" class="header">Handling HTTP Server failures in the High-Level API</a></li>
    <li><a href="../../../../../java/http/routing-dsl/overview.html" class="page">Routing DSL Overview</a></li>
    <li><a href="../../../../../java/http/routing-dsl/routes.html" class="page">Routes</a></li>
    <li><a href="../../../../../java/http/routing-dsl/directives/index.html" class="page">Directives</a>
    <ul>
      <li><a href="../../../../../java/http/routing-dsl/directives/index.html#basics" class="header">Basics</a></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/index.html#structure" class="header">Structure</a></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/index.html#what-directives-do" class="header">What Directives do</a></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/index.html#composing-directives" class="header">Composing Directives</a></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/index.html#type-safety-of-directives" class="header">Type Safety of Directives</a></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/alphabetically.html" class="page">Predefined Directives (alphabetically)</a></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/by-trait.html" class="page">Predefined Directives (by trait)</a>
      <ul>
        <li><a href="../../../../../java/http/routing-dsl/directives/by-trait.html#directives-filtering-or-extracting-from-the-request" class="header">Directives filtering or extracting from the request</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/by-trait.html#directives-creating-or-transforming-the-response" class="header">Directives creating or transforming the response</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/by-trait.html#list-of-predefined-directives-by-trait" class="header">List of predefined directives by trait</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/basic-directives/index.html" class="page">BasicDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/cache-condition-directives/index.html" class="page">CacheConditionDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/caching-directives/index.html" class="page">CachingDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/coding-directives/index.html" class="page">CodingDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/cookie-directives/index.html" class="page">CookieDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/debugging-directives/index.html" class="page">DebuggingDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/execution-directives/index.html" class="page">ExecutionDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/file-and-resource-directives/index.html" class="page">FileAndResourceDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/file-upload-directives/index.html" class="page">FileUploadDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/form-field-directives/index.html" class="page">FormFieldDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/future-directives/index.html" class="page">FuturesDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/header-directives/index.html" class="page">HeaderDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/host-directives/index.html" class="page">HostDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/marshalling-directives/index.html" class="page">Marshalling Directives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/method-directives/index.html" class="page">MethodDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/misc-directives/index.html" class="page">MiscDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/parameter-directives/index.html" class="page">ParameterDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/path-directives/index.html" class="page">PathDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/range-directives/index.html" class="page">RangeDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/respond-with-directives/index.html" class="page">RespondWithDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/route-directives/index.html" class="page">RouteDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/scheme-directives/index.html" class="page">SchemeDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/security-directives/index.html" class="page">SecurityDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/websocket-directives/index.html" class="page">WebSocketDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/timeout-directives/index.html" class="page">TimeoutDirectives</a>
        <ul>
          <li><a href="../../../../../java/http/routing-dsl/directives/timeout-directives/withRequestTimeout.html#withrequesttimeout" class="active page">withRequestTimeout</a>
          <ul>
            <li><a href="../../../../../java/http/routing-dsl/directives/timeout-directives/withRequestTimeout.html#description" class="header">Description</a></li>
            <li><a href="../../../../../java/http/routing-dsl/directives/timeout-directives/withRequestTimeout.html#example" class="header">Example</a></li>
          </ul></li>
          <li><a href="../../../../../java/http/routing-dsl/directives/timeout-directives/withoutRequestTimeout.html" class="page">withoutRequestTimeout</a></li>
          <li><a href="../../../../../java/http/routing-dsl/directives/timeout-directives/withRequestTimeoutResponse.html" class="page">withRequestTimeoutResponse</a></li>
        </ul></li>
      </ul></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/custom-directives.html" class="page">Custom Directives</a></li>
    </ul></li>
    <li><a href="../../../../../java/http/routing-dsl/marshalling.html" class="page">Marshalling &amp; Unmarshalling</a></li>
    <li><a href="../../../../../java/http/routing-dsl/exception-handling.html" class="page">Exception Handling</a></li>
    <li><a href="../../../../../java/http/routing-dsl/source-streaming-support.html" class="page">Source Streaming</a></li>
    <li><a href="../../../../../java/http/routing-dsl/rejections.html" class="page">Rejections</a></li>
    <li><a href="../../../../../java/http/routing-dsl/testkit.html" class="page">Route TestKit</a></li>
    <li><a href="../../../../../java/http/routing-dsl/HttpApp.html" class="page">HttpApp Bootstrap</a></li>
  </ul></li>
  <li><a href="../../../../../java/http/sse-support.html" class="page">Server-Sent Events Support</a></li>
  <li><a href="../../../../../java/http/client-side/index.html" class="page">Consuming HTTP-based Services (Client-Side)</a></li>
  <li><a href="../../../../../java/http/handling-blocking-operations-in-akka-http-routes.html" class="page">Handling blocking operations in Akka HTTP</a></li>
  <li><a href="../../../../../java/http/migration-guide/index.html" class="page">Migration Guides</a></li>
  <li><a href="../../../../../java/http/compatibility-guidelines.html" class="page">Compatibility Guidelines</a></li>
  <li><a href="../../../../../java/http/release-notes.html" class="page">Release Notes</a></li>
</ul>
</nav>
</div>
</header>

<aside class="show-for-large">
<header class="nav-header fixed-sidebar-header">
<div class="nav-header-title">
<h1><a href="../../../../../java/http/index.html">Akka HTTP</a></h1>
</div>
<div class="nav-header-version">
Version 10.0.11
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Languages"><option class="group" value="group-scala">Scala</option><option class="group" value="group-java">Java</option></select>
</div>
<div class="nav-header-search">
<input id="search" type="search" class="search" placeholder="Search"/>
</div>
</header>
<nav class="site-nav fixed-sidebar-contents">
<div class="nav-toc">
<ul>
  <li><a href="../../../../../java/http/security.html" class="page">Security Announcements</a></li>
  <li><a href="../../../../../java/http/introduction.html" class="page">Introduction</a></li>
  <li><a href="../../../../../java/http/configuration.html" class="page">Configuration</a></li>
  <li><a href="../../../../../java/http/common/index.html" class="page">Common Abstractions (Client- and Server-Side)</a></li>
  <li><a href="../../../../../java/http/implications-of-streaming-http-entity.html" class="page">Implications of the streaming nature of Request/Response Entities</a></li>
  <li><a href="../../../../../java/http/server-side/index.html" class="page">Server-Side API</a></li>
  <li><a href="../../../../../java/http/routing-dsl/index.html" class="page">High-level Server-Side API</a>
  <ul>
    <li><a href="../../../../../java/http/routing-dsl/index.html#minimal-example" class="header">Minimal Example</a></li>
    <li><a href="../../../../../java/http/routing-dsl/index.html#handling-http-server-failures-in-the-high-level-api" class="header">Handling HTTP Server failures in the High-Level API</a></li>
    <li><a href="../../../../../java/http/routing-dsl/overview.html" class="page">Routing DSL Overview</a></li>
    <li><a href="../../../../../java/http/routing-dsl/routes.html" class="page">Routes</a></li>
    <li><a href="../../../../../java/http/routing-dsl/directives/index.html" class="page">Directives</a>
    <ul>
      <li><a href="../../../../../java/http/routing-dsl/directives/index.html#basics" class="header">Basics</a></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/index.html#structure" class="header">Structure</a></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/index.html#what-directives-do" class="header">What Directives do</a></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/index.html#composing-directives" class="header">Composing Directives</a></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/index.html#type-safety-of-directives" class="header">Type Safety of Directives</a></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/alphabetically.html" class="page">Predefined Directives (alphabetically)</a></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/by-trait.html" class="page">Predefined Directives (by trait)</a>
      <ul>
        <li><a href="../../../../../java/http/routing-dsl/directives/by-trait.html#directives-filtering-or-extracting-from-the-request" class="header">Directives filtering or extracting from the request</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/by-trait.html#directives-creating-or-transforming-the-response" class="header">Directives creating or transforming the response</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/by-trait.html#list-of-predefined-directives-by-trait" class="header">List of predefined directives by trait</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/basic-directives/index.html" class="page">BasicDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/cache-condition-directives/index.html" class="page">CacheConditionDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/caching-directives/index.html" class="page">CachingDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/coding-directives/index.html" class="page">CodingDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/cookie-directives/index.html" class="page">CookieDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/debugging-directives/index.html" class="page">DebuggingDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/execution-directives/index.html" class="page">ExecutionDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/file-and-resource-directives/index.html" class="page">FileAndResourceDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/file-upload-directives/index.html" class="page">FileUploadDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/form-field-directives/index.html" class="page">FormFieldDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/future-directives/index.html" class="page">FuturesDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/header-directives/index.html" class="page">HeaderDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/host-directives/index.html" class="page">HostDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/marshalling-directives/index.html" class="page">Marshalling Directives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/method-directives/index.html" class="page">MethodDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/misc-directives/index.html" class="page">MiscDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/parameter-directives/index.html" class="page">ParameterDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/path-directives/index.html" class="page">PathDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/range-directives/index.html" class="page">RangeDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/respond-with-directives/index.html" class="page">RespondWithDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/route-directives/index.html" class="page">RouteDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/scheme-directives/index.html" class="page">SchemeDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/security-directives/index.html" class="page">SecurityDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/websocket-directives/index.html" class="page">WebSocketDirectives</a></li>
        <li><a href="../../../../../java/http/routing-dsl/directives/timeout-directives/index.html" class="page">TimeoutDirectives</a>
        <ul>
          <li><a href="../../../../../java/http/routing-dsl/directives/timeout-directives/withRequestTimeout.html#withrequesttimeout" class="active page">withRequestTimeout</a>
          <ul>
            <li><a href="../../../../../java/http/routing-dsl/directives/timeout-directives/withRequestTimeout.html#description" class="header">Description</a></li>
            <li><a href="../../../../../java/http/routing-dsl/directives/timeout-directives/withRequestTimeout.html#example" class="header">Example</a></li>
          </ul></li>
          <li><a href="../../../../../java/http/routing-dsl/directives/timeout-directives/withoutRequestTimeout.html" class="page">withoutRequestTimeout</a></li>
          <li><a href="../../../../../java/http/routing-dsl/directives/timeout-directives/withRequestTimeoutResponse.html" class="page">withRequestTimeoutResponse</a></li>
        </ul></li>
      </ul></li>
      <li><a href="../../../../../java/http/routing-dsl/directives/custom-directives.html" class="page">Custom Directives</a></li>
    </ul></li>
    <li><a href="../../../../../java/http/routing-dsl/marshalling.html" class="page">Marshalling &amp; Unmarshalling</a></li>
    <li><a href="../../../../../java/http/routing-dsl/exception-handling.html" class="page">Exception Handling</a></li>
    <li><a href="../../../../../java/http/routing-dsl/source-streaming-support.html" class="page">Source Streaming</a></li>
    <li><a href="../../../../../java/http/routing-dsl/rejections.html" class="page">Rejections</a></li>
    <li><a href="../../../../../java/http/routing-dsl/testkit.html" class="page">Route TestKit</a></li>
    <li><a href="../../../../../java/http/routing-dsl/HttpApp.html" class="page">HttpApp Bootstrap</a></li>
  </ul></li>
  <li><a href="../../../../../java/http/sse-support.html" class="page">Server-Sent Events Support</a></li>
  <li><a href="../../../../../java/http/client-side/index.html" class="page">Consuming HTTP-based Services (Client-Side)</a></li>
  <li><a href="../../../../../java/http/handling-blocking-operations-in-akka-http-routes.html" class="page">Handling blocking operations in Akka HTTP</a></li>
  <li><a href="../../../../../java/http/migration-guide/index.html" class="page">Migration Guides</a></li>
  <li><a href="../../../../../java/http/compatibility-guidelines.html" class="page">Compatibility Guidelines</a></li>
  <li><a href="../../../../../java/http/release-notes.html" class="page">Release Notes</a></li>
</ul>
</div>
</nav>
<footer class="nav-footer fixed-sidebar-footer">
<a href="https://akka.io"><img class="logo" src="../../../../../images/akka-logo-reverse.svg"></a>

</footer>
</aside>

<main class="fixed-shift-for-large expanded row">
<section class="site-content small-12 column">

<article class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#withrequesttimeout" name="withrequesttimeout" class="anchor"><span class="anchor-link"></span></a>withRequestTimeout</h1>
<h2><a href="#description" name="description" class="anchor"><span class="anchor-link"></span></a>Description</h2>
<p>This directive enables &ldquo;late&rdquo; (during request processing) control over the <a href="../../../common/timeouts.html#request-timeout">Request timeout</a> feature in Akka HTTP.</p>
<p>The timeout can be either loosened or made more tight using this directive, however one should be aware that it is inherently racy (which may especially show with very tight timeouts) since a timeout may already have been triggered when this directive executes.</p>
<p>In case of pipelined HTTP requests (multiple requests being accepted on the same connection before sending the first response) a the request timeout failure of the <code>n-th</code> request <em>will shut down the connection</em> causing the already enqueued requests to be dropped. This is by-design, as the request timeout feature serves as a &ldquo;safety net&rdquo; in case of programming errors (e.g. a Future that never completes thus potentially blocking the entire connection forever) or malicious attacks on the server.</p>
<p>Optionally, a timeout handler may be provided in which is called when a time-out is triggered and must produce an <code>HttpResponse</code> that will be sent back to the client instead of the &ldquo;too late&rdquo; response (in case it&rsquo;d ever arrive). See also <a href="withRequestTimeoutResponse.html">withRequestTimeoutResponse</a> if only looking to customise the timeout response without changing the timeout itself.</p><div class="callout warning "><div class="callout-title">Warning</div>
<p>Please note that setting the timeout from within a directive is inherently racy (as the &ldquo;point in time from which we&rsquo;re measuring the timeout&rdquo; is already in the past (the moment we started handling the request), so if the existing timeout already was triggered before your directive had the chance to change it, an timeout may still be logged.</p>
<p>It is recommended to use a larger statically configured timeout (think of it as a &ldquo;safety net&rdquo; against programming errors or malicious attackers) and if needed tighten it using the directives – not the other way around.</p></div>
<p>For more information about various timeouts in Akka HTTP see <a href="../../../common/timeouts.html">Akka HTTP Timeouts</a>.</p>
<h2><a href="#example" name="example" class="anchor"><span class="anchor-link"></span></a>Example</h2>
<pre class="prettyprint"><code class="language-java">final Duration timeout = Duration.create(1, TimeUnit.SECONDS);
CompletionStage&lt;String&gt; slowFuture = new CompletableFuture&lt;&gt;();

final Route route = path(&quot;timeout&quot;, () -&gt;
        withRequestTimeout(timeout, () -&gt; {
            return completeOKWithFutureString(slowFuture); // very slow
        })
);

// test:
StatusCode statusCode = runRoute(system, materializer, route, &quot;timeout&quot;).get().status();
assert (StatusCodes.SERVICE_UNAVAILABLE.equals(statusCode));</code></pre>
<p>With setting the handler at the same time:</p>
<pre class="prettyprint"><code class="language-java">final Duration timeout = Duration.create(1, TimeUnit.MILLISECONDS);
CompletionStage&lt;String&gt; slowFuture = new CompletableFuture&lt;&gt;();

HttpResponse enhanceYourCalmResponse = HttpResponse.create()
        .withStatus(StatusCodes.ENHANCE_YOUR_CALM)
        .withEntity(&quot;Unable to serve response within time limit, please enhance your calm.&quot;);

final Route route = path(&quot;timeout&quot;, () -&gt;
        withRequestTimeout(timeout, (request) -&gt; enhanceYourCalmResponse, () -&gt; {
            return completeOKWithFutureString(slowFuture); // very slow
        })
);

// test:
StatusCode statusCode = runRoute(system, materializer, route, &quot;timeout&quot;).get().status();
assert (StatusCodes.ENHANCE_YOUR_CALM.equals(statusCode));</code></pre>
</div>
</article>

<div class="row">
<div class="small-12 large-9 column">
<section class="nav-prev-next row">
<div class="nav-prev small-6 column">
<a href="../../../../../java/http/routing-dsl/directives/timeout-directives/index.html"><i class="icon-prev"></i> <span class="link-prev">TimeoutDirectives</span></a>
</div>
<div class="nav-next small-6 column clearfix">
<a class="float-right" href="../../../../../java/http/routing-dsl/directives/timeout-directives/withoutRequestTimeout.html">withoutRequestTimeout <i class="icon-next"></i></a>
</div>
</section>
</div>
</div>

<div class="source-github row">
The source code for this page can be found <a href="http://github.com/akka/akka-http/tree/master/docs/src/main/paradox/java/http/routing-dsl/directives/timeout-directives/withRequestTimeout.md">here</a>.
</div>


<footer class="page-footer row clearfix">
<img class="akka-icon float-left show-for-medium" src="../../../../../images/akka-icon.svg">
<section class="copyright">
<div>&copy; 2011-2017 <a href="https://www.lightbend.com">Lightbend</a></div>
<div>Akka HTTP is Open Source and available under the Apache 2 License.</div>
</section>
</footer>

</section>
</main>

<script type="text/javascript" src="../../../../../js/scrollsneak.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../../../../../js/groups.js"></script>
<script type="text/javascript" src="../../../../../js/page.js"></script>
<script type="text/javascript" src="../../../../../js/magellan.js"></script>

<style type="text/css">@import "../../../../../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../../../../../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../../../../../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>

<!-- Algolia docs search -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
<style>.algolia-autocomplete { display: block !important }</style>
<script type="text/javascript">
var lang = "scala";
var path = window.location.pathname;
if (path.includes("/java/") || path.includes("java.html")) {
lang = "java";
}

docsearch({
apiKey: '0ccbb8bf5148554a406fbf07df0a93b9',
indexName: 'akka-http',
inputSelector: '#search',
algoliaOptions: {
hitsPerPage: 5,
facetFilters: ["language:" + lang]
}
});

docsearch({
apiKey: '0ccbb8bf5148554a406fbf07df0a93b9',
indexName: 'akka-http',
inputSelector: '#overlay-search',
algoliaOptions: {
hitsPerPage: 5,
facetFilters: ["language:" + lang]
}
});

// set up "/" as global shortcut for focusing on search
jQuery(document).keypress(function (event) {
if (event.keyCode == 47) {
jQuery("#search").focus();
return false; // swallow key event, otherwise the / char would be input into the search box
}
});
</script>


</body>
</html>
