<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Apache Solr &bull; Alpakka Documentation</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="Alpakka is a Reactive Enterprise Integration library for Java and Scala, based on Reactive Streams and Akka."/>
<link rel="canonical" href="https://doc.akka.io/docs/alpakka/current/solr.html"/>
<script type="text/javascript" src="lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="lib/foundation/dist/js/foundation.min.js"></script>
<link rel="stylesheet" type="text/css" href="lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="lib/foundation/dist/css/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<link rel="stylesheet" type="text/css" href="css/icons.css"/>
<link rel="stylesheet" type="text/css" href="css/page-7.css"/>
<link rel="stylesheet" type="text/css" href="css/banner-1.css"/>
<link rel="shortcut icon" href="images/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png"/>
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png"/>
<link rel="manifest" href="images/manifest.json"/>
<meta name="msapplication-TileImage" content="images/mstile-150x150.png"/>
<meta name="msapplication-TileColor" content="#15a9ce"/>
<meta name="theme-color" content="#15a9ce"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) start -->
<script src="https://optanon.blob.core.windows.net/consent/159bb13d-6748-4399-806e-ac28db879785.js" type="text/javascript" charset="UTF-8"></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) end -->
<!--Google Analytics-->
<script type="text/plain" class="optanon-category-2">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', '']);
_gaq.push(['_setDomainName', '']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})()
</script>
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-2">
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KBJGH35');
</script>
<!--Marketo-->
<script type="text/plain" class="optanon-category-3">
(function() {
var didInit = false;
function initMunchkin() {
if(didInit === false) {
didInit = true;
Munchkin.init('558-NCX-702', { 'asyncOnly': true, 'disableClickDelay': true });
}
}
var s = document.createElement('script');
s.type = 'text/javascript';
s.async = true;
s.src = '//munchkin.marketo.net/munchkin.js';
s.onreadystatechange = function() {
if (this.readyState == 'complete' || this.readyState == 'loaded') {
initMunchkin();
}
};
s.onload = initMunchkin;
document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
</head>

<body id="underlay" data-toggler="nav-open">
<div id="lightbend-banner" class="lightbend-banner akka full-width" data-category="OSS Lightbend Banner Impression" data-label="Akka Banner Impression">
<div class="wrapper">
<div class="brand">
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Lightbend Logo - Akka Banner" href="https://www.lightbend.com?r=oss-banner-akka" target="_blank">
<img class="lightbend-logo" src="images/banner-logos/lightbend-reverse.svg" alt="Lightbend" title="Lightbend">
</a>
</div>
<div class="nav">
<a class="banner-btn oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Enhance your Akka systems with Akka Platform [Button] - Akka Banner" href="https://www.lightbend.com/akka-platform?r=oss-banner-akka" target="_blank">
<span>Enhance your Akka systems with</span>
<img class="akka-platform-reverse-logo" src="images/banner-logos/akka-platform-reverse.svg" alt="Akka Platform" title="Akka Platform">
</a>
<div class="drop-down">
<svg class="svg-chevon-circle-down" version="1.1" id="Chevron_circled_down" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
<path fill="#ffffff" d="M12.505,8.698L10,11L7.494,8.698c-0.198-0.196-0.518-0.196-0.718,0c-0.197,0.196-0.197,0.515,0,0.71l2.864,2.807
c0.199,0.196,0.52,0.196,0.717,0l2.864-2.807c0.199-0.195,0.198-0.514,0-0.71C13.024,8.502,12.704,8.502,12.505,8.698z M10,0.4
c-5.302,0-9.6,4.298-9.6,9.6c0,5.303,4.298,9.6,9.6,9.6s9.6-4.297,9.6-9.6C19.6,4.698,15.302,0.4,10,0.4z M10,18.354
c-4.615,0-8.354-3.74-8.354-8.354c0-4.614,3.739-8.354,8.354-8.354c4.613,0,8.354,3.74,8.354,8.354
C18.354,14.614,14.613,18.354,10,18.354z" />
</svg>
<div class="drop-down-content">
<div class="lightbend-family">
<a href="https://cloudflow.io" class="cloudflow oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Cloudflow - Logo Tag Line - Akka Banner">
<img class="cloudflow-full-color-logo" src="images/banner-logos/cloudflow-full-color.svg" alt="Cloudflow by Lightbend" title="Cloudflow by Lightbend">
</a>
<a href="https://cloudstate.io" class="cloudstate oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Cloudstate - Logo Tag Line - Akka Banner">
<img class="cloudstate-full-color-logo" src="images/banner-logos/cloudstate-full-color.svg" alt="Cloudstate by Lightbend" title="Cloudstate by Lightbend">
</a>
<a href="https://www.lagomframework.com" class="lagom oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Lagom - Logo Tag Line - Akka Banner">
<img class="lagom-full-color-logo" src="images/banner-logos/lagom-full-color.svg" alt="Lagom Framework by Lightbend" title="Lagom Framework by Lightbend">
</a>
<a href="https://www.playframework.com" class="play oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Play - Logo Tag Line - Akka Banner">
<img class="play-full-color-logo" src="images/banner-logos/play-full-color.svg" alt="Play Framework by Lightbend" title="Play Framework by Lightbend">
</a>
<a href="https://www.scala-lang.org" class="scala oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Scala - Logo Tag Line - Akka Banner">
<img class="scala-full-color-logo" src="images/banner-logos/scala-full-color.svg" alt="Scala by Lightbend" title="Scala by Lightbend">
</a>
<div class="akka current">
<img class="akka-full-color-logo" src="images/banner-logos/akka-full-color.svg" alt="Akka by Lightbend" title="Akka by Lightbend">
<span>From the creators of <strong>Akka</strong>, get technology enhancements, monitoring, and expert support with Akka Platform from Lightbend.</span>
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Learn More [Button] - Akka Banner" href="https://www.lightbend.com/akka-platform?r=oss-banner-akka" target="_blank">Learn More</a>
</div>
</div>
<div class="title">The Lightbend Family</div>
</div>      
</div>
</div>
</div>
</div>

<header class="site-header hide-for-large">
<div class="sticky-header clearfix">
<a href="https://akka.io"><img class="logo" src="images/akka-alpakka-reverse.svg"/></a>

<button class="menu-icon float-right" type="button" data-toggle="underlay overlay"></button>
</div>
<div id="overlay" class="overlay-nav" data-toggler="nav-open">
<header class="nav-header">
<div class="nav-header-title">
<h1><a href="index.html">Alpakka Documentation</a></h1>
</div>
<div class="nav-header-version">
Version 2.0.2
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
</div>
</header>
<nav class="nav-toc">
<ul>
  <li><a href="overview.html" class="page">Overview</a></li>
  <li><a href="data-transformations/index.html" class="page">Data Transformations</a></li>
  <li><a href="amqp.html" class="page">AMQP</a></li>
  <li><a href="external/apache-camel.html" class="page">Apache Camel</a></li>
  <li><a href="cassandra.html" class="page">Apache Cassandra</a></li>
  <li><a href="geode.html" class="page">Apache Geode</a></li>
  <li><a href="kafka.html" class="page">Apache Kafka</a></li>
  <li><a href="kudu.html" class="page">Apache Kudu</a></li>
  <li><a href="solr.html#apache-solr" class="active page">Apache Solr</a>
  <ul>
    <li><a href="solr.html#artifacts" class="header">Artifacts</a></li>
    <li><a href="solr.html#set-up-a-solr-client" class="header">Set up a Solr client</a></li>
    <li><a href="solr.html#reading-from-solr" class="header">Reading from Solr</a></li>
    <li><a href="solr.html#writing-to-solr" class="header">Writing to Solr</a></li>
    <li><a href="solr.html#update-documents" class="header">Update documents</a></li>
    <li><a href="solr.html#delete-documents-by-ids" class="header">Delete documents by ids</a></li>
    <li><a href="solr.html#delete-documents-by-query" class="header">Delete documents by query</a></li>
  </ul></li>
  <li><a href="avroparquet.html" class="page">Avro Parquet</a></li>
  <li><a href="aws-event-bridge.html" class="page">AWS EventBridge</a></li>
  <li><a href="dynamodb.html" class="page">AWS DynamoDB</a></li>
  <li><a href="kinesis.html" class="page">AWS Kinesis and Firehose</a></li>
  <li><a href="awslambda.html" class="page">AWS Lambda</a></li>
  <li><a href="s3.html" class="page">AWS S3</a></li>
  <li><a href="sns.html" class="page">AWS SNS</a></li>
  <li><a href="sqs.html" class="page">AWS SQS</a></li>
  <li><a href="external/azure-event-hubs.html" class="page">Azure Event Hubs</a></li>
  <li><a href="external/azure-iot-hub.html" class="page">Azure IoT Hub</a></li>
  <li><a href="azure-storage-queue.html" class="page">Azure Storage Queue</a></li>
  <li><a href="couchbase.html" class="page">Couchbase</a></li>
  <li><a href="elasticsearch.html" class="page">Elasticsearch</a></li>
  <li><a href="external/eventuate.html" class="page">Eventuate</a></li>
  <li><a href="file.html" class="page">File</a></li>
  <li><a href="external/fs2.html" class="page">FS2</a></li>
  <li><a href="ftp.html" class="page">FTP</a></li>
  <li><a href="google-cloud-bigquery.html" class="page">Google Cloud BigQuery</a></li>
  <li><a href="google-cloud-pub-sub.html" class="page">Google Cloud Pub/Sub</a></li>
  <li><a href="google-cloud-pub-sub-grpc.html" class="page">Google Cloud Pub/Sub gRPC</a></li>
  <li><a href="google-cloud-storage.html" class="page">Google Cloud Storage</a></li>
  <li><a href="google-fcm.html" class="page">Google FCM</a></li>
  <li><a href="external/grpc.html" class="page">gRPC</a></li>
  <li><a href="hdfs.html" class="page">Hadoop Distributed File System - HDFS</a></li>
  <li><a href="hbase.html" class="page">HBase</a></li>
  <li><a href="external/http.html" class="page">HTTP</a></li>
  <li><a href="bluemix-cos.html" class="page">IBM Bluemix Cloud Object Storage</a></li>
  <li><a href="external/db2-event-store.html" class="page">IBM Db2 Event Store</a></li>
  <li><a href="influxdb.html" class="page">InfluxDB</a></li>
  <li><a href="ironmq.html" class="page">IronMQ</a></li>
  <li><a href="jms/index.html" class="page">JMS</a></li>
  <li><a href="external/mapr.html" class="page">MapR Database</a></li>
  <li><a href="mongodb.html" class="page">MongoDB</a></li>
  <li><a href="mqtt.html" class="page">MQTT</a></li>
  <li><a href="mqtt-streaming.html" class="page">MQTT Streaming</a></li>
  <li><a href="orientdb.html" class="page">OrientDB</a></li>
  <li><a href="external/pulsar.html" class="page">Pulsar</a></li>
  <li><a href="pravega.html" class="page">Pravega</a></li>
  <li><a href="sse.html" class="page">Server-sent Events (SSE)</a></li>
  <li><a href="slick.html" class="page">Slick (JDBC)</a></li>
  <li><a href="spring-web.html" class="page">Spring Web</a></li>
  <li><a href="external/tcp.html" class="page">TCP</a></li>
  <li><a href="udp.html" class="page">UDP</a></li>
  <li><a href="unix-domain-socket.html" class="page">Unix Domain Socket</a></li>
</ul>
</nav>
</div>
</header>
<div class="site-content-wrapper">
<aside class="sticky-sidebar show-for-large">
<header class="nav-header sticky-sidebar-header">
<div class="nav-header-title">
<h1><a href="index.html">Alpakka Documentation</a></h1>
</div>
<div class="nav-header-version">
Version 2.0.2
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
</div>
</header>
<nav class="site-nav sticky-sidebar-contents">
<div class="nav-toc">
<ul>
  <li><a href="overview.html" class="page">Overview</a></li>
  <li><a href="data-transformations/index.html" class="page">Data Transformations</a></li>
  <li><a href="amqp.html" class="page">AMQP</a></li>
  <li><a href="external/apache-camel.html" class="page">Apache Camel</a></li>
  <li><a href="cassandra.html" class="page">Apache Cassandra</a></li>
  <li><a href="geode.html" class="page">Apache Geode</a></li>
  <li><a href="kafka.html" class="page">Apache Kafka</a></li>
  <li><a href="kudu.html" class="page">Apache Kudu</a></li>
  <li><a href="solr.html#apache-solr" class="active page">Apache Solr</a>
  <ul>
    <li><a href="solr.html#artifacts" class="header">Artifacts</a></li>
    <li><a href="solr.html#set-up-a-solr-client" class="header">Set up a Solr client</a></li>
    <li><a href="solr.html#reading-from-solr" class="header">Reading from Solr</a></li>
    <li><a href="solr.html#writing-to-solr" class="header">Writing to Solr</a></li>
    <li><a href="solr.html#update-documents" class="header">Update documents</a></li>
    <li><a href="solr.html#delete-documents-by-ids" class="header">Delete documents by ids</a></li>
    <li><a href="solr.html#delete-documents-by-query" class="header">Delete documents by query</a></li>
  </ul></li>
  <li><a href="avroparquet.html" class="page">Avro Parquet</a></li>
  <li><a href="aws-event-bridge.html" class="page">AWS EventBridge</a></li>
  <li><a href="dynamodb.html" class="page">AWS DynamoDB</a></li>
  <li><a href="kinesis.html" class="page">AWS Kinesis and Firehose</a></li>
  <li><a href="awslambda.html" class="page">AWS Lambda</a></li>
  <li><a href="s3.html" class="page">AWS S3</a></li>
  <li><a href="sns.html" class="page">AWS SNS</a></li>
  <li><a href="sqs.html" class="page">AWS SQS</a></li>
  <li><a href="external/azure-event-hubs.html" class="page">Azure Event Hubs</a></li>
  <li><a href="external/azure-iot-hub.html" class="page">Azure IoT Hub</a></li>
  <li><a href="azure-storage-queue.html" class="page">Azure Storage Queue</a></li>
  <li><a href="couchbase.html" class="page">Couchbase</a></li>
  <li><a href="elasticsearch.html" class="page">Elasticsearch</a></li>
  <li><a href="external/eventuate.html" class="page">Eventuate</a></li>
  <li><a href="file.html" class="page">File</a></li>
  <li><a href="external/fs2.html" class="page">FS2</a></li>
  <li><a href="ftp.html" class="page">FTP</a></li>
  <li><a href="google-cloud-bigquery.html" class="page">Google Cloud BigQuery</a></li>
  <li><a href="google-cloud-pub-sub.html" class="page">Google Cloud Pub/Sub</a></li>
  <li><a href="google-cloud-pub-sub-grpc.html" class="page">Google Cloud Pub/Sub gRPC</a></li>
  <li><a href="google-cloud-storage.html" class="page">Google Cloud Storage</a></li>
  <li><a href="google-fcm.html" class="page">Google FCM</a></li>
  <li><a href="external/grpc.html" class="page">gRPC</a></li>
  <li><a href="hdfs.html" class="page">Hadoop Distributed File System - HDFS</a></li>
  <li><a href="hbase.html" class="page">HBase</a></li>
  <li><a href="external/http.html" class="page">HTTP</a></li>
  <li><a href="bluemix-cos.html" class="page">IBM Bluemix Cloud Object Storage</a></li>
  <li><a href="external/db2-event-store.html" class="page">IBM Db2 Event Store</a></li>
  <li><a href="influxdb.html" class="page">InfluxDB</a></li>
  <li><a href="ironmq.html" class="page">IronMQ</a></li>
  <li><a href="jms/index.html" class="page">JMS</a></li>
  <li><a href="external/mapr.html" class="page">MapR Database</a></li>
  <li><a href="mongodb.html" class="page">MongoDB</a></li>
  <li><a href="mqtt.html" class="page">MQTT</a></li>
  <li><a href="mqtt-streaming.html" class="page">MQTT Streaming</a></li>
  <li><a href="orientdb.html" class="page">OrientDB</a></li>
  <li><a href="external/pulsar.html" class="page">Pulsar</a></li>
  <li><a href="pravega.html" class="page">Pravega</a></li>
  <li><a href="sse.html" class="page">Server-sent Events (SSE)</a></li>
  <li><a href="slick.html" class="page">Slick (JDBC)</a></li>
  <li><a href="spring-web.html" class="page">Spring Web</a></li>
  <li><a href="external/tcp.html" class="page">TCP</a></li>
  <li><a href="udp.html" class="page">UDP</a></li>
  <li><a href="unix-domain-socket.html" class="page">Unix Domain Socket</a></li>
</ul>
</div>
</nav>
<footer class="nav-footer sticky-sidebar-footer">
<a href="https://akka.io"><img class="logo" src="images/akka-alpakka-reverse.svg"/></a>

</footer>
</aside>
<main class="fixed-shift-for-large expanded row">
<section class="site-content small-12 column">
<article class="page-content row">
<div class="small-12 column" id="docs">
<h1><a href="#apache-solr" name="apache-solr" class="anchor"><span class="anchor-link"></span></a>Apache Solr</h1><div class="callout note "><div class="callout-title">Apache Solr</div>
<p>Solr (pronounced &ldquo;solar&rdquo;) is an open source enterprise search platform, written in Java, from the Apache Lucene project. Its major features include full-text search, hit highlighting, faceted search, real-time indexing, dynamic clustering, database integration, NoSQL features and rich document (e.g., Word, PDF) handling. Providing distributed search and index replication, Solr is designed for scalability and fault tolerance. Solr is widely used for enterprise search and analytics use cases and has an active development community and regular releases.</p>
<p>&ndash; <a href="https://en.wikipedia.org/wiki/Apache_Solr">Wikipedia</a></p></div>
<p>Alpakka Solr provides Akka Stream sources and sinks for Apache Solr.</p>
<p>For more information about Solr please visit the <a href="https://lucene.apache.org/solr/resources.html">Solr documentation</a>.</p>
<table class="project-info">
<tr><th colspan="2">Project Info: Alpakka Solr</th></tr>
  <tr><th>Artifact</th><td><div>com.lightbend.akka</div>
  <div>akka-stream-alpakka-solr</div>
  <div>2.0.2</div>
  <div><a href="other-docs/snapshots.html">Snapshots are available</a></div>
  </td></tr>
  <tr><th>JDK versions</th><td><div>Adopt OpenJDK 8</div><div>Adopt OpenJDK 11</div></td></tr>
  <tr><th>Scala versions</th><td>2.12.11, 2.11.12, 2.13.3</td></tr>
  <tr><th>JPMS module name</th><td>akka.stream.alpakka.solr</td></tr>
  <tr><th>License</th><td><div><a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="noopener noreferrer">Apache-2.0</a></div>
  </td></tr>
  <tr><th>Readiness level</th><td><div class="readiness-level"><a href="https://developer.lightbend.com/docs/introduction/getting-help/support-terminology.html#community-driven" target="_blank" rel="noopener">Community-driven</a></div>
  <div>Since 0.17, 2018-02-19</div>
  </td></tr>
  <tr><th>Home page</th><td><a href="https://doc.akka.io/docs/alpakka/current">https://doc.akka.io/docs/alpakka/current</a></td></tr>
  <tr><th>API documentation</th><td>
  <div><a href="https://doc.akka.io/api/alpakka/2.0.2/akka/stream/alpakka/solr/index.html" target="_blank" rel="noopener noreferrer">API (Scaladoc)</a></div>
  </td></tr>
  <tr><th>Forums</th><td>
  <div><a href="https://discuss.lightbend.com/c/akka/" target="_blank" rel="noopener noreferrer">Lightbend Discuss</a></div>
  <div><a href="https://gitter.im/akka/akka" target="_blank" rel="noopener noreferrer">akka/akka Gitter channel</a></div>
  </td></tr>
  <tr><th>Release notes</th><td><a href="https://doc.akka.io/docs/alpakka/current/release-notes/index.html">In the documentation</a></td></tr>
  <tr><th>Issues</th><td><a href="https://github.com/akka/alpakka/labels/p%3Asolr" target="_blank" rel="noopener noreferrer">Github issues</a></td></tr>
  <tr><th>Sources</th><td><a href="https://github.com/akka/alpakka" target="_blank" rel="noopener noreferrer">https://github.com/akka/alpakka</a></td></tr>
</table>

<h2><a href="#artifacts" name="artifacts" class="anchor"><span class="anchor-link"></span></a>Artifacts</h2>
<dl class="dependency"><dt>sbt</dt><dd><pre class="prettyprint"><code class="language-scala">val AkkaVersion = "2.5.31"
libraryDependencies ++= Seq(
  "com.lightbend.akka" %% "akka-stream-alpakka-solr" % "2.0.2",
  "com.typesafe.akka" %% "akka-stream" % AkkaVersion
)</code></pre></dd><dt>Maven</dt><dd><pre class="prettyprint"><code class="language-xml">&lt;properties&gt;
  &lt;akka.version&gt;2.5.31&lt;/akka.version&gt;
  &lt;scala.binary.version&gt;2.12&lt;/scala.binary.version&gt;
&lt;/properties&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.lightbend.akka&lt;/groupId&gt;
  &lt;artifactId&gt;akka-stream-alpakka-solr_${scala.binary.version}&lt;/artifactId&gt;
  &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.typesafe.akka&lt;/groupId&gt;
  &lt;artifactId&gt;akka-stream_${scala.binary.version}&lt;/artifactId&gt;
  &lt;version&gt;${akka.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre></dd><dt>Gradle</dt><dd><pre class="prettyprint"><code class="language-gradle">versions += [
  AkkaVersion: "2.5.31",
  ScalaBinary: "2.12"
]
dependencies {
  compile group: 'com.lightbend.akka', name: "akka-stream-alpakka-solr_${versions.ScalaBinary}", version: '2.0.2',
  compile group: 'com.typesafe.akka', name: "akka-stream_${versions.ScalaBinary}", version: versions.AkkaVersion
}</code></pre></dd></dl>
<p>The table below shows direct dependencies of this module and the second tab shows all libraries it depends on transitively.</p>
<dl class="dependencies"><dt>Direct dependencies</dt><dd><table>
  <thead><tr><th>Organization</th><th>Artifact</th><th>Version</th></thead>
  <tbody>
    <tr><td>com.typesafe.akka</td><td>akka-stream_2.12</td><td><a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream_2.12/2.5.31" target="_blank">2.5.31</a></td></tr>
    <tr><td>org.apache.solr</td><td>solr-solrj</td><td><a href="https://mvnrepository.com/artifact/org.apache.solr/solr-solrj/7.7.3" target="_blank">7.7.3</a></td></tr>
    <tr><td>org.scala-lang</td><td>scala-library</td><td><a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.11" target="_blank">2.12.11</a></td></tr>
  </tbody>
</table></dd>
<dt>Dependency tree</dt><dd><pre>
com.typesafe.akka    akka-stream_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream_2.12/2.5.31" target="_blank">2.5.31</a>
    com.typesafe.akka    akka-actor_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.12/2.5.31" target="_blank">2.5.31</a>
        com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.3.3" target="_blank">1.3.3</a>
        org.scala-lang.modules    scala-java8-compat_2.12    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.12/0.8.0" target="_blank">0.8.0</a>
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.11" target="_blank">2.12.11</a>
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.11" target="_blank">2.12.11</a>
    com.typesafe.akka    akka-protobuf_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-protobuf_2.12/2.5.31" target="_blank">2.5.31</a>
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.11" target="_blank">2.12.11</a>
    com.typesafe    ssl-config-core_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe/ssl-config-core_2.12/0.3.8" target="_blank">0.3.8</a>
        com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.3.3" target="_blank">1.3.3</a>
        org.scala-lang.modules    scala-parser-combinators_2.12    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-parser-combinators_2.12/1.1.2" target="_blank">1.1.2</a>
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.11" target="_blank">2.12.11</a>
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.11" target="_blank">2.12.11</a>
    org.reactivestreams    reactive-streams    <a href="https://mvnrepository.com/artifact/org.reactivestreams/reactive-streams/1.0.2" target="_blank">1.0.2</a>
    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.11" target="_blank">2.12.11</a>
org.apache.solr    solr-solrj    <a href="https://mvnrepository.com/artifact/org.apache.solr/solr-solrj/7.7.3" target="_blank">7.7.3</a>
    commons-io    commons-io    <a href="https://mvnrepository.com/artifact/commons-io/commons-io/2.5" target="_blank">2.5</a>
    org.apache.commons    commons-math3    <a href="https://mvnrepository.com/artifact/org.apache.commons/commons-math3/3.6.1" target="_blank">3.6.1</a>
    org.apache.httpcomponents    httpclient    <a href="https://mvnrepository.com/artifact/org.apache.httpcomponents/httpclient/4.5.6" target="_blank">4.5.6</a>
    org.apache.httpcomponents    httpcore    <a href="https://mvnrepository.com/artifact/org.apache.httpcomponents/httpcore/4.4.10" target="_blank">4.4.10</a>
    org.apache.httpcomponents    httpmime    <a href="https://mvnrepository.com/artifact/org.apache.httpcomponents/httpmime/4.5.6" target="_blank">4.5.6</a>
    org.apache.zookeeper    zookeeper    <a href="https://mvnrepository.com/artifact/org.apache.zookeeper/zookeeper/3.4.14" target="_blank">3.4.14</a>
    org.codehaus.woodstox    stax2-api    <a href="https://mvnrepository.com/artifact/org.codehaus.woodstox/stax2-api/3.1.4" target="_blank">3.1.4</a>
    org.codehaus.woodstox    woodstox-core-asl    <a href="https://mvnrepository.com/artifact/org.codehaus.woodstox/woodstox-core-asl/4.4.1" target="_blank">4.4.1</a>
    org.noggit    noggit    <a href="https://mvnrepository.com/artifact/org.noggit/noggit/0.8" target="_blank">0.8</a>
    org.slf4j    jcl-over-slf4j    <a href="https://mvnrepository.com/artifact/org.slf4j/jcl-over-slf4j/1.7.24" target="_blank">1.7.24</a>
    org.slf4j    slf4j-api    <a href="https://mvnrepository.com/artifact/org.slf4j/slf4j-api/1.7.30" target="_blank">1.7.30</a>
org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.11" target="_blank">2.12.11</a></pre></dd>
</dl>

<h2><a href="#set-up-a-solr-client" name="set-up-a-solr-client" class="anchor"><span class="anchor-link"></span></a>Set up a Solr client</h2>

<p>Sources, Flows and Sinks provided by this connector need a prepared <a href="https://lucene.apache.org/solr/7_7_0/solr-solrj/?org/apache/solr/client/solrj/SolrClient.html" title="org.apache.solr.client.solrj.SolrClient"><code>SolrClient</code></a> (eg. <a href="https://lucene.apache.org/solr/7_7_0/solr-solrj/?org/apache/solr/client/solrj/impl/CloudSolrClient.html" title="org.apache.solr.client.solrj.impl.CloudSolrClient"><code>CloudSolrClient</code></a>) to access to Solr.</p>

<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L52-L56" target="_blank" title="Go to snippet source"></a><code class="language-scala">final val zookeeperPort = 9984
final val zookeeperHost = s&quot;127.0.0.1:$zookeeperPort/solr&quot;
implicit val solrClient: CloudSolrClient =
  new CloudSolrClient.Builder(Arrays.asList(zookeeperHost), Optional.empty()).build
</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L70-L859" target="_blank" title="Go to snippet source"></a><code class="language-java">private static final int zookeeperPort = 9984;
private static final String zookeeperHost = &quot;127.0.0.1:&quot; + zookeeperPort + &quot;/solr&quot;;

  CloudSolrClient solrClient =
      new CloudSolrClient.Builder(Arrays.asList(zookeeperHost), Optional.empty()).build();</code></pre></dd>
</dl>
<h2><a href="#reading-from-solr" name="reading-from-solr" class="anchor"><span class="anchor-link"></span></a>Reading from Solr</h2>
<p>Create a Solr <a href="https://lucene.apache.org/solr/7_7_0/solr-solrj/?org/apache/solr/client/solrj/io/stream/TupleStream.html" title="org.apache.solr.client.solrj.io.stream.TupleStream"><code>TupleStream</code></a> (eg. via <a href="https://lucene.apache.org/solr/7_7_0/solr-solrj/?org/apache/solr/client/solrj/io/stream/CloudSolrStream.html" title="org.apache.solr.client.solrj.io.stream.CloudSolrStream"><code>CloudSolrStream</code></a>) and use <code>SolrSource.fromTupleStream</code> (<span class="group-scala"><a href="/api/alpakka/2.0.2/akka/stream/alpakka/solr/scaladsl/SolrSource$.html" title="akka.stream.alpakka.solr.scaladsl.SolrSource"><code>API</code></a></span><span class="group-java"><a href="/api/alpakka/2.0.2/akka/stream/alpakka/solr/javadsl/SolrSource$.html" title="akka.stream.alpakka.solr.javadsl.SolrSource"><code>API</code></a></span>) to create a source.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L793-L804" target="_blank" title="Go to snippet source"></a><code class="language-scala">val factory = new StreamFactory().withCollectionZkHost(collection, zookeeperHost)
val solrClientCache = new SolrClientCache()
val streamContext = new StreamContext()
streamContext.setSolrClientCache(solrClientCache)

val expression =
  StreamExpressionParser.parse(s&quot;&quot;&quot;search($collection, q=*:*, fl=&quot;title,comment&quot;, sort=&quot;title asc&quot;)&quot;&quot;&quot;)
val stream: TupleStream = new CloudSolrStream(expression, factory)
stream.setStreamContext(streamContext)

val source = SolrSource
  .fromTupleStream(stream)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L889-L900" target="_blank" title="Go to snippet source"></a><code class="language-java">StreamFactory factory = new StreamFactory().withCollectionZkHost(collection, zookeeperHost);
SolrClientCache solrClientCache = new SolrClientCache();
StreamContext streamContext = new StreamContext();
streamContext.setSolrClientCache(solrClientCache);

String expressionStr =
    String.format(&quot;search(%s, q=*:*, fl=\&quot;title,comment\&quot;, sort=\&quot;title asc\&quot;)&quot;, collection);
StreamExpression expression = StreamExpressionParser.parse(expressionStr);
TupleStream stream = new CloudSolrStream(expression, factory);
stream.setStreamContext(streamContext);

Source&lt;Tuple, NotUsed&gt; source = SolrSource.fromTupleStream(stream);</code></pre></dd>
</dl>
<h2><a href="#writing-to-solr" name="writing-to-solr" class="anchor"><span class="anchor-link"></span></a>Writing to Solr</h2>
<p>Alpakka Solr batches updates to Solr by sending all updates of the same operation type at once to Solr. These batches are extracted from the elements within one collection sent to a Solr flow or sink. Updates of different types may be contained in a single collection sent, though. In case streams don&rsquo;t have natural batches of updates, you may use the <code>groupedWithin</code> operator to create count or time-based batches.</p>
<p>Alpakka Solr offers three styles for writing to Apache Solr:</p>
<ol>
  <li>Using <a href="https://lucene.apache.org/solr/7_7_0/solr-solrj/?org/apache/solr/common/SolrInputDocument.html" title="org.apache.solr.common.SolrInputDocument"><code>SolrInputDocument</code></a> (via <code>SolrSink.documents</code>, <code>SolrFlow.documents</code> and <code>SolrFlow.documentsWithPassThrough</code>)</li>
  <li>Annotated <em>Java Bean</em> classes supported by Solr&rsquo;s <a href="https://lucene.apache.org/solr/7_7_0/solr-solrj/?org/apache/solr/client/solrj/beans/DocumentObjectBinder.html" title="org.apache.solr.client.solrj.beans.DocumentObjectBinder"><code>DocumentObjectBinder</code></a> (via <code>SolrSink.beans</code>, <code>SolrFlow.beans</code> and <code>SolrFlow.beansWithPassThrough</code>)</li>
  <li>Typed streams with document binders to translate to <a href="https://lucene.apache.org/solr/7_7_0/solr-solrj/?org/apache/solr/common/SolrInputDocument.html" title="org.apache.solr.common.SolrInputDocument"><code>SolrInputDocument</code></a> (via <code>SolrSink.typeds</code>, <code>SolrFlow.typeds</code> and <code>SolrFlow.typedsWithPassThrough</code>)</li>
</ol>
<p>In all variations the data is wrapped into <code>WriteMessage</code>s.</p>
<h3><a href="#committing-and-configuration-for-updates" name="committing-and-configuration-for-updates" class="anchor"><span class="anchor-link"></span></a>Committing and configuration for updates</h3>
<p>Data sent to Solr is not searchable until it has been committed to the index. These are the major options for handling commits:</p>
<ol>
  <li>The Solr installation can be configured to use <strong>auto-commit</strong>.</li>
  <li>Specify <strong>commit-within</strong> in <code>SolrUpdateSettings</code> to trigger commits after every write through Alpakka Solr.</li>
  <li>Use explicit committing via the <code>SolrClient.commit</code> methods on stream completion as most examples show. As <code>commit</code> is a blocking operation, choose an appropriate execution context (preferably <em>not</em> <code>system.dispatcher</code>).</li>
</ol>
<p>Configuration of Solr committing is described in <a href="https://lucene.apache.org/solr/guide/7_7/updatehandlers-in-solrconfig.html#commits">UpdateHandlers in SolrConfig</a>.</p>
<h4><a href="#available-settings" name="available-settings" class="anchor"><span class="anchor-link"></span></a>Available settings</h4>
<table>
  <thead>
    <tr>
      <th>Parameter </th>
      <th>Default </th>
      <th>Description </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>commitWithin </td>
      <td>-1 </td>
      <td>Max time (in ms) before a commit will happen, -1 for explicit committing </td>
    </tr>
  </tbody>
</table>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L723-L726" target="_blank" title="Go to snippet source"></a><code class="language-scala">import akka.stream.alpakka.solr.SolrUpdateSettings

val settings = SolrUpdateSettings()
  .withCommitWithin(-1)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L12-L772" target="_blank" title="Go to snippet source"></a><code class="language-java">import akka.stream.alpakka.solr.SolrUpdateSettings;
SolrUpdateSettings settings = SolrUpdateSettings.create().withCommitWithin(-1);</code></pre></dd>
</dl>
<h3><a href="#writing-solrinputdocuments" name="writing-solrinputdocuments" class="anchor"><span class="anchor-link"></span></a>Writing <code>SolrInputDocument</code>s</h3>
<p>Use <code>SolrSink.document</code> to stream <code>SolrInputDocument</code> to Solr.</p>
<h4><a href="#defining-mappings" name="defining-mappings" class="anchor"><span class="anchor-link"></span></a>Defining mappings</h4>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L59-L74" target="_blank" title="Go to snippet source"></a><code class="language-scala">case class Book(title: String, comment: String = &quot;&quot;, routerOpt: Option[String] = None)

val bookToDoc: Book =&gt; SolrInputDocument = { b =&gt;
  val doc = new SolrInputDocument
  doc.setField(&quot;title&quot;, b.title)
  doc.setField(&quot;comment&quot;, b.comment)
  b.routerOpt.foreach { router =&gt;
    doc.setField(&quot;router&quot;, router)
  }
  doc
}

val tupleToBook: Tuple =&gt; Book = { t =&gt;
  val title = t.getString(&quot;title&quot;)
  Book(title, t.getString(&quot;comment&quot;))
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L77-L115" target="_blank" title="Go to snippet source"></a><code class="language-java">public static class Book {
  public String title;

  public String comment;

  public String router;

  public Book() {}

  public Book(String title) {
    this.title = title;
  }

  public Book(String title, String comment) {
    this.title = title;
    this.comment = comment;
  }

  public Book(String title, String comment, String router) {
    this.title = title;
    this.comment = comment;
    this.router = router;
  }
}

Function&lt;Book, SolrInputDocument&gt; bookToDoc =
    book -&gt; {
      SolrInputDocument doc = new SolrInputDocument();
      doc.setField(&quot;title&quot;, book.title);
      doc.setField(&quot;comment&quot;, book.comment);
      if (book.router != null) doc.setField(&quot;router&quot;, book.router);
      return doc;
    };

Function&lt;Tuple, Book&gt; tupleToBook =
    tuple -&gt; {
      String title = tuple.getString(&quot;title&quot;);
      return new Book(title, tuple.getString(&quot;comment&quot;));
    };</code></pre></dd>
</dl>
<p>Use <code>SolrSink.documents</code>, <code>SolrFlow.documents</code> or <code>SolrFlow.documentsWithPassThrough</code> to stream <code>SolrInputDocument</code>s to Solr.</p>
<p>A <code>SolrClient</code> must be provided to <span class="group-scala"><a href="/api/alpakka/2.0.2/akka/stream/alpakka/solr/scaladsl/SolrSink$.html" title="akka.stream.alpakka.solr.scaladsl.SolrSink"><code>SolrSink</code></a> implicitly.</span> <span class="group-java"><a href="/api/alpakka/2.0.2/akka/stream/alpakka/solr/javadsl/SolrSink$.html" title="akka.stream.alpakka.solr.javadsl.SolrSink"><code>SolrSink</code></a>.</span></p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L84-L98" target="_blank" title="Go to snippet source"></a><code class="language-scala">val copyCollection = SolrSource
  .fromTupleStream(stream)
  .map { tuple: Tuple =&gt;
    val book: Book = tupleToBook(tuple)
    val doc: SolrInputDocument = bookToDoc(book)
    WriteMessage.createUpsertMessage(doc)
  }
  .groupedWithin(5, 10.millis)
  .runWith(
    SolrSink.documents(collectionName, SolrUpdateSettings())
  )
  // explicit commit when stream ended
  .map { _ =&gt;
    solrClient.commit(collectionName)
  }(commitExecutionContext)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L124-L144" target="_blank" title="Go to snippet source"></a><code class="language-java">CompletionStage&lt;UpdateResponse&gt; copyCollection =
    SolrSource.fromTupleStream(stream)
        .map(
            tuple -&gt; {
              Book book = tupleToBook.apply(tuple);
              SolrInputDocument doc = bookToDoc.apply(book);
              return WriteMessage.createUpsertMessage(doc);
            })
        .groupedWithin(5, Duration.ofMillis(10))
        .runWith(
            SolrSink.documents(collectionName, SolrUpdateSettings.create(), solrClient),
            materializer)
        // explicit commit when stream ended
        .thenApply(
            done -&gt; {
              try {
                return solrClient.commit(collectionName);
              } catch (Exception e) {
                throw new IllegalStateException(e);
              }
            });</code></pre></dd>
</dl>
<h3><a href="#writing-java-beans" name="writing-java-beans" class="anchor"><span class="anchor-link"></span></a>Writing Java beans</h3>
<p>Firstly, create a POJO.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L127-L130" target="_blank" title="Go to snippet source"></a><code class="language-scala">import org.apache.solr.client.solrj.beans.Field

import scala.annotation.meta.field
case class BookBean(@(Field @field) title: String)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L177-L184" target="_blank" title="Go to snippet source"></a><code class="language-java">class BookBean {
  @Field(&quot;title&quot;)
  public String title;

  public BookBean(String title) {
    this.title = title;
  }
}</code></pre></dd>
</dl>
<p>Use <code>SolrSink.beans</code>, <code>SolrFlow.beans</code> or <code>SolrFlow.beansWithPassThrough</code> to stream POJOs to Solr.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L134-L147" target="_blank" title="Go to snippet source"></a><code class="language-scala">val copyCollection = SolrSource
  .fromTupleStream(stream)
  .map { tuple: Tuple =&gt;
    val title = tuple.getString(&quot;title&quot;)
    WriteMessage.createUpsertMessage(BookBean(title))
  }
  .groupedWithin(5, 10.millis)
  .runWith(
    SolrSink.beans[BookBean](collectionName, SolrUpdateSettings())
  )
  // explicit commit when stream ended
  .map { _ =&gt;
    solrClient.commit(collectionName)
  }(commitExecutionContext)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L188-L208" target="_blank" title="Go to snippet source"></a><code class="language-java">CompletionStage&lt;UpdateResponse&gt; copyCollection =
    SolrSource.fromTupleStream(stream)
        .map(
            tuple -&gt; {
              String title = tuple.getString(&quot;title&quot;);
              return WriteMessage.createUpsertMessage(new BookBean(title));
            })
        .groupedWithin(5, Duration.ofMillis(10))
        .runWith(
            SolrSink.beans(
                collectionName, SolrUpdateSettings.create(), solrClient, BookBean.class),
            materializer)
        // explicit commit when stream ended
        .thenApply(
            done -&gt; {
              try {
                return solrClient.commit(collectionName);
              } catch (Exception e) {
                throw new IllegalStateException(e);
              }
            });</code></pre></dd>
</dl>
<h3><a href="#writing-arbitrary-classes-via-custom-binding" name="writing-arbitrary-classes-via-custom-binding" class="anchor"><span class="anchor-link"></span></a>Writing arbitrary classes via custom binding</h3>
<p>Use <code>SolrSink.typeds</code>, <code>SolrFlow.typeds</code> or <code>SolrFlow.typedsWithPassThrough</code> to stream messages with custom binding to Solr.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L177-L195" target="_blank" title="Go to snippet source"></a><code class="language-scala">val copyCollection = SolrSource
  .fromTupleStream(stream)
  .map { tuple: Tuple =&gt;
    val book: Book = tupleToBook(tuple)
    WriteMessage.createUpsertMessage(book)
  }
  .groupedWithin(5, 10.millis)
  .runWith(
    SolrSink
      .typeds[Book](
        collectionName,
        SolrUpdateSettings(),
        binder = bookToDoc
      )
  )
  // explicit commit when stream ended
  .map { _ =&gt;
    solrClient.commit(collectionName)
  }(commitExecutionContext)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L241-L257" target="_blank" title="Go to snippet source"></a><code class="language-java">CompletionStage&lt;UpdateResponse&gt; copyCollection =
    SolrSource.fromTupleStream(stream)
        .map(tuple -&gt; WriteMessage.createUpsertMessage(tupleToBook.apply(tuple)))
        .groupedWithin(5, Duration.ofMillis(10))
        .runWith(
            SolrSink.typeds(
                collectionName, SolrUpdateSettings.create(), bookToDoc, solrClient, Book.class),
            materializer)
        // explicit commit when stream ended
        .thenApply(
            done -&gt; {
              try {
                return solrClient.commit(collectionName);
              } catch (Exception e) {
                throw new IllegalStateException(e);
              }
            });</code></pre></dd>
</dl>
<h4><a href="#using-a-flow-with-custom-binding" name="using-a-flow-with-custom-binding" class="anchor"><span class="anchor-link"></span></a>Using a flow with custom binding</h4>
<p>You can also build flow stages with <span class="group-scala"><a href="/api/alpakka/2.0.2/akka/stream/alpakka/solr/scaladsl/SolrFlow$.html" title="akka.stream.alpakka.solr.scaladsl.SolrFlow"><code>SolrFlow</code></a>.</span> <span class="group-java"><a href="/api/alpakka/2.0.2/akka/stream/alpakka/solr/javadsl/SolrFlow$.html" title="akka.stream.alpakka.solr.javadsl.SolrFlow"><code>SolrFlow</code></a>.</span></p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L224-L244" target="_blank" title="Go to snippet source"></a><code class="language-scala">val copyCollection = SolrSource
  .fromTupleStream(stream)
  .map { tuple: Tuple =&gt;
    val book: Book = tupleToBook(tuple)
    WriteMessage.createUpsertMessage(book)
  }
  .groupedWithin(5, 10.millis)
  .via(
    SolrFlow
      .typeds[Book](
        collectionName,
        SolrUpdateSettings(),
        binder = bookToDoc
      )
  )
  .runWith(Sink.seq)
  // explicit commit when stream ended
  .map { seq =&gt;
    solrClient.commit(collectionName)
    seq
  }(commitExecutionContext)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L290-L306" target="_blank" title="Go to snippet source"></a><code class="language-java">CompletionStage&lt;UpdateResponse&gt; copyCollection =
    SolrSource.fromTupleStream(stream)
        .map(tuple -&gt; WriteMessage.createUpsertMessage(tupleToBook.apply(tuple)))
        .groupedWithin(5, Duration.ofMillis(10))
        .via(
            SolrFlow.typeds(
                collectionName, SolrUpdateSettings.create(), bookToDoc, solrClient, Book.class))
        .runWith(Sink.ignore(), materializer)
        // explicit commit when stream ended
        .thenApply(
            done -&gt; {
              try {
                return solrClient.commit(collectionName);
              } catch (Exception e) {
                throw new IllegalStateException(e);
              }
            });</code></pre></dd>
</dl>
<h4><a href="#passing-data-through-solrflow" name="passing-data-through-solrflow" class="anchor"><span class="anchor-link"></span></a>Passing data through SolrFlow</h4>
<p>All flow types (<code>documents</code>, <code>beans</code>, <code>typeds</code>) exist with pass-through support: Use <code>SolrFlow.documentsWithPassThrough</code>, <code>SolrFlow.beansWithPassThrough</code> or <code>SolrFlow.typedsWithPassThrough</code>.</p>
<p>When streaming documents from Kafka, you might want to commit to Kafka <strong>AFTER</strong> the document has been written to Solr. This scenario uses implicit committing via the <strong>commit within</strong> setting.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L299-L324" target="_blank" title="Go to snippet source"></a><code class="language-scala">// Note: This code mimics Alpakka Kafka APIs
val copyCollection = kafkaConsumerSource
  .map { kafkaMessage: CommittableMessage =&gt;
    val book = kafkaMessage.book
    // Transform message so that we can write to solr
    WriteMessage.createUpsertMessage(book).withPassThrough(kafkaMessage.committableOffset)
  }
  .groupedWithin(5, 10.millis)
  .via( // write to Solr
    SolrFlow.typedsWithPassThrough[Book, CommittableOffset](
      collectionName,
      // use implicit commits to Solr
      SolrUpdateSettings().withCommitWithin(5),
      binder = bookToDoc
    )
  ) // check status and collect Kafka offsets
  .map { messageResults =&gt;
    val offsets = messageResults.map { result =&gt;
      if (result.status != 0)
        throw new Exception(&quot;Failed to write message to Solr&quot;)
      result.passThrough
    }
    CommittableOffsetBatch(offsets)
  }
  .mapAsync(1)(_.commitScaladsl())
  .runWith(Sink.ignore)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L345-L377" target="_blank" title="Go to snippet source"></a><code class="language-java">// Note: This code mimics Alpakka Kafka APIs
CompletionStage&lt;Done&gt; completion =
    kafkaConsumerSource // Assume we get this from Kafka
        .map(
            kafkaMessage -&gt; {
              Book book = kafkaMessage.book;
              // Transform message so that we can write to elastic
              return WriteMessage.createUpsertMessage(book)
                  .withPassThrough(kafkaMessage.committableOffset);
            })
        .groupedWithin(5, Duration.ofMillis(10))
        .via(
            SolrFlow.typedsWithPassThrough(
                collectionName,
                // use implicit commits to Solr
                SolrUpdateSettings.create().withCommitWithin(5),
                bookToDoc,
                solrClient,
                Book.class))
        .map(
            messageResults -&gt;
                messageResults.stream()
                    .map(
                        result -&gt; {
                          if (result.status() != 0) {
                            throw new RuntimeException(&quot;Failed to write message to Solr&quot;);
                          }
                          return result.passThrough();
                        })
                    .collect(Collectors.toList()))
        .map(ConsumerMessage::createCommittableOffsetBatch)
        .mapAsync(1, CommittableOffsetBatch::commitJavadsl)
        .runWith(Sink.ignore(), materializer);</code></pre></dd>
</dl>
<h4><a href="#excluding-messages" name="excluding-messages" class="anchor"><span class="anchor-link"></span></a>Excluding messages</h4>
<p>Failure to deserialize a kafka message is a particular case of conditional message processing. It is also likely that we would have no message to produce to SolR when we encounter messages that fail to deserialize. The solr flow will not let us pass through the corresponding committable offset without doing a request to solr.</p>
<p>Use <code>WriteMessage.createPassThrough</code> to exclude this message without doing any change on solr inside a flow.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L685-L708" target="_blank" title="Go to snippet source"></a><code class="language-scala">// Note: This code mimics Alpakka Kafka APIs
val copyCollection = kafkaConsumerSource
  .map { offset: CommittableOffset =&gt;
    // Transform message so that we can write to solr
    WriteMessage.createPassThrough(offset).withSource(new SolrInputDocument())
  }
  .groupedWithin(5, 10.millis)
  .via( // write to Solr
    SolrFlow.documentsWithPassThrough[CommittableOffset](
      collectionName,
      // use implicit commits to Solr
      SolrUpdateSettings().withCommitWithin(5)
    )
  ) // check status and collect Kafka offsets
  .map { messageResults =&gt;
    val offsets = messageResults.map { result =&gt;
      if (result.status != 0)
        throw new Exception(&quot;Failed to write message to Solr&quot;)
      result.passThrough
    }
    CommittableOffsetBatch(offsets)
  }
  .mapAsync(1)(_.commitScaladsl())
  .runWith(Sink.ignore)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L725-L754" target="_blank" title="Go to snippet source"></a><code class="language-java">// Note: This code mimics Alpakka Kafka APIs
CompletionStage&lt;Done&gt; completion =
    kafkaConsumerSource // Assume we get this from Kafka
        .map(
            kafkaMessage -&gt; {
              // Transform message so that we can write to elastic
              return WriteMessage.createPassThrough(kafkaMessage)
                  .withSource(new SolrInputDocument());
            })
        .groupedWithin(5, Duration.ofMillis(10))
        .via(
            SolrFlow.documentsWithPassThrough(
                collectionName,
                // use implicit commits to Solr
                SolrUpdateSettings.create().withCommitWithin(5),
                solrClient))
        .map(
            messageResults -&gt;
                messageResults.stream()
                    .map(
                        result -&gt; {
                          if (result.status() != 0) {
                            throw new RuntimeException(&quot;Failed to write message to Solr&quot;);
                          }
                          return result.passThrough();
                        })
                    .collect(Collectors.toList()))
        .map(ConsumerMessage::createCommittableOffsetBatch)
        .mapAsync(1, CommittableOffsetBatch::commitJavadsl)
        .runWith(Sink.ignore(), materializer);</code></pre></dd>
</dl>
<h2><a href="#update-documents" name="update-documents" class="anchor"><span class="anchor-link"></span></a>Update documents</h2>
<p>With <code>WriteMessage.createUpdateMessage</code> documents can be updated atomically. All flow and sink types (<code>documents</code>, <code>beans</code>, <code>typeds</code>) support atomic updates.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L424-L445" target="_blank" title="Go to snippet source"></a><code class="language-scala">val updateCollection = SolrSource
  .fromTupleStream(stream2)
  .map { tuple: Tuple =&gt;
    val id = tuple.fields.get(&quot;title&quot;).toString
    val comment = tuple.fields.get(&quot;comment&quot;).toString
    WriteMessage.createUpdateMessage[SolrInputDocument](
      idField = &quot;title&quot;,
      idValue = id,
      updates = Map(
        &quot;comment&quot; -&gt;
        Map(&quot;set&quot; -&gt; (comment + &quot; It is a good book!!!&quot;))
      )
    )
  }
  .groupedWithin(5, 10.millis)
  .runWith(
    SolrSink.documents(collectionName, SolrUpdateSettings())
  )
  // explicit commit when stream ended
  .map { _ =&gt;
    solrClient.commit(collectionName)
  }(commitExecutionContext)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L503-L527" target="_blank" title="Go to snippet source"></a><code class="language-java">CompletionStage&lt;UpdateResponse&gt; updateCollection =
    SolrSource.fromTupleStream(stream2)
        .map(
            t -&gt; {
              String id = t.fields.get(&quot;title&quot;).toString();
              String comment = t.fields.get(&quot;comment&quot;).toString();
              Map&lt;String, Object&gt; m2 = new HashMap&lt;&gt;();
              m2.put(&quot;set&quot;, (comment + &quot; It&#39;s is a good book!!!&quot;));
              Map&lt;String, Map&lt;String, Object&gt;&gt; updates = new HashMap&lt;&gt;();
              updates.put(&quot;comment&quot;, m2);
              return WriteMessage.&lt;SolrInputDocument&gt;createUpdateMessage(&quot;title&quot;, id, updates);
            })
        .groupedWithin(5, Duration.ofMillis(10))
        .runWith(
            SolrSink.documents(collectionName, SolrUpdateSettings.create(), solrClient),
            materializer)
        // explicit commit when stream ended
        .thenApply(
            done -&gt; {
              try {
                return solrClient.commit(collectionName);
              } catch (Exception e) {
                throw new IllegalStateException(e);
              }
            });</code></pre></dd>
</dl>
<p>If a collection contains a router field, use the <code>WriteMessage.createUpdateMessage(...).withRoutingFieldValue(..)</code> to set the router field.</p>
<h2><a href="#delete-documents-by-ids" name="delete-documents-by-ids" class="anchor"><span class="anchor-link"></span></a>Delete documents by ids</h2>
<p>With <code>WriteMessage.createDeleteMessage(id)</code> documents may be deleted by ID. All flow and sink types (<code>documents</code>, <code>beans</code>, <code>typeds</code>) support deleting.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L368-L381" target="_blank" title="Go to snippet source"></a><code class="language-scala">val deleteDocuments = SolrSource
  .fromTupleStream(stream2)
  .map { tuple: Tuple =&gt;
    val id = tuple.fields.get(&quot;title&quot;).toString
    WriteMessage.createDeleteMessage[SolrInputDocument](id)
  }
  .groupedWithin(5, 10.millis)
  .runWith(
    SolrSink.documents(collectionName, SolrUpdateSettings())
  )
  // explicit commit when stream ended
  .map { _ =&gt;
    solrClient.commit(collectionName)
  }(commitExecutionContext)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L435-L454" target="_blank" title="Go to snippet source"></a><code class="language-java">CompletionStage&lt;UpdateResponse&gt; deleteDocuments =
    SolrSource.fromTupleStream(stream2)
        .map(
            t -&gt; {
              String id = tupleToBook.apply(t).title;
              return WriteMessage.&lt;SolrInputDocument&gt;createDeleteMessage(id);
            })
        .groupedWithin(5, Duration.ofMillis(10))
        .runWith(
            SolrSink.documents(collectionName, SolrUpdateSettings.create(), solrClient),
            materializer)
        // explicit commit when stream ended
        .thenApply(
            done -&gt; {
              try {
                return solrClient.commit(collectionName);
              } catch (Exception e) {
                throw new IllegalStateException(e);
              }
            });</code></pre></dd>
</dl>
<h2><a href="#delete-documents-by-query" name="delete-documents-by-query" class="anchor"><span class="anchor-link"></span></a>Delete documents by query</h2>
<p>With <code>WriteMessage.createDeleteByQueryMessage(query)</code> documents matching a query may be deleted. All flow and sink types (<code>documents</code>, <code>beans</code>, <code>typeds</code>) support deleting.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/scala/docs/scaladsl/SolrSpec.scala#L626-L641" target="_blank" title="Go to snippet source"></a><code class="language-scala">val deleteByQuery = SolrSource
  .fromTupleStream(stream2)
  .map { tuple: Tuple =&gt;
    val title = tuple.fields.get(&quot;title&quot;).toString
    WriteMessage.createDeleteByQueryMessage[SolrInputDocument](
      s&quot;&quot;&quot;title:&quot;$title&quot; &quot;&quot;&quot;
    )
  }
  .groupedWithin(5, 10.millis)
  .runWith(
    SolrSink.documents(collectionName, SolrUpdateSettings())
  )
  // explicit commit when stream ended
  .map { _ =&gt;
    solrClient.commit(collectionName)
  }(commitExecutionContext)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.2/solr/src/test/java/docs/javadsl/SolrTest.java#L677-L697" target="_blank" title="Go to snippet source"></a><code class="language-java">CompletionStage&lt;UpdateResponse&gt; deleteByQuery =
    SolrSource.fromTupleStream(stream2)
        .map(
            t -&gt; {
              String id = t.fields.get(&quot;title&quot;).toString();
              return WriteMessage.&lt;SolrInputDocument&gt;createDeleteByQueryMessage(
                  &quot;title:\&quot;&quot; + id + &quot;\&quot;&quot;);
            })
        .groupedWithin(5, Duration.ofMillis(10))
        .runWith(
            SolrSink.documents(collectionName, SolrUpdateSettings.create(), solrClient),
            materializer)
        // explicit commit when stream ended
        .thenApply(
            done -&gt; {
              try {
                return solrClient.commit(collectionName);
              } catch (Exception e) {
                throw new IllegalStateException(e);
              }
            });</code></pre></dd>
</dl>
</div>
</article>
<div class="row">
<div class="small-12 column">
<section class="nav-prev-next row">
<div class="nav-prev small-6 column">
<a href="kudu.html"><i class="icon-prev"></i> <span class="link-prev">Apache Kudu</span></a>
</div>
<div class="nav-next small-6 column clearfix">
<a class="float-right" href="avroparquet.html">Avro Parquet <i class="icon-next"></i></a>
</div>
</section>
</div>
</div>
<div class="source-github row">
Found an error in this documentation? The source code for this page can be found <a href="https://github.com/akka/alpakka/tree/v2.0.2/docs/src/main/paradox/solr.md">here</a>.
Please feel free to edit and contribute a pull request.
</div>

<footer class="page-footer row clearfix">
<img class="akka-icon float-left show-for-medium" src="images/akka-icon.svg" />
<section class="copyright">
<div>Alpakka is Open Source and available under the Apache 2 License.</div>
<p class="legal">
&copy; 2011-2020 <a href="https://www.lightbend.com" target="_blank">Lightbend, Inc.</a> |
<a href="https://www.lightbend.com/legal/licenses" target="_blank">Licenses</a> |
<a href="https://www.lightbend.com/legal/terms" target="_blank">Terms</a> |
<a href="https://www.lightbend.com/legal/privacy" target="_blank">Privacy Policy</a> |
<a href="https://akka.io/cookie/" target="_blank">Cookie Listing</a> |
<a class="optanon-toggle-display">Cookie Settings</a>
</p>
</section>

</footer>
</section>
</main>
</div>

<script type="text/javascript" src="js/scrollsneak.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="js/groups.js"></script>
<script type="text/javascript" src="js/page.js"></script>
<script type="text/javascript" src="js/magellan.js"></script>
<script type="text/javascript" src="js/metadata-toggle.js"></script>

<style type="text/css">@import "lib/prettify/prettify.css";</style>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(){window.prettyPrint && prettyPrint()});
//]]></script>
<script type="text/javascript" src="assets/js/warnOldVersion.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(jq){initOldVersionWarnings(jq, '2.0.2', 'https://doc.akka.io/docs/alpakka/current')});
//]]></script>


</body>
</html>
