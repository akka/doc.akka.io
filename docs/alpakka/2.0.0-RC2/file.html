<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>File &bull; Alpakka Documentation</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="Alpakka is a Reactive Enterprise Integration library for Java and Scala, based on Reactive Streams and Akka."/>
<link rel="canonical" href="https://doc.akka.io/docs/alpakka/current/file.html"/>
<script type="text/javascript" src="lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="lib/foundation/dist/js/foundation.min.js"></script>
<link rel="stylesheet" type="text/css" href="lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="lib/foundation/dist/css/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<link rel="stylesheet" type="text/css" href="css/icons.css"/>
<link rel="stylesheet" type="text/css" href="css/page-7.css"/>
<link rel="stylesheet" type="text/css" href="css/banner-1.css"/>
<link rel="shortcut icon" href="images/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png"/>
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png"/>
<link rel="manifest" href="images/manifest.json"/>
<meta name="msapplication-TileImage" content="images/mstile-150x150.png"/>
<meta name="msapplication-TileColor" content="#15a9ce"/>
<meta name="theme-color" content="#15a9ce"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) start -->
<script src="https://optanon.blob.core.windows.net/consent/159bb13d-6748-4399-806e-ac28db879785.js" type="text/javascript" charset="UTF-8"></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) end -->
<!--Google Analytics-->
<script type="text/plain" class="optanon-category-2">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', '']);
_gaq.push(['_setDomainName', '']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})()
</script>
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-2">
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KBJGH35');
</script>
<!--Marketo-->
<script type="text/plain" class="optanon-category-3">
(function() {
var didInit = false;
function initMunchkin() {
if(didInit === false) {
didInit = true;
Munchkin.init('558-NCX-702', { 'asyncOnly': true, 'disableClickDelay': true });
}
}
var s = document.createElement('script');
s.type = 'text/javascript';
s.async = true;
s.src = '//munchkin.marketo.net/munchkin.js';
s.onreadystatechange = function() {
if (this.readyState == 'complete' || this.readyState == 'loaded') {
initMunchkin();
}
};
s.onload = initMunchkin;
document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
</head>

<body id="underlay" data-toggler="nav-open">
<div id="lightbend-banner" class="lightbend-banner akka full-width" data-category="OSS Lightbend Banner Impression" data-label="Akka Banner Impression">
<div class="wrapper">
<div class="brand">
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Lightbend Logo - Akka Banner" href="https://www.lightbend.com?r=oss-banner-akka" target="_blank">
<img class="lightbend-logo" src="images/banner-logos/lightbend-reverse.svg" alt="Lightbend" title="Lightbend">
</a>
</div>
<div class="nav">
<a class="banner-btn oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Enhance your Akka systems with Akka Platform [Button] - Akka Banner" href="https://www.lightbend.com/akka-core-of-lightbend?r=oss-banner-akka" target="_blank">
<span>Enhance your Akka systems with</span>
<img class="akka-platform-reverse-logo" src="images/banner-logos/akka-platform-reverse.svg" alt="Akka Platform" title="Akka Platform">
</a>
<div class="drop-down">
<svg class="svg-chevon-circle-down" version="1.1" id="Chevron_circled_down" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
<path fill="#ffffff" d="M12.505,8.698L10,11L7.494,8.698c-0.198-0.196-0.518-0.196-0.718,0c-0.197,0.196-0.197,0.515,0,0.71l2.864,2.807
c0.199,0.196,0.52,0.196,0.717,0l2.864-2.807c0.199-0.195,0.198-0.514,0-0.71C13.024,8.502,12.704,8.502,12.505,8.698z M10,0.4
c-5.302,0-9.6,4.298-9.6,9.6c0,5.303,4.298,9.6,9.6,9.6s9.6-4.297,9.6-9.6C19.6,4.698,15.302,0.4,10,0.4z M10,18.354
c-4.615,0-8.354-3.74-8.354-8.354c0-4.614,3.739-8.354,8.354-8.354c4.613,0,8.354,3.74,8.354,8.354
C18.354,14.614,14.613,18.354,10,18.354z" />
</svg>
<div class="drop-down-content">
<div class="lightbend-family">
<a href="https://cloudflow.io" class="cloudflow oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Cloudflow - Logo Tag Line - Akka Banner">
<img class="cloudflow-full-color-logo" src="images/banner-logos/cloudflow-full-color.svg" alt="Cloudflow by Lightbend" title="Cloudflow by Lightbend">
</a>
<a href="https://cloudstate.io" class="cloudstate oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Cloudstate - Logo Tag Line - Akka Banner">
<img class="cloudstate-full-color-logo" src="images/banner-logos/cloudstate-full-color.svg" alt="Cloudstate by Lightbend" title="Cloudstate by Lightbend">
</a>
<a href="https://www.lagomframework.com" class="lagom oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Lagom - Logo Tag Line - Akka Banner">
<img class="lagom-full-color-logo" src="images/banner-logos/lagom-full-color.svg" alt="Lagom Framework by Lightbend" title="Lagom Framework by Lightbend">
</a>
<a href="https://www.playframework.com" class="play oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Play - Logo Tag Line - Akka Banner">
<img class="play-full-color-logo" src="images/banner-logos/play-full-color.svg" alt="Play Framework by Lightbend" title="Play Framework by Lightbend">
</a>
<a href="https://www.scala-lang.org" class="scala oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Scala - Logo Tag Line - Akka Banner">
<img class="scala-full-color-logo" src="images/banner-logos/scala-full-color.svg" alt="Scala by Lightbend" title="Scala by Lightbend">
</a>
<div class="akka current">
<img class="akka-full-color-logo" src="images/banner-logos/akka-full-color.svg" alt="Akka by Lightbend" title="Akka by Lightbend">
<span>From the creators of <strong>Akka</strong>, get technology enhancements, monitoring, and expert support with Akka Platform from Lightbend.</span>
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Learn More [Button] - Akka Banner" href="https://www.lightbend.com/akka-core-of-lightbend?r=oss-banner-akka" target="_blank">Learn More</a>
</div>
</div>
<div class="title">The Lightbend Family</div>
</div>      
</div>
</div>
</div>
</div>
<header class="site-header hide-for-large">
<div class="sticky-header clearfix">
<a href="https://akka.io"><img class="logo" src="images/akka-alpakka-reverse.svg"/></a>

<button class="menu-icon float-right" type="button" data-toggle="underlay overlay"></button>
</div>
<div id="overlay" class="overlay-nav" data-toggler="nav-open">
<header class="nav-header">
<div class="nav-header-title">
<h1><a href="index.html">Alpakka Documentation</a></h1>
</div>
<div class="nav-header-version">
Version 2.0.0-RC2
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
</div>
</header>
<nav class="nav-toc">
<ul>
  <li><a href="overview.html" class="page">Overview</a></li>
  <li><a href="data-transformations/index.html" class="page">Data Transformations</a></li>
  <li><a href="amqp.html" class="page">AMQP</a></li>
  <li><a href="external/apache-camel.html" class="page">Apache Camel</a></li>
  <li><a href="cassandra.html" class="page">Apache Cassandra</a></li>
  <li><a href="geode.html" class="page">Apache Geode</a></li>
  <li><a href="kafka.html" class="page">Apache Kafka</a></li>
  <li><a href="kudu.html" class="page">Apache Kudu</a></li>
  <li><a href="solr.html" class="page">Apache Solr</a></li>
  <li><a href="avroparquet.html" class="page">Avro Parquet</a></li>
  <li><a href="dynamodb.html" class="page">AWS DynamoDB</a></li>
  <li><a href="kinesis.html" class="page">AWS Kinesis and Firehose</a></li>
  <li><a href="awslambda.html" class="page">AWS Lambda</a></li>
  <li><a href="s3.html" class="page">AWS S3</a></li>
  <li><a href="sns.html" class="page">AWS SNS</a></li>
  <li><a href="sqs.html" class="page">AWS SQS</a></li>
  <li><a href="external/azure-event-hubs.html" class="page">Azure Event Hubs</a></li>
  <li><a href="external/azure-iot-hub.html" class="page">Azure IoT Hub</a></li>
  <li><a href="azure-storage-queue.html" class="page">Azure Storage Queue</a></li>
  <li><a href="couchbase.html" class="page">Couchbase</a></li>
  <li><a href="elasticsearch.html" class="page">Elasticsearch</a></li>
  <li><a href="external/eventuate.html" class="page">Eventuate</a></li>
  <li><a href="file.html#file" class="active page">File</a>
  <ul>
    <li><a href="file.html#artifacts" class="header">Artifacts</a></li>
    <li><a href="file.html#writing-to-and-reading-from-files" class="header">Writing to and reading from files</a></li>
    <li><a href="file.html#tailing-a-file-into-a-stream" class="header">Tailing a file into a stream</a></li>
    <li><a href="file.html#creating-directories" class="header">Creating directories</a></li>
    <li><a href="file.html#listing-directory-contents" class="header">Listing directory contents</a></li>
    <li><a href="file.html#listening-to-changes-in-a-directory" class="header">Listening to changes in a directory</a></li>
    <li><a href="file.html#rotating-the-file-to-stream-into" class="header">Rotating the file to stream into</a></li>
    <li><a href="file.html#zip-archive" class="header">ZIP Archive</a></li>
    <li><a href="file.html#tar-archive" class="header">TAR Archive</a></li>
  </ul></li>
  <li><a href="external/fs2.html" class="page">FS2</a></li>
  <li><a href="ftp.html" class="page">FTP</a></li>
  <li><a href="google-cloud-pub-sub.html" class="page">Google Cloud Pub/Sub</a></li>
  <li><a href="google-cloud-pub-sub-grpc.html" class="page">Google Cloud Pub/Sub gRPC</a></li>
  <li><a href="google-cloud-storage.html" class="page">Google Cloud Storage</a></li>
  <li><a href="google-fcm.html" class="page">Google FCM</a></li>
  <li><a href="external/grpc.html" class="page">gRPC</a></li>
  <li><a href="hdfs.html" class="page">Hadoop Distributed File System - HDFS</a></li>
  <li><a href="hbase.html" class="page">HBase</a></li>
  <li><a href="external/http.html" class="page">HTTP</a></li>
  <li><a href="bluemix-cos.html" class="page">IBM Bluemix Cloud Object Storage</a></li>
  <li><a href="external/db2-event-store.html" class="page">IBM Db2 Event Store</a></li>
  <li><a href="influxdb.html" class="page">InfluxDB</a></li>
  <li><a href="ironmq.html" class="page">IronMQ</a></li>
  <li><a href="jms/index.html" class="page">JMS</a></li>
  <li><a href="external/mapr.html" class="page">MapR Database</a></li>
  <li><a href="mongodb.html" class="page">MongoDB</a></li>
  <li><a href="mqtt.html" class="page">MQTT</a></li>
  <li><a href="mqtt-streaming.html" class="page">MQTT Streaming</a></li>
  <li><a href="orientdb.html" class="page">OrientDB</a></li>
  <li><a href="external/pulsar.html" class="page">Pulsar</a></li>
  <li><a href="pravega.html" class="page">Pravega</a></li>
  <li><a href="sse.html" class="page">Server-sent Events (SSE)</a></li>
  <li><a href="slick.html" class="page">Slick (JDBC)</a></li>
  <li><a href="spring-web.html" class="page">Spring Web</a></li>
  <li><a href="external/tcp.html" class="page">TCP</a></li>
  <li><a href="udp.html" class="page">UDP</a></li>
  <li><a href="unix-domain-socket.html" class="page">Unix Domain Socket</a></li>
</ul>
</nav>
</div>
</header>
<div class="site-content-wrapper">
<aside class="sticky-sidebar show-for-large">
<header class="nav-header sticky-sidebar-header">
<div class="nav-header-title">
<h1><a href="index.html">Alpakka Documentation</a></h1>
</div>
<div class="nav-header-version">
Version 2.0.0-RC2
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
</div>
</header>
<nav class="site-nav sticky-sidebar-contents">
<div class="nav-toc">
<ul>
  <li><a href="overview.html" class="page">Overview</a></li>
  <li><a href="data-transformations/index.html" class="page">Data Transformations</a></li>
  <li><a href="amqp.html" class="page">AMQP</a></li>
  <li><a href="external/apache-camel.html" class="page">Apache Camel</a></li>
  <li><a href="cassandra.html" class="page">Apache Cassandra</a></li>
  <li><a href="geode.html" class="page">Apache Geode</a></li>
  <li><a href="kafka.html" class="page">Apache Kafka</a></li>
  <li><a href="kudu.html" class="page">Apache Kudu</a></li>
  <li><a href="solr.html" class="page">Apache Solr</a></li>
  <li><a href="avroparquet.html" class="page">Avro Parquet</a></li>
  <li><a href="dynamodb.html" class="page">AWS DynamoDB</a></li>
  <li><a href="kinesis.html" class="page">AWS Kinesis and Firehose</a></li>
  <li><a href="awslambda.html" class="page">AWS Lambda</a></li>
  <li><a href="s3.html" class="page">AWS S3</a></li>
  <li><a href="sns.html" class="page">AWS SNS</a></li>
  <li><a href="sqs.html" class="page">AWS SQS</a></li>
  <li><a href="external/azure-event-hubs.html" class="page">Azure Event Hubs</a></li>
  <li><a href="external/azure-iot-hub.html" class="page">Azure IoT Hub</a></li>
  <li><a href="azure-storage-queue.html" class="page">Azure Storage Queue</a></li>
  <li><a href="couchbase.html" class="page">Couchbase</a></li>
  <li><a href="elasticsearch.html" class="page">Elasticsearch</a></li>
  <li><a href="external/eventuate.html" class="page">Eventuate</a></li>
  <li><a href="file.html#file" class="active page">File</a>
  <ul>
    <li><a href="file.html#artifacts" class="header">Artifacts</a></li>
    <li><a href="file.html#writing-to-and-reading-from-files" class="header">Writing to and reading from files</a></li>
    <li><a href="file.html#tailing-a-file-into-a-stream" class="header">Tailing a file into a stream</a></li>
    <li><a href="file.html#creating-directories" class="header">Creating directories</a></li>
    <li><a href="file.html#listing-directory-contents" class="header">Listing directory contents</a></li>
    <li><a href="file.html#listening-to-changes-in-a-directory" class="header">Listening to changes in a directory</a></li>
    <li><a href="file.html#rotating-the-file-to-stream-into" class="header">Rotating the file to stream into</a></li>
    <li><a href="file.html#zip-archive" class="header">ZIP Archive</a></li>
    <li><a href="file.html#tar-archive" class="header">TAR Archive</a></li>
  </ul></li>
  <li><a href="external/fs2.html" class="page">FS2</a></li>
  <li><a href="ftp.html" class="page">FTP</a></li>
  <li><a href="google-cloud-pub-sub.html" class="page">Google Cloud Pub/Sub</a></li>
  <li><a href="google-cloud-pub-sub-grpc.html" class="page">Google Cloud Pub/Sub gRPC</a></li>
  <li><a href="google-cloud-storage.html" class="page">Google Cloud Storage</a></li>
  <li><a href="google-fcm.html" class="page">Google FCM</a></li>
  <li><a href="external/grpc.html" class="page">gRPC</a></li>
  <li><a href="hdfs.html" class="page">Hadoop Distributed File System - HDFS</a></li>
  <li><a href="hbase.html" class="page">HBase</a></li>
  <li><a href="external/http.html" class="page">HTTP</a></li>
  <li><a href="bluemix-cos.html" class="page">IBM Bluemix Cloud Object Storage</a></li>
  <li><a href="external/db2-event-store.html" class="page">IBM Db2 Event Store</a></li>
  <li><a href="influxdb.html" class="page">InfluxDB</a></li>
  <li><a href="ironmq.html" class="page">IronMQ</a></li>
  <li><a href="jms/index.html" class="page">JMS</a></li>
  <li><a href="external/mapr.html" class="page">MapR Database</a></li>
  <li><a href="mongodb.html" class="page">MongoDB</a></li>
  <li><a href="mqtt.html" class="page">MQTT</a></li>
  <li><a href="mqtt-streaming.html" class="page">MQTT Streaming</a></li>
  <li><a href="orientdb.html" class="page">OrientDB</a></li>
  <li><a href="external/pulsar.html" class="page">Pulsar</a></li>
  <li><a href="pravega.html" class="page">Pravega</a></li>
  <li><a href="sse.html" class="page">Server-sent Events (SSE)</a></li>
  <li><a href="slick.html" class="page">Slick (JDBC)</a></li>
  <li><a href="spring-web.html" class="page">Spring Web</a></li>
  <li><a href="external/tcp.html" class="page">TCP</a></li>
  <li><a href="udp.html" class="page">UDP</a></li>
  <li><a href="unix-domain-socket.html" class="page">Unix Domain Socket</a></li>
</ul>
</div>
</nav>
<footer class="nav-footer sticky-sidebar-footer">
<a href="https://akka.io"><img class="logo" src="images/akka-alpakka-reverse.svg"/></a>

</footer>
</aside>
<main class="fixed-shift-for-large expanded row">
<section class="site-content small-12 column">
<article class="page-content row">
<div class="small-12 column" id="docs">
<h1><a href="#file" name="file" class="anchor"><span class="anchor-link"></span></a>File</h1>
<p>The File connectors provide additional connectors for filesystems complementing the sources and sinks for files already included in core Akka Streams (which can be found in ).</p>
<table class="project-info">
<tr><th colspan="2">Project Info: Alpakka File</th></tr>
  <tr><th>Artifact</th><td><div>com.lightbend.akka</div>
  <div>akka-stream-alpakka-file</div>
  <div>2.0.0-RC2</div>
  <div><a href="other-docs/snapshots.html">Snapshots are available</a></div>
  </td></tr>
  <tr><th>JDK versions</th><td><div>Adopt OpenJDK 8</div><div>Adopt OpenJDK 11</div></td></tr>
  <tr><th>Scala versions</th><td>2.12.10, 2.11.12, 2.13.1</td></tr>
  <tr><th>JPMS module name</th><td>akka.stream.alpakka.file</td></tr>
  <tr><th>License</th><td><div><a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="noopener noreferrer">Apache-2.0</a></div>
  </td></tr>
  <tr><th>Readiness level</th><td><div class="readiness-level"><a href="https://developer.lightbend.com/docs/lightbend-platform/introduction/getting-help/support-terminology.html#community-driven" target="_blank" rel="noopener">Community-driven</a></div>
  <div>Since 0.1, 2016-11-16</div>
  </td></tr>
  <tr><th>Home page</th><td><a href="https://doc.akka.io/docs/alpakka/current">https://doc.akka.io/docs/alpakka/current</a></td></tr>
  <tr><th>API documentation</th><td>
  <div><a href="https://doc.akka.io/api/alpakka/2.0.0-RC2/akka/stream/alpakka/file/index.html" target="_blank" rel="noopener noreferrer">API (Scaladoc)</a></div>
  </td></tr>
  <tr><th>Forums</th><td>
  <div><a href="https://discuss.lightbend.com/c/akka/" target="_blank" rel="noopener noreferrer">Lightbend Discuss</a></div>
  <div><a href="https://gitter.im/akka/akka" target="_blank" rel="noopener noreferrer">akka/akka Gitter channel</a></div>
  </td></tr>
  <tr><th>Release notes</th><td><a href="https://doc.akka.io/docs/alpakka/current/release-notes/index.html">In the documentation</a></td></tr>
  <tr><th>Issues</th><td><a href="https://github.com/akka/alpakka/labels/p%3Afile" target="_blank" rel="noopener noreferrer">Github issues</a></td></tr>
  <tr><th>Sources</th><td><a href="https://github.com/akka/alpakka" target="_blank" rel="noopener noreferrer">https://github.com/akka/alpakka</a></td></tr>
</table>

<h2><a href="#artifacts" name="artifacts" class="anchor"><span class="anchor-link"></span></a>Artifacts</h2>
<dl class="dependency"><dt>sbt</dt><dd><pre class="prettyprint"><code class="language-scala">val AkkaVersion = "2.5.31"
libraryDependencies ++= Seq(
  "com.lightbend.akka" %% "akka-stream-alpakka-file" % "2.0.0-RC2",
  "com.typesafe.akka" %% "akka-stream" % AkkaVersion
)</code></pre></dd><dt>Maven</dt><dd><pre class="prettyprint"><code class="language-xml">&lt;properties&gt;
  &lt;akka.version&gt;2.5.31&lt;/akka.version&gt;
&lt;/properties&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.lightbend.akka&lt;/groupId&gt;
  &lt;artifactId&gt;akka-stream-alpakka-file_2.12&lt;/artifactId&gt;
  &lt;version&gt;2.0.0-RC2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.typesafe.akka&lt;/groupId&gt;
  &lt;artifactId&gt;akka-stream_2.12&lt;/artifactId&gt;
  &lt;version&gt;${akka.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre></dd><dt>Gradle</dt><dd><pre class="prettyprint"><code class="language-gradle">versions += [
  AkkaVersion: "2.5.31"
]
dependencies {
  compile group: 'com.lightbend.akka', name: 'akka-stream-alpakka-file_2.12', version: '2.0.0-RC2',
  compile group: 'com.typesafe.akka', name: 'akka-stream_2.12', version: versions.AkkaVersion
}</code></pre></dd></dl>
<p>The table below shows direct dependencies of this module and the second tab shows all libraries it depends on transitively.</p>
<dl class="dependencies"><dt>Direct dependencies</dt><dd><table>
  <thead><tr><th>Organization</th><th>Artifact</th><th>Version</th></thead>
  <tbody>
    <tr><td>com.typesafe.akka</td><td>akka-stream_2.12</td><td><a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream_2.12/2.5.31" target="_blank">2.5.31</a></td></tr>
    <tr><td>org.scala-lang</td><td>scala-library</td><td><a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.10" target="_blank">2.12.10</a></td></tr>
  </tbody>
</table></dd>
<dt>Dependency tree</dt><dd><pre>
com.typesafe.akka    akka-stream_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream_2.12/2.5.31" target="_blank">2.5.31</a>
    com.typesafe.akka    akka-actor_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.12/2.5.31" target="_blank">2.5.31</a>
        com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.3.3" target="_blank">1.3.3</a>
        org.scala-lang.modules    scala-java8-compat_2.12    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.12/0.8.0" target="_blank">0.8.0</a>
    com.typesafe.akka    akka-protobuf_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-protobuf_2.12/2.5.31" target="_blank">2.5.31</a>
    com.typesafe    ssl-config-core_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe/ssl-config-core_2.12/0.3.8" target="_blank">0.3.8</a>
        com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.3.3" target="_blank">1.3.3</a>
        org.scala-lang.modules    scala-parser-combinators_2.12    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-parser-combinators_2.12/1.1.2" target="_blank">1.1.2</a>
    org.reactivestreams    reactive-streams    <a href="https://mvnrepository.com/artifact/org.reactivestreams/reactive-streams/1.0.2" target="_blank">1.0.2</a>
org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.10" target="_blank">2.12.10</a></pre></dd>
</dl>

<h2><a href="#writing-to-and-reading-from-files" name="writing-to-and-reading-from-files" class="anchor"><span class="anchor-link"></span></a>Writing to and reading from files</h2>

<p>Use the <code>FileIO</code> class to create streams reading from or writing to files. It is part part of Akka streams. </p>

<p><a href="https://doc.akka.io/docs/akka/current/stream/stream-io.html#streaming-file-io">Akka Streaming File IO documentation</a></p>

<h2><a href="#tailing-a-file-into-a-stream" name="tailing-a-file-into-a-stream" class="anchor"><span class="anchor-link"></span></a>Tailing a file into a stream</h2>

<p>The <code>FileTailSource</code> starts at a given offset in a file and emits chunks of bytes until reaching the end of the file, it will then poll the file for changes and emit new changes as they are written  to the file (unless there is backpressure).</p>

<p>A very common use case is combining reading bytes with parsing the bytes into lines, therefore <code>FileTailSource</code> contains a few factory methods to create a source that parses the bytes into lines and emits those.</p>

<p>In this sample we simply tail the lines of a file and print them to standard out:</p>

<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/scala/docs/scaladsl/FileTailSourceSpec.scala#L26-L35" target="_blank" title="Go to snippet source"></a><code class="language-scala">import akka.stream.alpakka.file.scaladsl.FileTailSource

val fs = FileSystems.getDefault
val lines: Source[String, NotUsed] = FileTailSource.lines(
  path = fs.getPath(path),
  maxLineSize = 8192,
  pollingInterval = 250.millis
)

lines.runForeach(line =&gt; System.out.println(line))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/java/docs/javadsl/FileTailSourceTest.java#L224-L232" target="_blank" title="Go to snippet source"></a><code class="language-java">final FileSystem fs = FileSystems.getDefault();
final Duration pollingInterval = Duration.ofMillis(250);
final int maxLineSize = 8192;

final Source&lt;String, NotUsed&gt; lines =
    akka.stream.alpakka.file.javadsl.FileTailSource.createLines(
        fs.getPath(path), maxLineSize, pollingInterval);

lines.runForeach((line) -&gt; System.out.println(line), materializer);</code></pre></dd>
</dl>
<h3><a href="#shutdown-stream-when-file-is-deleted" name="shutdown-stream-when-file-is-deleted" class="anchor"><span class="anchor-link"></span></a>Shutdown stream when file is deleted</h3>
<p>The <code>FileTailSource</code> stream will not shutdown or throw an error when the file it is tailing is deleted from the filesystem. If you would like to shutdown the stream, or throw an error, you can do so by merging in a <span class="group-java"><a href="/api/alpakka/2.0.0-RC2/akka/stream/alpakka/file/javadsl/DirectoryChangesSource$.html" title="akka.stream.alpakka.file.javadsl.DirectoryChangesSource"><code>DirectoryChangesSource</code></a></span><span class="group-scala"><a href="/api/alpakka/2.0.0-RC2/akka/stream/alpakka/file/scaladsl/DirectoryChangesSource$.html" title="akka.stream.alpakka.file.scaladsl.DirectoryChangesSource"><code>DirectoryChangesSource</code></a></span> that listens to filesystem events in the directory that contains the file.</p>
<p>In the following example, a <code>DirectoryChangesSource</code> is used to watch for events in a directory. If a file delete event is observed for the file we are tailing then we shutdown the stream gracefully by using a <span class="group-java"><a href="https://doc.akka.io/japi/akka/2.5/?akka/stream/javadsl/Flow.html" title="akka.stream.javadsl.Flow"><code>Flow.recoverWithRetries</code></a></span><span class="group-scala"><a href="https://doc.akka.io/api/akka/2.5/akka/stream/scaladsl/Flow$.html" title="akka.stream.scaladsl.Flow"><code>Flow.recoverWithRetries</code></a></span> to switch to a <span class="group-java"><a href="https://doc.akka.io/japi/akka/2.5/?akka/stream/javadsl/Source.html" title="akka.stream.javadsl.Source"><code>Source.empty</code></a></span><span class="group-scala"><a href="https://doc.akka.io/api/akka/2.5/akka/stream/scaladsl/Source$.html" title="akka.stream.scaladsl.Source"><code>Source.empty</code></a></span>, which with immediately send an <code>OnComplete</code> signal and shutdown the stream.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/scala/docs/scaladsl/FileTailSourceExtrasSpec.scala#L46-L60" target="_blank" title="Go to snippet source"></a><code class="language-scala"><br/>val checkInterval = 1.second
val fileCheckSource = DirectoryChangesSource(path.getParent, checkInterval, 8192)
  .collect {
    case (p, DirectoryChange.Deletion) if path == p =&gt;
      throw new FileNotFoundException(path.toString)
  }
  .recoverWithRetries(1, {
    case _: FileNotFoundException =&gt; Source.empty
  })

val stream = FileTailSource
  .lines(path = path, maxLineSize = 8192, pollingInterval = 250.millis)
  .merge(fileCheckSource, eagerComplete = true)
</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/java/docs/javadsl/FileTailSourceTest.java#L139-L162" target="_blank" title="Go to snippet source"></a><code class="language-java"><br/>final Duration checkInterval = Duration.ofSeconds(1);
final Source&lt;String, NotUsed&gt; fileCheckSource =
    akka.stream.alpakka.file.javadsl.DirectoryChangesSource.create(
            path.getParent(), checkInterval, 8192)
        .mapConcat(
            pair -&gt; {
              if (pair.first().equals(path) &amp;&amp; pair.second() == DirectoryChange.Deletion) {
                throw new FileNotFoundException();
              }
              return Collections.&lt;String&gt;emptyList();
            })
        .recoverWith(
            new PFBuilder&lt;Throwable, Source&lt;String, NotUsed&gt;&gt;()
                .match(FileNotFoundException.class, t -&gt; Source.empty())
                .build());

final Source&lt;String, NotUsed&gt; source =
    akka.stream.alpakka.file.javadsl.FileTailSource.createLines(
            path,
            8192, // chunk size
            Duration.ofMillis(250))
        .merge(fileCheckSource, true);
</code></pre></dd>
</dl><div class="callout note "><div class="callout-title">Stream Shutdown Race Condition</div>
<p>Since the <code>DirectoryChangesSource</code> and the <code>FileTailSource</code> operate asynchronously as separate sources there is the possibility that the stream could be shutdown prematurely. If the file is detected as deleted and the stream is shutdown before the last element is emitted from <code>FileTailSource</code>, then that data will never be available to downstream user stages.</p></div>
<h3><a href="#shutdown-stream-after-an-idle-timeout" name="shutdown-stream-after-an-idle-timeout" class="anchor"><span class="anchor-link"></span></a>Shutdown stream after an idle timeout</h3>
<p>It may be useful to shutdown the stream when no new data has been added for awhile to a file being tailed by <code>FileTailSource</code>. In the following example, a <span class="group-java"><a href="https://doc.akka.io/japi/akka/2.5/?akka/stream/javadsl/Flow.html" title="akka.stream.javadsl.Flow"><code>Flow.idleTimeout</code></a></span><span class="group-scala"><a href="https://doc.akka.io/api/akka/2.5/akka/stream/scaladsl/Flow$.html" title="akka.stream.scaladsl.Flow"><code>Flow.idleTimeout</code></a></span> operator is used to trigger a <code>TimeoutException</code> that can be recovered with <span class="group-java"><a href="https://doc.akka.io/japi/akka/2.5/?akka/stream/javadsl/Flow.html" title="akka.stream.javadsl.Flow"><code>Flow.recoverWithRetries</code></a></span><span class="group-scala"><a href="https://doc.akka.io/api/akka/2.5/akka/stream/scaladsl/Flow$.html" title="akka.stream.scaladsl.Flow"><code>Flow.recoverWithRetries</code></a></span> and a <span class="group-java"><a href="https://doc.akka.io/japi/akka/2.5/?akka/stream/javadsl/Source.html" title="akka.stream.javadsl.Source"><code>Source.empty</code></a></span><span class="group-scala"><a href="https://doc.akka.io/api/akka/2.5/akka/stream/scaladsl/Source$.html" title="akka.stream.scaladsl.Source"><code>Source.empty</code></a></span> to successfully shutdown the stream.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/scala/docs/scaladsl/FileTailSourceExtrasSpec.scala#L79-L86" target="_blank" title="Go to snippet source"></a><code class="language-scala"><br/>val stream = FileTailSource
  .lines(path = path, maxLineSize = 8192, pollingInterval = 250.millis)
  .idleTimeout(5.seconds)
  .recoverWithRetries(1, {
    case _: TimeoutException =&gt; Source.empty
  })
</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/java/docs/javadsl/FileTailSourceTest.java#L184-L195" target="_blank" title="Go to snippet source"></a><code class="language-java"><br/>Source&lt;String, NotUsed&gt; stream =
    akka.stream.alpakka.file.javadsl.FileTailSource.createLines(
            path,
            8192, // chunk size
            Duration.ofMillis(250))
        .idleTimeout(Duration.ofSeconds(5))
        .recoverWith(
            new PFBuilder&lt;Throwable, Source&lt;String, NotUsed&gt;&gt;()
                .match(TimeoutException.class, t -&gt; Source.empty())
                .build());
</code></pre></dd>
</dl>
<h2><a href="#creating-directories" name="creating-directories" class="anchor"><span class="anchor-link"></span></a>Creating directories</h2>
<p><code>Directory.mkdirs()</code> and <code>Directory.mkdirsWithContext()</code> create directories for <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/nio/file/Path.html" title="java.nio.file.Path"><code>Path</code></a> elements in the stream. The <code>withContext</code>-variant allows the user to pass through additional information with every path.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/scala/docs/scaladsl/DirectorySpec.scala#L88-L111" target="_blank" title="Go to snippet source"></a><code class="language-scala">import akka.stream.alpakka.file.scaladsl.Directory

val flow: Flow[Path, Path, NotUsed] = Directory.mkdirs()

val created: Future[immutable.Seq[Path]] =
  Source(immutable.Seq(dir.resolve(&quot;dirA&quot;), dir.resolve(&quot;dirB&quot;)))
    .via(flow)
    .runWith(Sink.seq)

val flowWithContext: FlowWithContext[Path, SomeContext, Path, SomeContext, NotUsed] =
  Directory.mkdirsWithContext[SomeContext]()</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/java/docs/javadsl/DirectoryTest.java#L135-L156" target="_blank" title="Go to snippet source"></a><code class="language-java">Flow&lt;Path, Path, NotUsed&gt; flow = Directory.mkdirs();

CompletionStage&lt;List&lt;Path&gt;&gt; created =
    Source.from(Arrays.asList(dir.resolve(&quot;dirA&quot;), dir.resolve(&quot;dirB&quot;)))
        .via(flow)
        .runWith(Sink.seq(), materializer);

FlowWithContext&lt;Path, SomeContext, Path, SomeContext, NotUsed&gt; flowWithContext =
    Directory.mkdirsWithContext();</code></pre></dd>
</dl>
<h2><a href="#listing-directory-contents" name="listing-directory-contents" class="anchor"><span class="anchor-link"></span></a>Listing directory contents</h2>
<p><code>Directory.ls(path)</code> lists all files and directories directly in a given directory:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/scala/docs/scaladsl/DirectorySpec.scala#L46-L48" target="_blank" title="Go to snippet source"></a><code class="language-scala">import akka.stream.alpakka.file.scaladsl.Directory

val source: Source[Path, NotUsed] = Directory.ls(dir)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/java/docs/javadsl/DirectoryTest.java#L14-L73" target="_blank" title="Go to snippet source"></a><code class="language-java">import akka.stream.alpakka.file.javadsl.Directory;

final Source&lt;Path, NotUsed&gt; source = Directory.ls(dir);</code></pre></dd>
</dl>
<p><code>Directory.walk(path)</code> traverses all subdirectories and lists files and directories depth first:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/scala/docs/scaladsl/DirectorySpec.scala#L68-L73" target="_blank" title="Go to snippet source"></a><code class="language-scala">import akka.stream.alpakka.file.scaladsl.Directory
import java.nio.file.FileVisitOption

val files: Source[Path, NotUsed] = Directory.walk(root)

val files2: Source[Path, NotUsed] = Directory.walk(root, maxDepth = Some(1), List(FileVisitOption.FOLLOW_LINKS))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/java/docs/javadsl/DirectoryTest.java#L14-L121" target="_blank" title="Go to snippet source"></a><code class="language-java">import akka.stream.alpakka.file.javadsl.Directory;
import java.nio.file.FileVisitOption;

final Source&lt;Path, NotUsed&gt; source = Directory.walk(root);

final Source&lt;Path, NotUsed&gt; source = Directory.walk(root, 1, FileVisitOption.FOLLOW_LINKS);</code></pre></dd>
</dl>
<h2><a href="#listening-to-changes-in-a-directory" name="listening-to-changes-in-a-directory" class="anchor"><span class="anchor-link"></span></a>Listening to changes in a directory</h2>
<p>The <code>DirectoryChangesSource</code> will emit elements every time there is a change to a watched directory in the local filesystem, the emitted change concists of the path that was changed and an enumeration describing what kind of change it was.</p>
<p>In this sample we simply print each change to the directory to standard output:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/scala/docs/scaladsl/DirectoryChangesSourceSpec.scala#L22-L28" target="_blank" title="Go to snippet source"></a><code class="language-scala">import akka.stream.alpakka.file.scaladsl.DirectoryChangesSource

val fs = FileSystems.getDefault
val changes = DirectoryChangesSource(fs.getPath(path), pollInterval = 1.second, maxBufferSize = 1000)
changes.runForeach {
  case (path, change) =&gt; println(&quot;Path: &quot; + path + &quot;, Change: &quot; + change)
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/java/docs/javadsl/DirectoryChangesSourceTest.java#L14-L168" target="_blank" title="Go to snippet source"></a><code class="language-java">import akka.stream.alpakka.file.javadsl.DirectoryChangesSource;

final FileSystem fs = FileSystems.getDefault();
final Duration pollingInterval = Duration.ofSeconds(1);
final int maxBufferSize = 1000;
final Source&lt;Pair&lt;Path, DirectoryChange&gt;, NotUsed&gt; changes =
    DirectoryChangesSource.create(fs.getPath(path), pollingInterval, maxBufferSize);

changes.runForeach(
    (Pair&lt;Path, DirectoryChange&gt; pair) -&gt; {
      final Path changedPath = pair.first();
      final DirectoryChange change = pair.second();
      System.out.println(&quot;Path: &quot; + changedPath + &quot;, Change: &quot; + change);
    },
    materializer);</code></pre></dd>
</dl>
<h2><a href="#rotating-the-file-to-stream-into" name="rotating-the-file-to-stream-into" class="anchor"><span class="anchor-link"></span></a>Rotating the file to stream into</h2>
<p>The <span class="group-java"><a href="/api/alpakka/2.0.0-RC2/akka/stream/alpakka/file/javadsl/LogRotatorSink$.html" title="akka.stream.alpakka.file.javadsl.LogRotatorSink"><code>LogRotatorSink</code></a></span><span class="group-scala"><a href="/api/alpakka/2.0.0-RC2/akka/stream/alpakka/file/scaladsl/LogRotatorSink$.html" title="akka.stream.alpakka.file.scaladsl.LogRotatorSink"><code>LogRotatorSink</code></a></span> will create and  write to multiple files.<br/>This sink takes a creator as parameter which returns a  <span class="group-scala"><code>Bytestring =&gt; Option[Path]</code> function</span><span class="group-java"><code>Function&lt;ByteString, Optional&lt;Path&gt;&gt;</code></span>. If the generated function returns a path  the sink will rotate the file output to this new path and the actual <code>ByteString</code> will be  written to this new file too.  With this approach the user can define a custom stateful file generation implementation.</p>
<p>This example usage shows the built-in target file creation and a custom sink factory which is required to use <span class="group-java"><a href="https://doc.akka.io/japi/akka/2.5/?akka/stream/javadsl/Compression.html" title="akka.stream.javadsl.Compression"><code>Compression</code></a></span><span class="group-scala"><a href="https://doc.akka.io/api/akka/2.5/akka/stream/scaladsl/Compression$.html" title="akka.stream.scaladsl.Compression"><code>Compression</code></a></span> for the target files.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/scala/docs/scaladsl/LogRotatorSinkSpec.scala#L157-L224" target="_blank" title="Go to snippet source"></a><code class="language-scala">val triggerFunctionCreator: () =&gt; ByteString =&gt; Option[Path] = ???

val completion = Source(immutable.Seq(&quot;test1&quot;, &quot;test2&quot;, &quot;test3&quot;, &quot;test4&quot;, &quot;test5&quot;, &quot;test6&quot;))
  .map(ByteString(_))
  .runWith(LogRotatorSink(triggerFunctionCreator))

// GZip compressing the data written
val completion =
  source
    .runWith(
      LogRotatorSink.withSinkFactory(
        triggerFunctionCreator,
        (path: Path) =&gt;
          Flow[ByteString]
            .via(Compression.gzip)
            .toMat(FileIO.toPath(path))(Keep.right)
      )
    )</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/java/docs/javadsl/LogRotatorSinkTest.java#L122-L148" target="_blank" title="Go to snippet source"></a><code class="language-java">import akka.stream.alpakka.file.javadsl.LogRotatorSink;

Creator&lt;Function&lt;ByteString, Optional&lt;Path&gt;&gt;&gt; triggerFunctionCreator = ...;

CompletionStage&lt;Done&gt; completion =
    Source.from(Arrays.asList(&quot;test1&quot;, &quot;test2&quot;, &quot;test3&quot;, &quot;test4&quot;, &quot;test5&quot;, &quot;test6&quot;))
        .map(ByteString::fromString)
        .runWith(LogRotatorSink.createFromFunction(triggerFunctionCreator), materializer);

// GZip compressing the data written
CompletionStage&lt;Done&gt; compressedCompletion =
    source.runWith(
        LogRotatorSink.withSinkFactory(
            triggerFunctionCreator,
            path -&gt;
                Flow.of(ByteString.class)
                    .via(Compression.gzip())
                    .toMat(FileIO.toPath(path), Keep.right())),
        materializer);</code></pre></dd>
</dl>
<h3><a href="#example-size-based-rotation" name="example-size-based-rotation" class="anchor"><span class="anchor-link"></span></a>Example: size-based rotation</h3>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/scala/docs/scaladsl/LogRotatorSinkSpec.scala#L102-L119" target="_blank" title="Go to snippet source"></a><code class="language-scala">import akka.stream.alpakka.file.scaladsl.LogRotatorSink

val fileSizeTriggerCreator: () =&gt; ByteString =&gt; Option[Path] = () =&gt; {
  val max = 10 * 1024 * 1024
  var size: Long = max
  element: ByteString =&gt;
    if (size + element.size &gt; max) {
      val path = Files.createTempFile(&quot;out-&quot;, &quot;.log&quot;)
      size = element.size
      Some(path)
    } else {
      size += element.size
      None
    }
}

val sizeRotatorSink: Sink[ByteString, Future[Done]] =
  LogRotatorSink(fileSizeTriggerCreator)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/java/docs/javadsl/LogRotatorSinkTest.java#L60-L77" target="_blank" title="Go to snippet source"></a><code class="language-java">Creator&lt;Function&lt;ByteString, Optional&lt;Path&gt;&gt;&gt; sizeBasedTriggerCreator =
    () -&gt; {
      long max = 10 * 1024 * 1024;
      final long[] size = new long[] {max};
      return (element) -&gt; {
        if (size[0] + element.size() &gt; max) {
          Path path = Files.createTempFile(&quot;out-&quot;, &quot;.log&quot;);
          size[0] = element.size();
          return Optional.of(path);
        } else {
          size[0] += element.size();
          return Optional.empty();
        }
      };
    };

Sink&lt;ByteString, CompletionStage&lt;Done&gt;&gt; sizeRotatorSink =
    LogRotatorSink.createFromFunction(sizeBasedTriggerCreator);</code></pre></dd>
</dl>
<h3><a href="#example-time-based-rotation" name="example-time-based-rotation" class="anchor"><span class="anchor-link"></span></a>Example: time-based rotation</h3>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/scala/docs/scaladsl/LogRotatorSinkSpec.scala#L131-L148" target="_blank" title="Go to snippet source"></a><code class="language-scala">val destinationDir = FileSystems.getDefault.getPath(&quot;/tmp&quot;)
val formatter = DateTimeFormatter.ofPattern(&quot;&#39;stream-&#39;yyyy-MM-dd_HH&#39;.log&#39;&quot;)

val timeBasedTriggerCreator: () =&gt; ByteString =&gt; Option[Path] = () =&gt; {
  var currentFilename: Option[String] = None
  (_: ByteString) =&gt; {
    val newName = LocalDateTime.now().format(formatter)
    if (currentFilename.contains(newName)) {
      None
    } else {
      currentFilename = Some(newName)
      Some(destinationDir.resolve(newName))
    }
  }
}

val timeBasedSink: Sink[ByteString, Future[Done]] =
  LogRotatorSink(timeBasedTriggerCreator)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/java/docs/javadsl/LogRotatorSinkTest.java#L91-L109" target="_blank" title="Go to snippet source"></a><code class="language-java">final Path destinationDir = FileSystems.getDefault().getPath(&quot;/tmp&quot;);
final DateTimeFormatter formatter = DateTimeFormatter.ofPattern(&quot;&#39;stream-&#39;yyyy-MM-dd_HH&#39;.log&#39;&quot;);

Creator&lt;Function&lt;ByteString, Optional&lt;Path&gt;&gt;&gt; timeBasedTriggerCreator =
    () -&gt; {
      final String[] currentFileName = new String[] {null};
      return (element) -&gt; {
        String newName = LocalDateTime.now().format(formatter);
        if (newName.equals(currentFileName[0])) {
          return Optional.empty();
        } else {
          currentFileName[0] = newName;
          return Optional.of(destinationDir.resolve(newName));
        }
      };
    };

Sink&lt;ByteString, CompletionStage&lt;Done&gt;&gt; timeBasedSink =
    LogRotatorSink.createFromFunction(timeBasedTriggerCreator);</code></pre></dd>
</dl>
<h3><a href="#example-content-based-rotation-with-compression-to-sftp-file" name="example-content-based-rotation-with-compression-to-sftp-file" class="anchor"><span class="anchor-link"></span></a>Example: content-based rotation with compression to SFTP file</h3>
<p>This example can be found in the <a href="examples/ftp-samples.html#example-rotate-data-stream-over-to-multiple-compressed-files-on-sftp-server">self-contained example documentation section</a>.</p>
<h2><a href="#zip-archive" name="zip-archive" class="anchor"><span class="anchor-link"></span></a>ZIP Archive</h2>
<p>The <span class="group-java"><a href="/api/alpakka/2.0.0-RC2/akka/stream/alpakka/file/javadsl/Archive$.html" title="akka.stream.alpakka.file.javadsl.Archive"><code>Archive</code></a></span><span class="group-scala"><a href="/api/alpakka/2.0.0-RC2/akka/stream/alpakka/file/scaladsl/Archive$.html" title="akka.stream.alpakka.file.scaladsl.Archive"><code>Archive</code></a></span> contains flow for compressing multiple files into one ZIP file.</p>
<p>Result of flow can be send to sink even before whole ZIP file is created, so size of resulting ZIP archive is not limited to memory size. </p>
<p>This example usage shows compressing files from disk. </p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/scala/docs/scaladsl/ArchiveSpec.scala#L65-L81" target="_blank" title="Go to snippet source"></a><code class="language-scala">val fileStream1: Source[ByteString,  Any] = ...
val fileStream2: Source[ByteString,  Any] = ...

val filesStream = Source(
  List(
    (ArchiveMetadata(&quot;akka_full_color.svg&quot;), fileStream1),
    (ArchiveMetadata(&quot;akka_icon_reverse.svg&quot;), fileStream2)
  )
)

val result = filesStream
  .via(Archive.zip())
  .runWith(FileIO.toPath(Paths.get(&quot;result.zip&quot;)))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/java/docs/javadsl/ArchiveTest.java#L71-L88" target="_blank" title="Go to snippet source"></a><code class="language-java">Source&lt;ByteString, NotUsed&gt; source1 = ...
Source&lt;ByteString, NotUsed&gt; source2 = ...

Pair&lt;ArchiveMetadata, Source&lt;ByteString, NotUsed&gt;&gt; pair1 =
    Pair.create(ArchiveMetadata.create(&quot;akka_full_color.svg&quot;), source1);
Pair&lt;ArchiveMetadata, Source&lt;ByteString, NotUsed&gt;&gt; pair2 =
    Pair.create(ArchiveMetadata.create(&quot;akka_icon_reverse.svg&quot;), source2);

Source&lt;Pair&lt;ArchiveMetadata, Source&lt;ByteString, NotUsed&gt;&gt;, NotUsed&gt; source =
    Source.from(Arrays.asList(pair1, pair2));

Sink&lt;ByteString, CompletionStage&lt;IOResult&gt;&gt; fileSink = FileIO.toPath(Paths.get(&quot;logo.zip&quot;));
CompletionStage&lt;IOResult&gt; ioResult = source.via(Archive.zip()).runWith(fileSink, mat);
</code></pre></dd>
</dl>
<h2><a href="#tar-archive" name="tar-archive" class="anchor"><span class="anchor-link"></span></a>TAR Archive</h2>
<p>The <span class="group-java"><a href="/api/alpakka/2.0.0-RC2/akka/stream/alpakka/file/javadsl/Archive$.html" title="akka.stream.alpakka.file.javadsl.Archive"><code>Archive</code></a></span><span class="group-scala"><a href="/api/alpakka/2.0.0-RC2/akka/stream/alpakka/file/scaladsl/Archive$.html" title="akka.stream.alpakka.file.scaladsl.Archive"><code>Archive</code></a></span> contains flow for packaging multiple files into one TAR file.</p>
<p>Result of flow can be send to sink even before whole TAR file is created, so size of resulting TAR archive is not limited to memory size.</p>
<p>This example usage shows packaging files from disk.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/scala/docs/scaladsl/ArchiveSpec.scala#L146-L164" target="_blank" title="Go to snippet source"></a><code class="language-scala">val fileStream1: Source[ByteString,  Any] = ...
val fileStream2: Source[ByteString,  Any] = ...
val fileSize1: Long = ...
val fileSize2: Long = ...

val filesStream = Source(
  List(
    (TarArchiveMetadata(&quot;akka_full_color.svg&quot;, fileSize1), fileStream1),
    (TarArchiveMetadata(&quot;akka_icon_reverse.svg&quot;, fileSize2), fileStream2)
  )
)

val result = filesStream
  .via(Archive.tar())
  .runWith(FileIO.toPath(Paths.get(&quot;result.tar&quot;)))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/java/docs/javadsl/ArchiveTest.java#L125-L143" target="_blank" title="Go to snippet source"></a><code class="language-java">Source&lt;ByteString, NotUsed&gt; source1 = ...
Source&lt;ByteString, NotUsed&gt; source2 = ...
Long size1 = ...
Long size2 = ...

Pair&lt;TarArchiveMetadata, Source&lt;ByteString, NotUsed&gt;&gt; pair1 =
    Pair.create(TarArchiveMetadata.create(&quot;akka_full_color.svg&quot;, size1), source1);
Pair&lt;TarArchiveMetadata, Source&lt;ByteString, NotUsed&gt;&gt; pair2 =
    Pair.create(TarArchiveMetadata.create(&quot;akka_icon_reverse.svg&quot;, size2), source2);

Source&lt;Pair&lt;TarArchiveMetadata, Source&lt;ByteString, NotUsed&gt;&gt;, NotUsed&gt; source =
    Source.from(Arrays.asList(pair1, pair2));

Sink&lt;ByteString, CompletionStage&lt;IOResult&gt;&gt; fileSink = FileIO.toPath(Paths.get(&quot;logo.tar&quot;));
CompletionStage&lt;IOResult&gt; ioResult = source.via(Archive.tar()).runWith(fileSink, mat);</code></pre></dd>
</dl>
<p>To produce a gzipped TAR file see the following example.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/scala/docs/scaladsl/ArchiveSpec.scala#L168-L170" target="_blank" title="Go to snippet source"></a><code class="language-scala">val resultGz = filesStream
  .via(Archive.tar().via(akka.stream.scaladsl.Compression.gzip))
  .runWith(FileIO.toPath(Paths.get(&quot;result.tar.gz&quot;)))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/file/src/test/java/docs/javadsl/ArchiveTest.java#L147-L152" target="_blank" title="Go to snippet source"></a><code class="language-java">Sink&lt;ByteString, CompletionStage&lt;IOResult&gt;&gt; fileSinkGz =
    FileIO.toPath(Paths.get(&quot;logo.tar.gz&quot;));
CompletionStage&lt;IOResult&gt; ioResultGz =
    source
        .via(Archive.tar().via(akka.stream.javadsl.Compression.gzip()))
        .runWith(fileSinkGz, mat);</code></pre></dd>
</dl>
</div>
</article>
<div class="row">
<div class="small-12 column">
<section class="nav-prev-next row">
<div class="nav-prev small-6 column">
<a href="external/eventuate.html"><i class="icon-prev"></i> <span class="link-prev">Eventuate</span></a>
</div>
<div class="nav-next small-6 column clearfix">
<a class="float-right" href="external/fs2.html">FS2 <i class="icon-next"></i></a>
</div>
</section>
</div>
</div>
<div class="source-github row">
Found an error in this documentation? The source code for this page can be found <a href="https://github.com/akka/alpakka/tree/v2.0.0-RC2/docs/src/main/paradox/file.md">here</a>.
Please feel free to edit and contribute a pull request.
</div>

<footer class="page-footer row clearfix">
<img class="akka-icon float-left show-for-medium" src="images/akka-icon.svg" />
<section class="copyright">
<div>Alpakka is Open Source and available under the Apache 2 License.</div>
<p class="legal">
&copy; 2011-2020 <a href="https://www.lightbend.com" target="_blank">Lightbend, Inc.</a> |
<a href="https://www.lightbend.com/legal/licenses" target="_blank">Licenses</a> |
<a href="https://www.lightbend.com/legal/terms" target="_blank">Terms</a> |
<a href="https://www.lightbend.com/legal/privacy" target="_blank">Privacy Policy</a> |
<a href="https://akka.io/cookie/" target="_blank">Cookie Listing</a> |
<a class="optanon-toggle-display">Cookie Settings</a>
</p>
</section>

</footer>
</section>
</main>
</div>

<script type="text/javascript" src="js/scrollsneak.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="js/groups.js"></script>
<script type="text/javascript" src="js/page.js"></script>
<script type="text/javascript" src="js/magellan.js"></script>
<script type="text/javascript" src="js/metadata-toggle.js"></script>

<style type="text/css">@import "lib/prettify/prettify.css";</style>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(){window.prettyPrint && prettyPrint()});
//]]></script>
<script type="text/javascript" src="assets/js/warnOldVersion.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(jq){initOldVersionWarnings(jq, '2.0.0-RC2', 'https://doc.akka.io/docs/alpakka/current')});
//]]></script>


</body>
</html>
