<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>AWS SQS &bull; Alpakka Documentation</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="Alpakka is a Reactive Enterprise Integration library for Java and Scala, based on Reactive Streams and Akka."/>
<link rel="canonical" href="https://doc.akka.io/docs/alpakka/current/sqs.html"/>
<script type="text/javascript" src="lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="lib/foundation/dist/js/foundation.min.js"></script>
<link rel="stylesheet" type="text/css" href="lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="lib/foundation/dist/css/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<link rel="stylesheet" type="text/css" href="css/icons.css"/>
<link rel="stylesheet" type="text/css" href="css/page.css"/>
<link rel="shortcut icon" href="images/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png"/>
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png"/>
<link rel="manifest" href="images/manifest.json"/>
<meta name="msapplication-TileImage" content="images/mstile-150x150.png"/>
<meta name="msapplication-TileColor" content="#15a9ce"/>
<meta name="theme-color" content="#15a9ce"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) start -->
<script src="https://optanon.blob.core.windows.net/consent/159bb13d-6748-4399-806e-ac28db879785.js" type="text/javascript" charset="UTF-8"></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) end -->
<!--Google Analytics-->
<script type="text/plain" class="optanon-category-2">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', '']);
_gaq.push(['_setDomainName', '']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})()
</script>
<script type="text/plain" class="optanon-category-2">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-23127719-1', 'lightbend.com', {'allowLinker': true, 'name': 'tsTracker'});
ga('tsTracker.require', 'linker');
ga('tsTracker.linker:autoLink', ['lightbend.com','playframework.com','scala-lang.org','scaladays.org','spray.io','akka.io','scala-sbt.org','scala-ide.org']);
ga('tsTracker.send', 'pageview');
</script>
<!--Marketo-->
<script type="text/plain" class="optanon-category-3">
(function() {
var didInit = false;
function initMunchkin() {
if(didInit === false) {
didInit = true;
Munchkin.init('558-NCX-702', { 'asyncOnly': true, 'disableClickDelay': true });
}
}
var s = document.createElement('script');
s.type = 'text/javascript';
s.async = true;
s.src = '//munchkin.marketo.net/munchkin.js';
s.onreadystatechange = function() {
if (this.readyState == 'complete' || this.readyState == 'loaded') {
initMunchkin();
}
};
s.onload = initMunchkin;
document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
</head>

<body id="underlay" data-toggler="nav-open">

<header class="site-header hide-for-large">
<div class="sticky-header clearfix">
<a href="https://akka.io"><img class="logo" src="images/akka-alpakka-reverse.svg"/></a>

<button class="menu-icon float-right" type="button" data-toggle="underlay overlay"></button>
</div>
<div id="overlay" class="overlay-nav" data-toggler="nav-open">
<header class="nav-header">
<div class="nav-header-title">
<h1><a href="index.html">Alpakka Documentation</a></h1>
</div>
<div class="nav-header-version">
Version 1.0-M2
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
</div>
</header>
<nav class="nav-toc">
<ul>
  <li><a href="overview.html" class="page">Overview</a></li>
  <li><a href="data-transformations/index.html" class="page">Data Transformations</a></li>
  <li><a href="amqp.html" class="page">AMQP</a></li>
  <li><a href="external/apache-camel.html" class="page">Apache Camel</a></li>
  <li><a href="cassandra.html" class="page">Apache Cassandra</a></li>
  <li><a href="geode.html" class="page">Apache Geode</a></li>
  <li><a href="kafka.html" class="page">Apache Kafka</a></li>
  <li><a href="kudu.html" class="page">Apache Kudu</a></li>
  <li><a href="solr.html" class="page">Apache Solr</a></li>
  <li><a href="avroparquet.html" class="page">Avro Parquet</a></li>
  <li><a href="dynamodb.html" class="page">AWS DynamoDB</a></li>
  <li><a href="kinesis.html" class="page">AWS Kinesis</a></li>
  <li><a href="awslambda.html" class="page">AWS Lambda</a></li>
  <li><a href="s3.html" class="page">AWS S3</a></li>
  <li><a href="sns.html" class="page">AWS SNS</a></li>
  <li><a href="sqs.html#aws-sqs" class="active page">AWS SQS</a>
  <ul>
    <li><a href="sqs.html#artifacts" class="header">Artifacts</a></li>
    <li><a href="sqs.html#setup" class="header">Setup</a></li>
    <li><a href="sqs.html#read-from-an-sqs-queue" class="header">Read from an SQS queue</a></li>
    <li><a href="sqs.html#publish-messages-to-an-sqs-queue" class="header">Publish messages to an SQS queue</a></li>
    <li><a href="sqs.html#updating-message-statuses" class="header">Updating message statuses</a></li>
    <li><a href="sqs.html#integration-testing" class="header">Integration testing</a></li>
  </ul></li>
  <li><a href="external/azure-event-hubs.html" class="page">Azure Event Hubs</a></li>
  <li><a href="external/azure-iot-hub.html" class="page">Azure IoT Hub</a></li>
  <li><a href="azure-storage-queue.html" class="page">Azure Storage Queue</a></li>
  <li><a href="couchbase.html" class="page">Couchbase</a></li>
  <li><a href="elasticsearch.html" class="page">Elasticsearch</a></li>
  <li><a href="external/eventuate.html" class="page">Eventuate</a></li>
  <li><a href="file.html" class="page">Files</a></li>
  <li><a href="external/fs2.html" class="page">FS2</a></li>
  <li><a href="ftp.html" class="page">FTP</a></li>
  <li><a href="google-cloud-pub-sub.html" class="page">Google Cloud Pub/Sub</a></li>
  <li><a href="google-cloud-pub-sub-grpc.html" class="page">Google Cloud Pub/Sub gRPC</a></li>
  <li><a href="google-fcm.html" class="page">Google Firebase Cloud Messaging</a></li>
  <li><a href="external/grpc.html" class="page">gRPC</a></li>
  <li><a href="hdfs.html" class="page">Hadoop Distributed File System - HDFS</a></li>
  <li><a href="hbase.html" class="page">HBase</a></li>
  <li><a href="external/http.html" class="page">HTTP</a></li>
  <li><a href="bluemix-cos.html" class="page">IBM Bluemix Cloud Object Storage</a></li>
  <li><a href="external/db2-event-store.html" class="page">IBM Db2 Event Store</a></li>
  <li><a href="ironmq.html" class="page">IronMQ</a></li>
  <li><a href="jms/index.html" class="page">JMS</a></li>
  <li><a href="mongodb.html" class="page">MongoDB</a></li>
  <li><a href="mqtt.html" class="page">MQTT</a></li>
  <li><a href="mqtt-streaming.html" class="page">MQTT Streaming</a></li>
  <li><a href="orientdb.html" class="page">OrientDB</a></li>
  <li><a href="external/pulsar.html" class="page">Pulsar</a></li>
  <li><a href="sse.html" class="page">Server-sent Events (SSE)</a></li>
  <li><a href="slick.html" class="page">Slick (JDBC)</a></li>
  <li><a href="spring-web.html" class="page">Spring Web</a></li>
  <li><a href="external/tcp.html" class="page">TCP</a></li>
  <li><a href="udp.html" class="page">UDP</a></li>
  <li><a href="unix-domain-socket.html" class="page">Unix Domain Socket</a></li>
</ul>
</nav>
</div>
</header>

<aside class="show-for-large">
<header class="nav-header fixed-sidebar-header">
<div class="nav-header-title">
<h1><a href="index.html">Alpakka Documentation</a></h1>
</div>
<div class="nav-header-version">
Version 1.0-M2
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
</div>
</header>
<nav class="site-nav fixed-sidebar-contents">
<div class="nav-toc">
<ul>
  <li><a href="overview.html" class="page">Overview</a></li>
  <li><a href="data-transformations/index.html" class="page">Data Transformations</a></li>
  <li><a href="amqp.html" class="page">AMQP</a></li>
  <li><a href="external/apache-camel.html" class="page">Apache Camel</a></li>
  <li><a href="cassandra.html" class="page">Apache Cassandra</a></li>
  <li><a href="geode.html" class="page">Apache Geode</a></li>
  <li><a href="kafka.html" class="page">Apache Kafka</a></li>
  <li><a href="kudu.html" class="page">Apache Kudu</a></li>
  <li><a href="solr.html" class="page">Apache Solr</a></li>
  <li><a href="avroparquet.html" class="page">Avro Parquet</a></li>
  <li><a href="dynamodb.html" class="page">AWS DynamoDB</a></li>
  <li><a href="kinesis.html" class="page">AWS Kinesis</a></li>
  <li><a href="awslambda.html" class="page">AWS Lambda</a></li>
  <li><a href="s3.html" class="page">AWS S3</a></li>
  <li><a href="sns.html" class="page">AWS SNS</a></li>
  <li><a href="sqs.html#aws-sqs" class="active page">AWS SQS</a>
  <ul>
    <li><a href="sqs.html#artifacts" class="header">Artifacts</a></li>
    <li><a href="sqs.html#setup" class="header">Setup</a></li>
    <li><a href="sqs.html#read-from-an-sqs-queue" class="header">Read from an SQS queue</a></li>
    <li><a href="sqs.html#publish-messages-to-an-sqs-queue" class="header">Publish messages to an SQS queue</a></li>
    <li><a href="sqs.html#updating-message-statuses" class="header">Updating message statuses</a></li>
    <li><a href="sqs.html#integration-testing" class="header">Integration testing</a></li>
  </ul></li>
  <li><a href="external/azure-event-hubs.html" class="page">Azure Event Hubs</a></li>
  <li><a href="external/azure-iot-hub.html" class="page">Azure IoT Hub</a></li>
  <li><a href="azure-storage-queue.html" class="page">Azure Storage Queue</a></li>
  <li><a href="couchbase.html" class="page">Couchbase</a></li>
  <li><a href="elasticsearch.html" class="page">Elasticsearch</a></li>
  <li><a href="external/eventuate.html" class="page">Eventuate</a></li>
  <li><a href="file.html" class="page">Files</a></li>
  <li><a href="external/fs2.html" class="page">FS2</a></li>
  <li><a href="ftp.html" class="page">FTP</a></li>
  <li><a href="google-cloud-pub-sub.html" class="page">Google Cloud Pub/Sub</a></li>
  <li><a href="google-cloud-pub-sub-grpc.html" class="page">Google Cloud Pub/Sub gRPC</a></li>
  <li><a href="google-fcm.html" class="page">Google Firebase Cloud Messaging</a></li>
  <li><a href="external/grpc.html" class="page">gRPC</a></li>
  <li><a href="hdfs.html" class="page">Hadoop Distributed File System - HDFS</a></li>
  <li><a href="hbase.html" class="page">HBase</a></li>
  <li><a href="external/http.html" class="page">HTTP</a></li>
  <li><a href="bluemix-cos.html" class="page">IBM Bluemix Cloud Object Storage</a></li>
  <li><a href="external/db2-event-store.html" class="page">IBM Db2 Event Store</a></li>
  <li><a href="ironmq.html" class="page">IronMQ</a></li>
  <li><a href="jms/index.html" class="page">JMS</a></li>
  <li><a href="mongodb.html" class="page">MongoDB</a></li>
  <li><a href="mqtt.html" class="page">MQTT</a></li>
  <li><a href="mqtt-streaming.html" class="page">MQTT Streaming</a></li>
  <li><a href="orientdb.html" class="page">OrientDB</a></li>
  <li><a href="external/pulsar.html" class="page">Pulsar</a></li>
  <li><a href="sse.html" class="page">Server-sent Events (SSE)</a></li>
  <li><a href="slick.html" class="page">Slick (JDBC)</a></li>
  <li><a href="spring-web.html" class="page">Spring Web</a></li>
  <li><a href="external/tcp.html" class="page">TCP</a></li>
  <li><a href="udp.html" class="page">UDP</a></li>
  <li><a href="unix-domain-socket.html" class="page">Unix Domain Socket</a></li>
</ul>
</div>
</nav>
<footer class="nav-footer fixed-sidebar-footer">
<a href="https://akka.io"><img class="logo" src="images/akka-alpakka-reverse.svg"/></a>

</footer>
</aside>

<main class="fixed-shift-for-large expanded row">
<section class="site-content small-12 column">

<article class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#aws-sqs" name="aws-sqs" class="anchor"><span class="anchor-link"></span></a>AWS SQS</h1><div class="callout note "><div class="callout-title">Amazon Simple Queue Service</div>
<p>Amazon Simple Queue Service (Amazon SQS) offers a secure, durable, and available hosted queue that lets you integrate and decouple distributed software systems and components. Amazon SQS offers common constructs such as dead-letter queues and cost allocation tags. It provides a generic web services API and it can be accessed by any programming language that the AWS SDK supports. </p>
<p>For more information about AWS SQS please visit the <a href="https://aws.amazon.com/documentation/sqs/">official documentation</a>.</p></div>
<p>The AWS SQS connector provides Akka Stream sources and sinks for AWS SQS queues.</p>
<table class="project-info">
<tr><th colspan="2">Project Info: Alpakka AWS SQS</th></tr>
  <tr><th>Artifact</th><td><div>com.lightbend.akka</div>
  <div>akka-stream-alpakka-sqs</div>
  <div>1.0-M2</div>
  <div><a href="other-docs/snapshots.html">Snapshots are available</a></div>
  </td></tr>
  <tr><th>JDK versions</th><td><div>OpenJDK 8</div></td></tr>
  <tr><th>Scala versions</th><td>2.12.7, 2.11.12</td></tr>
  <tr><th>JPMS module name</th><td>akka.stream.alpakka.aws.sqs</td></tr>
  <tr><th>License</th><td><div><a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="noopener noreferrer">Apache-2.0</a></div>
  </td></tr>
  <tr><th>Readiness level</th><td><div class="readiness-level"><a href="https://developer.lightbend.com/docs/reactive-platform/2.0/support-terminology/index.html#community-driven" target="_blank" rel="noopener noreferrer">Community-driven</a></div>
  <div>Since 0.3, 2016-12-02</div>
  </td></tr>
  <tr><th>Home page</th><td><a href="https://doc.akka.io/docs/alpakka/current/">https://doc.akka.io/docs/alpakka/current/</a></td></tr>
  <tr><th>API documentation</th><td>
  <div><a href="https://doc.akka.io/api/alpakka/current/akka/stream/alpakka/sqs/index.html" target="_blank" rel="noopener noreferrer">API (Scaladoc)</a></div>
  </td></tr>
  <tr><th>Forums</th><td>
  <div><a href="https://discuss.lightbend.com/c/akka/" target="_blank" rel="noopener noreferrer">Lightbend Discuss</a></div>
  <div><a href="https://gitter.im/akka/akka" target="_blank" rel="noopener noreferrer">akka/akka Gitter channel</a></div>
  </td></tr>
  <tr><th>Release notes</th><td><a href="https://doc.akka.io/docs/alpakka/current/release-notes/index.html">In the documentation</a></td></tr>
  <tr><th>Issues</th><td><a href="https://github.com/akka/alpakka/labels/p%3Aaws-sqs" target="_blank" rel="noopener noreferrer">Github issues</a></td></tr>
  <tr><th>Sources</th><td><a href="https://github.com/akka/alpakka" target="_blank" rel="noopener noreferrer">https://github.com/akka/alpakka</a></td></tr>
</table>

<h2><a href="#artifacts" name="artifacts" class="anchor"><span class="anchor-link"></span></a>Artifacts</h2>
<dl class="dependency"><dt>sbt</dt><dd><pre class="prettyprint"><code class="language-scala">libraryDependencies += "com.lightbend.akka" %% "akka-stream-alpakka-sqs" % "1.0-M2"</code></pre></dd><dt>Maven</dt><dd><pre class="prettyprint"><code class="language-xml">&lt;dependency&gt;
  &lt;groupId&gt;com.lightbend.akka&lt;/groupId&gt;
  &lt;artifactId&gt;akka-stream-alpakka-sqs_2.12&lt;/artifactId&gt;
  &lt;version&gt;1.0-M2&lt;/version&gt;
&lt;/dependency&gt;</code></pre></dd><dt>Gradle</dt><dd><pre class="prettyprint"><code class="language-gradle">dependencies {
  compile group: 'com.lightbend.akka', name: 'akka-stream-alpakka-sqs_2.12', version: '1.0-M2'
}</code></pre></dd></dl>
<p>The table below shows direct dependencies of this module and the second tab shows all libraries it depends on transitively.</p>
<dl class="dependencies"><dt>Direct dependencies</dt><dd><table>
  <thead><tr><th>Organization</th><th>Artifact</th><th>Version</th><th>License</th></tr></thead>
  <tbody>
    <tr><td>com.amazonaws</td><td>aws-java-sdk-sqs</td><td><a href="https://mvnrepository.com/artifact/com.amazonaws/aws-java-sdk-sqs/1.11.476" target="_blank">1.11.476</a></td><td>Apache License, Version 2.0</td></tr>
    <tr><td>com.typesafe.akka</td><td>akka-stream_2.12</td><td><a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream_2.12/2.5.19" target="_blank">2.5.19</a></td><td>Apache License, Version 2.0</td></tr>
    <tr><td>org.scala-lang</td><td>scala-library</td><td><a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.7" target="_blank">2.12.7</a></td><td>BSD 3-Clause</td></tr>
  </tbody>
</table></dd>
<dt>Dependency tree</dt><dd><pre>
com.amazonaws    aws-java-sdk-sqs    <a href="https://mvnrepository.com/artifact/com.amazonaws/aws-java-sdk-sqs/1.11.476" target="_blank">1.11.476</a>    Apache License, Version 2.0
    com.amazonaws    aws-java-sdk-core    <a href="https://mvnrepository.com/artifact/com.amazonaws/aws-java-sdk-core/1.11.476" target="_blank">1.11.476</a>    Apache License, Version 2.0
        com.fasterxml.jackson.core    jackson-databind    <a href="https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind/2.6.7.2" target="_blank">2.6.7.2</a>    The Apache Software License, Version 2.0
            com.fasterxml.jackson.core    jackson-annotations    <a href="https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-annotations/2.6.0" target="_blank">2.6.0</a>    The Apache Software License, Version 2.0
            com.fasterxml.jackson.core    jackson-core    <a href="https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core/2.6.7" target="_blank">2.6.7</a>    The Apache Software License, Version 2.0
        com.fasterxml.jackson.dataformat    jackson-dataformat-cbor    <a href="https://mvnrepository.com/artifact/com.fasterxml.jackson.dataformat/jackson-dataformat-cbor/2.6.7" target="_blank">2.6.7</a>    The Apache Software License, Version 2.0
            com.fasterxml.jackson.core    jackson-core    <a href="https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core/2.6.7" target="_blank">2.6.7</a>    The Apache Software License, Version 2.0
        commons-logging    commons-logging    <a href="https://mvnrepository.com/artifact/commons-logging/commons-logging/1.1.3" target="_blank">1.1.3</a>    The Apache Software License, Version 2.0
        joda-time    joda-time    <a href="https://mvnrepository.com/artifact/joda-time/joda-time/2.8.1" target="_blank">2.8.1</a>    Apache 2
        org.apache.httpcomponents    httpclient    <a href="https://mvnrepository.com/artifact/org.apache.httpcomponents/httpclient/4.5.5" target="_blank">4.5.5</a>    Apache License, Version 2.0
            commons-codec    commons-codec    <a href="https://mvnrepository.com/artifact/commons-codec/commons-codec/1.10" target="_blank">1.10</a>    Apache License, Version 2.0
            commons-logging    commons-logging    <a href="https://mvnrepository.com/artifact/commons-logging/commons-logging/1.1.3" target="_blank">1.1.3</a>    The Apache Software License, Version 2.0
            org.apache.httpcomponents    httpcore    <a href="https://mvnrepository.com/artifact/org.apache.httpcomponents/httpcore/4.4.9" target="_blank">4.4.9</a>    Apache License, Version 2.0
        software.amazon.ion    ion-java    <a href="https://mvnrepository.com/artifact/software.amazon.ion/ion-java/1.0.2" target="_blank">1.0.2</a>    The Apache License, Version 2.0
    com.amazonaws    jmespath-java    <a href="https://mvnrepository.com/artifact/com.amazonaws/jmespath-java/1.11.476" target="_blank">1.11.476</a>    Apache License, Version 2.0
        com.fasterxml.jackson.core    jackson-databind    <a href="https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind/2.6.7.2" target="_blank">2.6.7.2</a>    The Apache Software License, Version 2.0
            com.fasterxml.jackson.core    jackson-annotations    <a href="https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-annotations/2.6.0" target="_blank">2.6.0</a>    The Apache Software License, Version 2.0
            com.fasterxml.jackson.core    jackson-core    <a href="https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core/2.6.7" target="_blank">2.6.7</a>    The Apache Software License, Version 2.0
com.typesafe.akka    akka-stream_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream_2.12/2.5.19" target="_blank">2.5.19</a>    Apache License, Version 2.0
    com.typesafe.akka    akka-actor_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.12/2.5.19" target="_blank">2.5.19</a>    Apache License, Version 2.0
        com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.3.3" target="_blank">1.3.3</a>    Apache License, Version 2.0
        org.scala-lang.modules    scala-java8-compat_2.12    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.12/0.8.0" target="_blank">0.8.0</a>    BSD 3-clause
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.7" target="_blank">2.12.7</a>    BSD 3-Clause
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.7" target="_blank">2.12.7</a>    BSD 3-Clause
    com.typesafe.akka    akka-protobuf_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-protobuf_2.12/2.5.19" target="_blank">2.5.19</a>    Apache License, Version 2.0
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.7" target="_blank">2.12.7</a>    BSD 3-Clause
    com.typesafe    ssl-config-core_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe/ssl-config-core_2.12/0.3.6" target="_blank">0.3.6</a>    Apache-2.0
        com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.3.3" target="_blank">1.3.3</a>    Apache License, Version 2.0
        org.scala-lang.modules    scala-parser-combinators_2.12    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-parser-combinators_2.12/1.1.1" target="_blank">1.1.1</a>    BSD 3-clause
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.7" target="_blank">2.12.7</a>    BSD 3-Clause
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.7" target="_blank">2.12.7</a>    BSD 3-Clause
    org.reactivestreams    reactive-streams    <a href="https://mvnrepository.com/artifact/org.reactivestreams/reactive-streams/1.0.2" target="_blank">1.0.2</a>    CC0
    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.7" target="_blank">2.12.7</a>    BSD 3-Clause
org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.7" target="_blank">2.12.7</a>    BSD 3-Clause</pre></dd>
</dl>

<h2><a href="#setup" name="setup" class="anchor"><span class="anchor-link"></span></a>Setup</h2>

<p>Prepare an <a href="https://doc.akka.io/api/akka/2.5.19/akka/actor/ActorSystem.html">ActorSystem</a> and a <a href="https://doc.akka.io/api/akka/2.5.19/akka/stream/Materializer.html">Materializer</a>.</p>

<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/akka/stream/alpakka/sqs/scaladsl/DefaultTestContext.scala#L21-L22" target="_blank" title="Go to snippet source"></a><code class="language-scala">implicit val system: ActorSystem = ActorSystem()
implicit val mat: Materializer = ActorMaterializer()</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/akka/stream/alpakka/sqs/javadsl/BaseSqsTest.java#L38-L39" target="_blank" title="Go to snippet source"></a><code class="language-java">system = ActorSystem.create();
materializer = ActorMaterializer.create(system);</code></pre></dd>
</dl>
<p>This connector requires an implicit <code>AmazonSQSAsync</code> instance to communicate with AWS SQS. </p>
<p>It is your code&rsquo;s responsibility to call <code>shutdown</code> to free any resources held by the client. In this example it will be called when the actor system is terminated.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/akka/stream/alpakka/sqs/scaladsl/DefaultTestContext.scala#L49-L59" target="_blank" title="Go to snippet source"></a><code class="language-scala">import com.amazonaws.auth.{AWSStaticCredentialsProvider, BasicAWSCredentials}
import com.amazonaws.client.builder.AwsClientBuilder.EndpointConfiguration
import com.amazonaws.services.sqs.{AmazonSQSAsync, AmazonSQSAsyncClientBuilder}

val credentialsProvider = new AWSStaticCredentialsProvider(new BasicAWSCredentials(&quot;x&quot;, &quot;x&quot;))
implicit val awsSqsClient: AmazonSQSAsync = AmazonSQSAsyncClientBuilder
  .standard()
  .withCredentials(credentialsProvider)
  .withEndpointConfiguration(new EndpointConfiguration(sqsEndpoint, &quot;eu-central-1&quot;))
  .build()
system.registerOnTermination(awsSqsClient.shutdown())</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/akka/stream/alpakka/sqs/javadsl/BaseSqsTest.java#L12-L66" target="_blank" title="Go to snippet source"></a><code class="language-java">import com.amazonaws.auth.AWSCredentialsProvider;
import com.amazonaws.auth.AWSStaticCredentialsProvider;
import com.amazonaws.auth.BasicAWSCredentials;
import com.amazonaws.client.builder.AwsClientBuilder;
import com.amazonaws.services.sqs.AmazonSQSAsync;
import com.amazonaws.services.sqs.AmazonSQSAsyncClientBuilder;

AWSCredentialsProvider credentialsProvider =
    new AWSStaticCredentialsProvider(new BasicAWSCredentials(&quot;x&quot;, &quot;x&quot;));
AmazonSQSAsync awsSqsClient =
    AmazonSQSAsyncClientBuilder.standard()
        .withCredentials(credentialsProvider)
        .withEndpointConfiguration(
            new AwsClientBuilder.EndpointConfiguration(sqsEndpoint, &quot;eu-central-1&quot;))
        .build();
system.registerOnTermination(() -&gt; awsSqsClient.shutdown());</code></pre></dd>
</dl>
<h2><a href="#read-from-an-sqs-queue" name="read-from-an-sqs-queue" class="anchor"><span class="anchor-link"></span></a>Read from an SQS queue</h2>
<p>The <span class="group-scala"><a href="https://doc.akka.io/api/alpakka/1.0-M2/akka/stream/alpakka/sqs/scaladsl/SqsSource$.html">SqsSource</a></span><span class="group-java"><a href="https://doc.akka.io/api/alpakka/1.0-M2/akka/stream/alpakka/sqs/javadsl/SqsSource$.html">SqsSource</a></span> created source reads AWS Java SDK SQS <code>Message</code> objects from any SQS queue given by the queue URL.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsSourceSpec.scala#L173-L176" target="_blank" title="Go to snippet source"></a><code class="language-scala">SqsSource(
  queueUrl,
  SqsSourceSettings().withCloseOnEmptyReceive(true).withWaitTime(1.second)
).runWith(Sink.seq)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsSourceTest.java#L43-L49" target="_blank" title="Go to snippet source"></a><code class="language-java">SqsSource.create(
        queueUrl,
        SqsSourceSettings.create()
            .withCloseOnEmptyReceive(true)
            .withWaitTime(Duration.ofSeconds(1)),
        sqsClient)
    .runWith(Sink.seq(), materializer);</code></pre></dd>
</dl>
<p>In this example we use the <code>closeOnEmptyReceive</code> to let the stream complete when there are no more messages on the queue. In realistic scenarios, you should add a <code>KillSwitch</code> to the stream, see <a href="https://doc.akka.io/docs/akka/current/stream/stream-dynamic.html#controlling-stream-completion-with-killswitch">&ldquo;Controlling stream completion with KillSwitch&rdquo; in the Akka documentation</a>.</p>
<h3><a href="#source-configuration" name="source-configuration" class="anchor"><span class="anchor-link"></span></a>Source configuration</h3>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsSourceSpec.scala#L97-L104" target="_blank" title="Go to snippet source"></a><code class="language-scala">val settings = SqsSourceSettings()
  .withWaitTime(20.seconds)
  .withMaxBufferSize(100)
  .withMaxBatchSize(10)
  .withAttributes(immutable.Seq(SenderId, SentTimestamp))
  .withMessageAttribute(MessageAttributeName.create(&quot;bar.*&quot;))
  .withCloseOnEmptyReceive(true)
  .withVisibilityTimeout(10.seconds)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsSourceTest.java#L58-L65" target="_blank" title="Go to snippet source"></a><code class="language-java">SqsSourceSettings settings =
    SqsSourceSettings.create()
        .withWaitTime(Duration.ofSeconds(20))
        .withMaxBufferSize(100)
        .withMaxBatchSize(10)
        .withAttributes(Arrays.asList(Attribute.senderId(), Attribute.sentTimestamp()))
        .withMessageAttribute(MessageAttributeName.create(&quot;bar.*&quot;))
        .withCloseOnEmptyReceive(true);</code></pre></dd>
</dl>
<p>Options:</p>
<ul>
  <li><code>maxBatchSize</code> - the maximum number of messages to return (see <code>MaxNumberOfMessages</code> in AWS docs). Default: 10</li>
  <li><code>maxBufferSize</code> - internal buffer size used by the <code>Source</code>. Default: 100 messages</li>
  <li><code>waitTimeSeconds</code> - the duration for which the call waits for a message to arrive in the queue before returning (see <code>WaitTimeSeconds</code> in AWS docs). Default: 20 seconds</li>
  <li><code>closeOnEmptyReceive</code> - If true, the source completes when no messages are available.</li>
</ul>
<p>More details are available in the <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_ReceiveMessage.html#API_ReceiveMessage_RequestParameters">AWS SQS Receive Message documentation</a>.</p>
<p>An <code>SqsSource</code> can either provide an infinite stream of messages (the default), or can drain its source queue until no further messages are available. The latter behaviour is enabled by setting the <code>closeOnEmptyReceive</code> flag on creation. If set, the <code>Source</code> will receive messages until it encounters an empty reply from the server. It then continues to emit any remaining messages in its local buffer. The stage will complete once the last message has been sent downstream.</p>
<p>Note that for short-polling (<code>waitTimeSeconds</code> of 0), SQS may respond with an empty reply even if there are still messages in the queue. This behavior can be prevented by switching to long-polling (by setting <code>waitTimeSeconds</code> to a nonzero value).</p>
<p>Be aware that the <code>SqsSource</code> runs multiple requests to Amazon SQS in parallel. The maximum number of concurrent requests is limited by <code>parallelism = maxBufferSize / maxBatchSize</code>. E.g.: By default <code>maxBatchSize</code> is set to 10 and <code>maxBufferSize</code> is set to 100 so at the maximum, <code>SqsSource</code> will run 10 concurrent requests to Amazon SQS. <code>AmazonSQSAsyncClient</code> uses a fixed thread pool with 50 threads by default. To tune the thread pool used by <code>AmazonSQSAsyncClient</code> you can supply a custom <code>ExecutorService</code> on client creation.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsSourceSpec.scala#L147-L156" target="_blank" title="Go to snippet source"></a><code class="language-scala">val credentialsProvider = new AWSStaticCredentialsProvider(new BasicAWSCredentials(&quot;x&quot;, &quot;x&quot;))
implicit val customSqsClient: AmazonSQSAsync =
  AmazonSQSAsyncClientBuilder
    .standard()
    .withCredentials(credentialsProvider)
    .withExecutorFactory(new ExecutorFactory {
      override def newExecutor() = Executors.newFixedThreadPool(10)
    })
    .withEndpointConfiguration(new EndpointConfiguration(sqsEndpoint, &quot;eu-central-1&quot;))
    .build()</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsSourceTest.java#L76-L85" target="_blank" title="Go to snippet source"></a><code class="language-java">AWSCredentialsProvider credentialsProvider =
    new AWSStaticCredentialsProvider(new BasicAWSCredentials(&quot;x&quot;, &quot;x&quot;));

AmazonSQSAsync customSqsClient =
    AmazonSQSAsyncClientBuilder.standard()
        .withCredentials(credentialsProvider)
        .withExecutorFactory(() -&gt; Executors.newFixedThreadPool(10))
        .withEndpointConfiguration(
            new AwsClientBuilder.EndpointConfiguration(sqsEndpoint, &quot;eu-central-1&quot;))
        .build();</code></pre></dd>
</dl>
<p>Please make sure to configure a big enough thread pool to avoid resource starvation. This is especially important, if you share the client between multiple Sources, Sinks and Flows. For the SQS Sinks and Sources the sum of all <code>parallelism</code> (Source) and <code>maxInFlight</code> (Sink) must be less than or equal to the thread pool size.</p>
<h2><a href="#publish-messages-to-an-sqs-queue" name="publish-messages-to-an-sqs-queue" class="anchor"><span class="anchor-link"></span></a>Publish messages to an SQS queue</h2>
<p>Create a <code>String</code>-accepting sink, publishing to an SQS queue.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsPublishSpec.scala#L80-L82" target="_blank" title="Go to snippet source"></a><code class="language-scala">Source
  .single(&quot;alpakka&quot;)
  .runWith(SqsPublishSink(queueUrl))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsPublishTest.java#L65-L68" target="_blank" title="Go to snippet source"></a><code class="language-java">Source.single(&quot;alpakka&quot;)
    .runWith(
        SqsPublishSink.create(queueUrl, SqsPublishSettings.create(), sqsClient),
        materializer);</code></pre></dd>
</dl>
<p>Create a <code>SendMessageRequest</code>-accepting sink, that publishes an SQS queue.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsPublishSpec.scala#L92-L110" target="_blank" title="Go to snippet source"></a><code class="language-scala">// for fix SQS queue
Source
  .single(new SendMessageRequest().withMessageBody(&quot;alpakka&quot;))
  .runWith(SqsPublishSink.messageSink(queueUrl))

// for dynamic SQS queues
Source
  .single(new SendMessageRequest().withMessageBody(&quot;alpakka&quot;).withQueueUrl(queueUrl))
  .runWith(SqsPublishSink.messageSink())</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsPublishTest.java#L84-L108" target="_blank" title="Go to snippet source"></a><code class="language-java">// for fix SQS queue
Source.single(new SendMessageRequest().withMessageBody(&quot;alpakka&quot;))
    .runWith(
        SqsPublishSink.messageSink(queueUrl, SqsPublishSettings.create(), sqsClient),
        materializer);

// for dynamic SQS queues
Source.single(new SendMessageRequest().withMessageBody(&quot;alpakka&quot;).withQueueUrl(queueUrl))
    .runWith(
        SqsPublishSink.messageSink(SqsPublishSettings.create(), sqsClient), materializer);</code></pre></dd>
</dl>
<p>You can also build flow stages which publish messages to SQS queues, backpressure on queue response, and then forward <a href="https://doc.akka.io/api/alpakka/1.0-M2/akka/stream/alpakka/sqs/SqsPublishResult.html"><code>SqsPublishResult</code></a> further down the stream. </p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsPublishSpec.scala#L162-L184" target="_blank" title="Go to snippet source"></a><code class="language-scala">// for fix SQS queue
Source
  .single(new SendMessageRequest().withMessageBody(&quot;alpakka&quot;))
  .via(SqsPublishFlow(queueUrl))
  .runWith(Sink.head)

// for dynamic SQS queues
Source
  .single(new SendMessageRequest().withMessageBody(&quot;alpakka&quot;).withQueueUrl(queueUrl))
  .via(SqsPublishFlow())
  .runWith(Sink.head)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsPublishTest.java#L123-L146" target="_blank" title="Go to snippet source"></a><code class="language-java">// for fix SQS queue
Source.single(new SendMessageRequest().withMessageBody(&quot;alpakka-flow&quot;))
    .via(SqsPublishFlow.create(queueUrl, SqsPublishSettings.create(), sqsClient))
    .runWith(Sink.head(), materializer);

// for dynamic SQS queues
Source.single(new SendMessageRequest(queueUrl, &quot;alpakka-flow&quot;))
    .via(SqsPublishFlow.create(SqsPublishSettings.create(), sqsClient))
    .runWith(Sink.head(), materializer);</code></pre></dd>
</dl>
<h3><a href="#group-messages-and-publish-batches-to-an-sqs-queue" name="group-messages-and-publish-batches-to-an-sqs-queue" class="anchor"><span class="anchor-link"></span></a>Group messages and publish batches to an SQS queue</h3>
<p>Create a sink, that forwards <code>String</code> to the SQS queue. However, the main difference from the previous use case, it batches items and sends as a one request.</p>
<p>Note: There is also another option to send batch of messages to SQS which is using <code>AmazonSQSBufferedAsyncClient</code>. This client buffers <code>SendMessageRequest</code>s under the hood and sends them as a batch instead of sending them one by one. However, beware that <code>AmazonSQSBufferedAsyncClient</code> does not support FIFO Queues. See <a href="http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-client-side-buffering-request-batching.html">documentation for client-side buffering.</a></p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsPublishSpec.scala#L120-L123" target="_blank" title="Go to snippet source"></a><code class="language-scala">val messages = for (i &lt;- 0 until 10) yield s&quot;Message - $i&quot;

val future = Source(messages)
  .runWith(SqsPublishSink.grouped(queueUrl, SqsPublishGroupedSettings.Defaults.withMaxBatchSize(2)))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsPublishTest.java#L161-L170" target="_blank" title="Go to snippet source"></a><code class="language-java">List&lt;String&gt; messagesToSend = new ArrayList&lt;&gt;();
for (int i = 0; i &lt; 20; i++) {
  messagesToSend.add(&quot;message - &quot; + i);
}

CompletionStage&lt;Done&gt; done =
    Source.from(messagesToSend)
        .runWith(
            SqsPublishSink.grouped(queueUrl, SqsPublishGroupedSettings.create(), sqsClient),
            materializer);</code></pre></dd>
</dl>
<h3><a href="#grouping-configuration" name="grouping-configuration" class="anchor"><span class="anchor-link"></span></a>Grouping configuration</h3>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsPublishSpec.scala#L68-L72" target="_blank" title="Go to snippet source"></a><code class="language-scala">val batchSettings =
  SqsPublishGroupedSettings()
    .withMaxBatchSize(10)
    .withMaxBatchWait(500.millis)
    .withConcurrentRequests(1)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsPublishTest.java#L41-L45" target="_blank" title="Go to snippet source"></a><code class="language-java">SqsPublishGroupedSettings batchSettings =
    SqsPublishGroupedSettings.create()
        .withMaxBatchSize(10)
        .withMaxBatchWait(Duration.ofMillis(500))
        .withConcurrentRequests(1);</code></pre></dd>
</dl>
<p>Options:</p>
<ul>
  <li><code>maxBatchSize</code> - the maximum number of messages in batch to send SQS. Default: 10.</li>
  <li><code>maxBatchWait</code> - the maximum duration for which the stage waits until <code>maxBatchSize</code> messages arrived. Sends what is collects at the end of the time period even though the <code>maxBatchSize</code> is not fulfilled. Default: 500 milliseconds</li>
  <li><code>concurrentRequests</code> - the number of batches sending to SQS concurrently.</li>
</ul>
<h3><a href="#publish-lists-as-batches-to-an-sqs-queue" name="publish-lists-as-batches-to-an-sqs-queue" class="anchor"><span class="anchor-link"></span></a>Publish lists as batches to an SQS queue</h3>
<p>Create a sink, that publishes <span class="group-scala"><code>Iterable[String]</code></span><span class="group-java"><code>Iterable&lt;String&gt;</code></span> to the SQS queue.</p>
<p>Be aware that the size of the batch must be less than or equal to 10 because Amazon SQS has a limit for batch request. If the batch has more than 10 entries, the request will fail.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsPublishSpec.scala#L133-L137" target="_blank" title="Go to snippet source"></a><code class="language-scala">val messages = for (i &lt;- 0 until 10) yield s&quot;Message - $i&quot;

val future = Source
  .single(messages)
  .runWith(SqsPublishSink.batch(queueUrl))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsPublishTest.java#L193-L203" target="_blank" title="Go to snippet source"></a><code class="language-java">List&lt;String&gt; messagesToSend = new ArrayList&lt;&gt;();
for (int i = 0; i &lt; 10; i++) {
  messagesToSend.add(&quot;Message - &quot; + i);
}
Iterable&lt;String&gt; it = messagesToSend;

CompletionStage&lt;Done&gt; done =
    Source.single(it)
        .runWith(
            SqsPublishSink.batch(queueUrl, SqsPublishBatchSettings.create(), sqsClient),
            materializer);</code></pre></dd>
</dl>
<p>Create a sink, that publishes <span class="group-scala"><code>Iterable[SendMessageRequest]</code></span><span class="group-java"><code>Iterable&lt;SendMessageRequest&gt;</code></span> to the SQS queue.</p><div class="callout warning "><div class="callout-title">Warning</div>
<p>Be aware that the size of the batch must be less than or equal to 10 because Amazon SQS has a limit for batch requests. If the batch has more than 10 entries, the request will fail.</p></div>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsPublishSpec.scala#L147-L151" target="_blank" title="Go to snippet source"></a><code class="language-scala">val messages = for (i &lt;- 0 until 10) yield new SendMessageRequest().withMessageBody(s&quot;Message - $i&quot;)

val future = Source
  .single(messages)
  .runWith(SqsPublishSink.batchedMessageSink(queueUrl))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsPublishTest.java#L221-L232" target="_blank" title="Go to snippet source"></a><code class="language-java">List&lt;SendMessageRequest&gt; messagesToSend = new ArrayList&lt;&gt;();
for (int i = 0; i &lt; 10; i++) {
  messagesToSend.add(new SendMessageRequest().withMessageBody(&quot;Message - &quot; + i));
}
Iterable&lt;SendMessageRequest&gt; it = messagesToSend;

CompletionStage&lt;Done&gt; done =
    Source.single(it)
        .runWith(
            SqsPublishSink.batchedMessageSink(
                queueUrl, SqsPublishBatchSettings.create(), sqsClient),
            materializer);</code></pre></dd>
</dl>
<h3><a href="#batch-configuration" name="batch-configuration" class="anchor"><span class="anchor-link"></span></a>Batch configuration</h3>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsPublishSpec.scala#L59-L61" target="_blank" title="Go to snippet source"></a><code class="language-scala">val batchSettings =
  SqsPublishBatchSettings()
    .withConcurrentRequests(1)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsPublishTest.java#L32-L33" target="_blank" title="Go to snippet source"></a><code class="language-java">SqsPublishBatchSettings batchSettings =
    SqsPublishBatchSettings.create().withConcurrentRequests(1);</code></pre></dd>
</dl>
<p>Options:</p>
<ul>
  <li><code>concurrentRequests</code> - the number of batches sending to SQS concurrently.</li>
</ul>
<h2><a href="#updating-message-statuses" name="updating-message-statuses" class="anchor"><span class="anchor-link"></span></a>Updating message statuses</h2>
<p><code>SqsAckSink</code> and <code>SqsAckFlow</code> provide the possibility to acknowledge (delete), ignore, or postpone messages on an SQS queue. They accept <a href="https://doc.akka.io/api/alpakka/1.0-M2/akka/stream/alpakka/sqs/MessageAction.html"><code>MessageAction</code></a> sub-classes to select the action to be taken.</p>
<p>For every message you may decide which action to take and push it together with message back to the queue:</p>
<ul>
  <li><code>Delete</code> - delete message from the queue</li>
  <li><code>Ignore</code> - don&rsquo;t change that message, and let it reappear in the queue after the visibility timeout</li>
  <li><code>ChangeMessageVisibility(visibilityTimeout)</code> - can be used to postpone a message, or make  the message immediately visible to other consumers. See <a href="http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-visibility-timeout.html">official documentation</a> for more details.</li>
</ul>
<h3><a href="#acknowledge-delete-messages" name="acknowledge-delete-messages" class="anchor"><span class="anchor-link"></span></a>Acknowledge (delete) messages</h3>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsAckSpec.scala#L87-L90" target="_blank" title="Go to snippet source"></a><code class="language-scala">SqsSource(queueUrl)
  .take(1)
  .map(MessageAction.Delete(_))
  .runWith(SqsAckSink(queueUrl))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsAckTest.java#L90-L92" target="_blank" title="Go to snippet source"></a><code class="language-java">source
    .map(m -&gt; MessageAction.delete(m))
    .runWith(SqsAckSink.create(queueUrl, SqsAckSettings.create(), awsClient), materializer);</code></pre></dd>
</dl>
<h3><a href="#ignore-messages" name="ignore-messages" class="anchor"><span class="anchor-link"></span></a>Ignore messages</h3>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsAckSpec.scala#L122-L124" target="_blank" title="Go to snippet source"></a><code class="language-scala">SqsSource(queueUrl)
  .map(MessageAction.Ignore(_))
  .runWith(SqsAckSink(queueUrl))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsAckTest.java#L177-L180" target="_blank" title="Go to snippet source"></a><code class="language-java">source
    .map(m -&gt; MessageAction.ignore(m))
    .via(SqsAckFlow.create(queueUrl, SqsAckSettings.create(), awsClient))
    .runWith(Sink.seq(), materializer);</code></pre></dd>
</dl>
<h3><a href="#change-visibility-timeout-of-messages" name="change-visibility-timeout-of-messages" class="anchor"><span class="anchor-link"></span></a>Change Visibility Timeout of messages</h3>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsAckSpec.scala#L105-L108" target="_blank" title="Go to snippet source"></a><code class="language-scala">SqsSource(queueUrl)
  .take(1)
  .map(MessageAction.ChangeMessageVisibility(_, 5))
  .runWith(SqsAckSink(queueUrl))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsAckTest.java#L157-L159" target="_blank" title="Go to snippet source"></a><code class="language-java">source
    .map(m -&gt; MessageAction.changeMessageVisibility(m, 12))
    .runWith(SqsAckSink.create(queueUrl, SqsAckSettings.create(), awsClient), materializer);</code></pre></dd>
</dl>
<h3><a href="#update-message-status-in-a-flow" name="update-message-status-in-a-flow" class="anchor"><span class="anchor-link"></span></a>Update message status in a flow</h3>
<p>The flow accepts a <a href="https://doc.akka.io/api/alpakka/1.0-M2/akka/stream/alpakka/sqs/MessageAction.html"><code>MessageAction</code></a> sub-classes, and returns <a href="https://doc.akka.io/api/alpakka/1.0-M2/akka/stream/alpakka/sqs/SqsAckResult.html"><code>SqsAckResult</code></a> .</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsAckSpec.scala#L135-L139" target="_blank" title="Go to snippet source"></a><code class="language-scala">SqsSource(queueUrl)
  .take(1)
  .map(MessageAction.Delete(_))
  .via(SqsAckFlow(queueUrl))
  .runWith(Sink.head)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsAckTest.java#L119-L122" target="_blank" title="Go to snippet source"></a><code class="language-java">source
    .map(m -&gt; MessageAction.delete(m))
    .via(SqsAckFlow.create(queueUrl, SqsAckSettings.create(), awsClient))
    .runWith(Sink.seq(), materializer);</code></pre></dd>
</dl>
<h3><a href="#sqsack-configuration" name="sqsack-configuration" class="anchor"><span class="anchor-link"></span></a>SqsAck configuration</h3>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsAckSpec.scala#L45-L47" target="_blank" title="Go to snippet source"></a><code class="language-scala">val sinkSettings =
  SqsAckSettings()
    .withMaxInFlight(10)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsAckTest.java#L46" target="_blank" title="Go to snippet source"></a><code class="language-java">SqsAckSettings sinkSettings = SqsAckSettings.create().withMaxInFlight(10);</code></pre></dd>
</dl>
<p>Options:</p>
<ul>
  <li><code>maxInFlight</code> - maximum number of messages being processed by <code>AmazonSQSAsync</code> at the same time. Default: 10</li>
</ul>
<h3><a href="#updating-message-statuses-in-batches-with-grouping" name="updating-message-statuses-in-batches-with-grouping" class="anchor"><span class="anchor-link"></span></a>Updating message statuses in batches with grouping</h3>
<p><code>SqsAckFlow.grouped</code> is a flow that can acknowledge (delete), ignore, or postpone messages, but it batches items and sends them as one request per action.</p>
<p>Acknowledge (delete) messages:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsAckSpec.scala#L172-L176" target="_blank" title="Go to snippet source"></a><code class="language-scala">SqsSource(queueUrl)
  .take(10)
  .map(MessageAction.Delete(_))
  .via(SqsAckFlow.grouped(queueUrl, SqsAckGroupedSettings.Defaults))
  .runWith(Sink.seq)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsAckTest.java#L214-L218" target="_blank" title="Go to snippet source"></a><code class="language-java">source
    .map(m -&gt; MessageAction.delete(m))
    .via(SqsAckFlow.grouped(queueUrl, SqsAckGroupedSettings.create(), awsClient))
    .runWith(Sink.seq(), materializer);
</code></pre></dd>
</dl>
<p>Ignore messages:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsAckSpec.scala#L346-L350" target="_blank" title="Go to snippet source"></a><code class="language-scala">Source(messages)
  .take(10)
  .map(MessageAction.Ignore(_))
  .via(SqsAckFlow.grouped(&quot;queue&quot;, SqsAckGroupedSettings.Defaults))
  .runWith(Sink.seq)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsAckTest.java#L288-L291" target="_blank" title="Go to snippet source"></a><code class="language-java">source
    .map(m -&gt; MessageAction.ignore(m))
    .via(SqsAckFlow.grouped(queueUrl, SqsAckGroupedSettings.create(), awsClient))
    .runWith(Sink.seq(), materializer);</code></pre></dd>
</dl>
<p>Change Visibility Timeout of messages:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsAckSpec.scala#L320-L324" target="_blank" title="Go to snippet source"></a><code class="language-scala">SqsSource(queueUrl)
  .take(10)
  .map(MessageAction.ChangeMessageVisibility(_, 5))
  .via(SqsAckFlow.grouped(queueUrl, SqsAckGroupedSettings.Defaults))
  .runWith(Sink.seq)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsAckTest.java#L258-L261" target="_blank" title="Go to snippet source"></a><code class="language-java">source
    .map(m -&gt; MessageAction.changeMessageVisibility(m, 5))
    .via(SqsAckFlow.grouped(queueUrl, SqsAckGroupedSettings.create(), awsClient))
    .runWith(Sink.seq(), materializer);</code></pre></dd>
</dl>
<h3><a href="#acknowledge-grouping-configuration" name="acknowledge-grouping-configuration" class="anchor"><span class="anchor-link"></span></a>Acknowledge grouping configuration</h3>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/scala/docs/scaladsl/SqsAckSpec.scala#L73-L77" target="_blank" title="Go to snippet source"></a><code class="language-scala">val batchSettings =
  SqsAckGroupedSettings()
    .withMaxBatchSize(10)
    .withMaxBatchWait(500.millis)
    .withConcurrentRequests(1)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/alpakka/tree/v1.0-M2/sqs/src/test/java/docs/javadsl/SqsAckTest.java#L62-L66" target="_blank" title="Go to snippet source"></a><code class="language-java">SqsAckGroupedSettings flowSettings =
    SqsAckGroupedSettings.create()
        .withMaxBatchSize(10)
        .withMaxBatchWait(Duration.ofMillis(500))
        .withConcurrentRequests(1);</code></pre></dd>
</dl>
<p>Options:</p>
<ul>
  <li><code>maxBatchSize</code> - the maximum number of messages in batch to send SQS. Default: 10.</li>
  <li><code>maxBatchWait</code> - the maximum duration for which the stage waits until <code>maxBatchSize</code> messages arrived. Sends what is collects at the end of the time period even though the <code>maxBatchSize</code> is not fulfilled. Default: 500 milliseconds</li>
  <li><code>concurrentRequests</code> - the number of batches sending to SQS concurrently.</li>
</ul>
<h2><a href="#integration-testing" name="integration-testing" class="anchor"><span class="anchor-link"></span></a>Integration testing</h2>
<p>For integration testing without touching Amazon SQS, Alpakka uses <a href="https://github.com/adamw/elasticmq">ElasticMQ</a>, a queuing service which serves an AWS SQS compatible API.</p>
<h3><a href="#running-the-example-code" name="running-the-example-code" class="anchor"><span class="anchor-link"></span></a>Running the example code</h3>
<p>The code in this guide is part of runnable tests of this project. You are welcome to edit the code and run it in sbt.</p>
<blockquote>
  <p>The code requires ElasticMQ running in the background. You can start it quickly using docker:</p>
  <p><code>docker-compose up elasticmq</code></p>
</blockquote>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre><code>sbt &#39;project sqs&#39; test
</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre><code>sbt &#39;project sqs&#39; test
</code></pre></dd>
</dl>
</div>
</article>

<div class="row">
<div class="small-12 large-9 column">
<section class="nav-prev-next row">
<div class="nav-prev small-6 column">
<a href="sns.html"><i class="icon-prev"></i> <span class="link-prev">AWS SNS</span></a>
</div>
<div class="nav-next small-6 column clearfix">
<a class="float-right" href="external/azure-event-hubs.html">Azure Event Hubs <i class="icon-next"></i></a>
</div>
</section>
</div>
</div>

<div class="source-github row">
Found an error in this documentation? The source code for this page can be found <a href="https://github.com/akka/alpakka/tree/v1.0-M2/docs/src/main/paradox/sqs.md">here</a>.
Please feel free to edit and contribute a pull request.
</div>


<footer class="page-footer row clearfix">
<img class="akka-icon float-left show-for-medium" src="images/akka-icon.svg"/>
<section class="copyright">
<div>Alpakka is Open Source and available under the Apache 2 License.</div>
<p class="legal">
&copy; 2011-2019 <a href="https://www.lightbend.com" target="_blank">Lightbend, Inc.</a> | 
<a href="https://www.lightbend.com/legal/licenses" target="_blank">Licenses</a> | 
<a href="https://www.lightbend.com/legal/terms" target="_blank">Terms</a> | 
<a href="https://www.lightbend.com/legal/privacy" target="_blank">Privacy Policy</a> | 
<a href="https://akka.io/cookie/" target="_blank">Cookie Listing</a> | 
<a class="optanon-toggle-display">Cookie Settings</a>
</p>
</section>
</footer>

</section>
</main>

<script type="text/javascript" src="js/scrollsneak.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="js/groups.js"></script>
<script type="text/javascript" src="js/page.js"></script>
<script type="text/javascript" src="js/magellan.js"></script>

<style type="text/css">@import "lib/prettify/prettify.css";</style>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(){window.prettyPrint && prettyPrint()});
//]]></script>
<script type="text/javascript" src="assets/js/warnOldVersion.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(jq){initOldVersionWarnings(jq, '1.0-M2', 'https://doc.akka.io/docs/alpakka/current/')});
//]]></script>


</body>
</html>
