<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Events by tag &bull; Akka Persistence Cassandra</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="A Cassandra plugin for Akka Persistence."/>
<link rel="canonical" href="https://doc.akka.io/docs/akka-persistence-cassandra/current/events-by-tag.html"/>
<script type="text/javascript" src="lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="lib/foundation/dist/js/foundation.min.js"></script>
<link rel="stylesheet" type="text/css" href="lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="lib/foundation/dist/css/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<link rel="stylesheet" type="text/css" href="css/icons.css"/>
<link rel="stylesheet" type="text/css" href="css/page-7.css"/>
<link rel="stylesheet" type="text/css" href="css/banner-1.css"/>
<link rel="shortcut icon" href="images/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png"/>
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png"/>
<link rel="manifest" href="images/manifest.json"/>
<meta name="msapplication-TileImage" content="images/mstile-150x150.png"/>
<meta name="msapplication-TileColor" content="#15a9ce"/>
<meta name="theme-color" content="#15a9ce"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) start -->
<script src="https://optanon.blob.core.windows.net/consent/159bb13d-6748-4399-806e-ac28db879785.js" type="text/javascript" charset="UTF-8"></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) end -->
<!--Google Analytics-->
<script type="text/plain" class="optanon-category-2">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', '']);
_gaq.push(['_setDomainName', '']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})()
</script>
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-2">
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KBJGH35');
</script>
<!--Marketo-->
<script type="text/plain" class="optanon-category-3">
(function() {
var didInit = false;
function initMunchkin() {
if(didInit === false) {
didInit = true;
Munchkin.init('558-NCX-702', { 'asyncOnly': true, 'disableClickDelay': true });
}
}
var s = document.createElement('script');
s.type = 'text/javascript';
s.async = true;
s.src = '//munchkin.marketo.net/munchkin.js';
s.onreadystatechange = function() {
if (this.readyState == 'complete' || this.readyState == 'loaded') {
initMunchkin();
}
};
s.onload = initMunchkin;
document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
</head>

<body id="underlay" data-toggler="nav-open">
<div id="lightbend-banner" class="lightbend-banner akka full-width" data-category="OSS Lightbend Banner Impression" data-label="Akka Banner Impression">
<div class="wrapper">
<div class="brand">
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Lightbend Logo - Akka Banner" href="https://www.lightbend.com?r=oss-banner-akka" target="_blank">
<img class="lightbend-logo" src="images/banner-logos/lightbend-reverse.svg" alt="Lightbend" title="Lightbend">
</a>
</div>
<div class="nav">
<a class="banner-btn oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Enhance your Akka systems with Akka Platform [Button] - Akka Banner" href="https://www.lightbend.com/akka-platform?r=oss-banner-akka" target="_blank">
<span>Enhance your Akka systems with</span>
<img class="akka-platform-reverse-logo" src="images/banner-logos/akka-platform-reverse.svg" alt="Akka Platform" title="Akka Platform">
</a>
<div class="drop-down">
<svg class="svg-chevon-circle-down" version="1.1" id="Chevron_circled_down" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
<path fill="#ffffff" d="M12.505,8.698L10,11L7.494,8.698c-0.198-0.196-0.518-0.196-0.718,0c-0.197,0.196-0.197,0.515,0,0.71l2.864,2.807
c0.199,0.196,0.52,0.196,0.717,0l2.864-2.807c0.199-0.195,0.198-0.514,0-0.71C13.024,8.502,12.704,8.502,12.505,8.698z M10,0.4
c-5.302,0-9.6,4.298-9.6,9.6c0,5.303,4.298,9.6,9.6,9.6s9.6-4.297,9.6-9.6C19.6,4.698,15.302,0.4,10,0.4z M10,18.354
c-4.615,0-8.354-3.74-8.354-8.354c0-4.614,3.739-8.354,8.354-8.354c4.613,0,8.354,3.74,8.354,8.354
C18.354,14.614,14.613,18.354,10,18.354z" />
</svg>
<div class="drop-down-content">
<div class="lightbend-family">
<a href="https://cloudflow.io" class="cloudflow oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Cloudflow - Logo Tag Line - Akka Banner">
<img class="cloudflow-full-color-logo" src="images/banner-logos/cloudflow-full-color.svg" alt="Cloudflow by Lightbend" title="Cloudflow by Lightbend">
</a>
<a href="https://cloudstate.io" class="cloudstate oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Cloudstate - Logo Tag Line - Akka Banner">
<img class="cloudstate-full-color-logo" src="images/banner-logos/cloudstate-full-color.svg" alt="Cloudstate by Lightbend" title="Cloudstate by Lightbend">
</a>
<a href="https://www.lagomframework.com" class="lagom oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Lagom - Logo Tag Line - Akka Banner">
<img class="lagom-full-color-logo" src="images/banner-logos/lagom-full-color.svg" alt="Lagom Framework by Lightbend" title="Lagom Framework by Lightbend">
</a>
<a href="https://www.playframework.com" class="play oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Play - Logo Tag Line - Akka Banner">
<img class="play-full-color-logo" src="images/banner-logos/play-full-color.svg" alt="Play Framework by Lightbend" title="Play Framework by Lightbend">
</a>
<a href="https://www.scala-lang.org" class="scala oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Scala - Logo Tag Line - Akka Banner">
<img class="scala-full-color-logo" src="images/banner-logos/scala-full-color.svg" alt="Scala by Lightbend" title="Scala by Lightbend">
</a>
<div class="akka current">
<img class="akka-full-color-logo" src="images/banner-logos/akka-full-color.svg" alt="Akka by Lightbend" title="Akka by Lightbend">
<span>From the creators of <strong>Akka</strong>, get technology enhancements, monitoring, and expert support with Akka Platform from Lightbend.</span>
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Learn More [Button] - Akka Banner" href="https://www.lightbend.com/akka-platform?r=oss-banner-akka" target="_blank">Learn More</a>
</div>
</div>
<div class="title">The Lightbend Family</div>
</div>      
</div>
</div>
</div>
</div>

<header class="site-header hide-for-large">
<div class="sticky-header clearfix">
<a href="https://akka.io"><img class="logo" src="images/akka-logo-reverse.svg"/></a>

<button class="menu-icon float-right" type="button" data-toggle="underlay overlay"></button>
</div>
<div id="overlay" class="overlay-nav" data-toggler="nav-open">
<header class="nav-header">
<div class="nav-header-title">
<h1><a href="index.html">Akka Persistence Cassandra</a></h1>
</div>
<div class="nav-header-version">
Version 0.104
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
</div>
</header>
<nav class="nav-toc">
<ul>
  <li><a href="overview.html" class="page">Overview</a></li>
  <li><a href="journal.html" class="page">Journal</a></li>
  <li><a href="read-journal.html" class="page">Query Plugin</a></li>
  <li><a href="events-by-tag.html#events-by-tag" class="active page">Events by tag</a>
  <ul>
    <li><a href="events-by-tag.html#consistency" class="header">Consistency</a></li>
    <li><a href="events-by-tag.html#back-tracking" class="header">Back tracking</a></li>
    <li><a href="events-by-tag.html#other-tuning" class="header">Other tuning</a></li>
    <li><a href="events-by-tag.html#how-it-works" class="header">How it works</a></li>
  </ul></li>
  <li><a href="snapshots.html" class="page">Snapshots</a></li>
  <li><a href="serialization.html" class="page">Serialization</a></li>
  <li><a href="scylladb.html" class="page">ScyllaDB</a></li>
  <li><a href="migrations.html" class="page">Migration</a></li>
</ul>
</nav>
</div>
</header>
<div class="site-content-wrapper">
<aside class="sticky-sidebar show-for-large">
<header class="nav-header sticky-sidebar-header">
<div class="nav-header-title">
<h1><a href="index.html">Akka Persistence Cassandra</a></h1>
</div>
<div class="nav-header-version">
Version 0.104
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
</div>
</header>
<nav class="site-nav sticky-sidebar-contents">
<div class="nav-toc">
<ul>
  <li><a href="overview.html" class="page">Overview</a></li>
  <li><a href="journal.html" class="page">Journal</a></li>
  <li><a href="read-journal.html" class="page">Query Plugin</a></li>
  <li><a href="events-by-tag.html#events-by-tag" class="active page">Events by tag</a>
  <ul>
    <li><a href="events-by-tag.html#consistency" class="header">Consistency</a></li>
    <li><a href="events-by-tag.html#back-tracking" class="header">Back tracking</a></li>
    <li><a href="events-by-tag.html#other-tuning" class="header">Other tuning</a></li>
    <li><a href="events-by-tag.html#how-it-works" class="header">How it works</a></li>
  </ul></li>
  <li><a href="snapshots.html" class="page">Snapshots</a></li>
  <li><a href="serialization.html" class="page">Serialization</a></li>
  <li><a href="scylladb.html" class="page">ScyllaDB</a></li>
  <li><a href="migrations.html" class="page">Migration</a></li>
</ul>
</div>
</nav>
<footer class="nav-footer sticky-sidebar-footer">
<a href="https://akka.io"><img class="logo" src="images/akka-logo-reverse.svg"/></a>

</footer>
</aside>
<main class="fixed-shift-for-large expanded row">
<section class="site-content small-12 column">
<article class="page-content row">
<div class="small-12 column" id="docs">
<h1><a href="#events-by-tag" name="events-by-tag" class="anchor"><span class="anchor-link"></span></a>Events by tag</h1>
<p>The events by tag query is implemented by writing the events to another table in Cassandra partitioned by tag as well as a timebucket to prevent partitions becoming to big.</p>
<p>Due to it being a separate table and events are written from multiple nodes the events by tag is eventually consistent.</p>
<h2><a href="#consistency" name="consistency" class="anchor"><span class="anchor-link"></span></a>Consistency</h2>
<p>Event by tag queries are eventually consistent, i.e. if a persist for an event has completed is does not guarantee that it will be visible immediately but it will eventually.</p>
<p>Order of the events is maintained per persistence id per tag by maintaining a sequence number for tagged events per persistence id. This is in addition to the normal sequence nr kept per persistence id. Events for the same persistence id will never be delivered out of order.</p>
<p>Events from different persistent IDs are ordered by a <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier">type 2 UUID a.k.a TimeUUID</a>, esposed in the <code>EventEnvelope</code> as a <code>TimeBasedUUID</code> offset.</p>
<p>As events come from multiple nodes to deliver events in <code>TimeUUID</code> order there is an <code>eventual-consistency-delay</code> to give events time to arrive in Cassandra and for the query to deliver them in their final order. The <code>eventual-consistency-delay</code> keeps the query a configurable amount of time in the past.</p>
<p>The events by tag stream updates the Cassandra query it uses to start from the latest offset to avoid reading events it has already delivered. If events are delayed and the query progresses past an event&rsquo;s offset it will be detected either when the next event for that persistence id is received or if no more events are received for the persistence id then it will be detected via <a href="#back-tracking">back tracking</a>. </p>
<p>In both cases the query will go back and search for the delayed events. The search for missing events is an expensive operation so it is advised not to set the <code>eventual-consistency-delay</code> too low as it increased the liklihood of missed events.</p>
<h2><a href="#back-tracking" name="back-tracking" class="anchor"><span class="anchor-link"></span></a>Back tracking</h2>
<p>If another event for the same persistence id is received the sequence number is used to detect that an event has been missed. To detect missed events without receiving another event for the same persistence id a periodic backtrack is done to find events. Queries are run in the background to detect delayed events. A high frequency short back track is done for finding events delayed a small amount and a low frequency backtrack that scans further back. </p>
<p>These are configured with <code>cassandra-query-journal.events-by-tag.back-track</code>:</p>
<pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/akka/akka-persistence-cassandra/tree/v0.104/core/src/main/resources/reference.conf#L707-L726" target="_blank" title="Go to snippet source"></a><code class="language-conf">back-track {
  # Interval at which events by tag stages trigger a query to look for delayed events from before the
  # current offset. Delayed events are also searched for when a subsequent event for the same persistence id
  # is received. The purpose of this back track is to find delayed events for persistence ids that are no
  # longer receiving events. Depending on the size of the period of the back track this can be expensive.
  interval = 1s

  # How far back to go in time for the scan. This is the maxinum amount of time an event can be delayed
  # and be found without receiving a new event for the same persistence id. Set to a duration or &quot;max&quot; to search back
  # to the start of the previous bucket which is the furthest a search can go back.
  period = 5s

  # at a less frequent interval for a longer back track is done to find any events that were delayed significantly
  long-interval = 120s

  # long-period can be max, off, or a duration where max is to the start of the previous bucket or cleanup-old-persistence-ids,
  # which ever is shorter. Back tracks can not be longer than the cleanup-old-persistence-ids otherwise old events
  # will be redelivered due to the metadat having been dropped
  long-period = &quot;max&quot;
}</code></pre>
<h3><a href="#tuning-for-lower-latency" name="tuning-for-lower-latency" class="anchor"><span class="anchor-link"></span></a>Tuning for lower latency</h3>
<p>The default <code>eventual-consistency-delay</code> is set to <code>5s</code> which is high as it is the safest. This can be set much lower for latency sensitive applications and missed events will be detected via the above mechanisms. The downside is that the search for missing events is an expensive operation and with a high eventual consistency delay it won&rsquo;t happen without exceptional delays. With a low value it will happen frequently.</p>
<p>Like with any tuning testing should be done to see what works for your environment. The values below may be too low depending on the load and performance of your Cassandra cluster.</p>
<h4><a href="#settings" name="settings" class="anchor"><span class="anchor-link"></span></a>Settings</h4>
<p>Flush the tag writes right away. By default they are batched and written as an unlogged back which increases throughput. To write each individually without delay use:</p>
<pre><code>cassandra-journal.events-by-tag.flush-interval = 0s
</code></pre>
<p>Alternatively set a very small value e.g. <code>25ms</code> so some batching is done. If your applicaion has a large number of tagged events per second it is highly advised to set this to a value above 0.</p>
<p>Enable pub sub notifications so events by tag queries can execute a query right away rather than waiting for the next <code>refresh-interval</code>. Lower the <code>refresh-interval</code> for cases where the pub sub messages take a long time to arrive at the query.</p>
<pre><code>cassandra-journal.pubsub-notification = on
cassandra-query-journal.refresh-interval = 2s
</code></pre>
<p>Reduce <code>eventual-consistency-delay</code>. You must test this has positive results for your use case. Setting this too low can decrease throughput and latency as more events will be missed initially and expensive searches carried out.</p>
<pre><code>cassandra-query-journal.events-by-tag.eventual-consistency-delay = 50ms
</code></pre>
<p>When no offset is provided EventsByTag queries start at the configured <code>first-time-bucket</code>. For new applications increase this to the day your application is initially deployed to speed to <code>NoOffset</code> queries.</p>
<h3><a href="#missing-searches-and-gap-detection" name="missing-searches-and-gap-detection" class="anchor"><span class="anchor-link"></span></a>Missing searches and gap detection</h3>
<p>If a gap is detected then the event is held back and the stream goes into a searching mode for the missing events. The search only looks in the current bucket and the previous one. If the event is older then it won&rsquo;t be found in this search.</p>
<p>If the missing event is not found then the stream is failed unless it is the first time the persistence id has been encountered by the query.</p>
<h3><a href="#gap-detection-when-encountering-a-persistence-id-for-the-first-time" name="gap-detection-when-encountering-a-persistence-id-for-the-first-time" class="anchor"><span class="anchor-link"></span></a>Gap detection when encountering a persistence id for the first time</h3>
<p>When receiving the first event for a given persistence id in an offset query it is not known if that is actually the first event. If the offset query starts in a time bucket in the past then it is assumed to be the first. </p>
<p>If the query is started with an offset in the current time bucket then the query starts with a search to look for the lowest sequence number per persistenceId before delivering any events.</p>
<p>The above scanning only looks in the current time bucket. For persistence ids that aren&rsquo;t found in this initial scan because they don&rsquo;t have any events in the current time bucket then the expected tag pid sequence number is not known. In this case the eventsByTag query searches for <code>new-persistence-id-scan-timeout</code> before assuming this is the first event for that persistence id. </p>
<p>This adds a delay each time a new persistence id is found by an offset query when the first event doesn&rsquo;t have a sequenceNr of <code>1</code>. If this is an issue it can be set to 0s. If events are found out of order due to this the stage will fail. </p>
<h2><a href="#other-tuning" name="other-tuning" class="anchor"><span class="anchor-link"></span></a>Other tuning</h2>
<h3><a href="#setting-a-bucket-size" name="setting-a-bucket-size" class="anchor"><span class="anchor-link"></span></a>Setting a bucket size</h3>
<p>Events by tag partitions are grouped into buckets to avoid a single partition for a tag getting to large. </p>
<ul>
  <li>1000s of events per day per tag &ndash; Day</li>
  <li>100,000s of events per day per tag &ndash; Hour</li>
  <li>1,000,000s of events per day per tag &ndash; Minute</li>
</ul>
<p>The default is <code>Hour</code> and can be overridden by setting <code>cassandra-journal.events-by-tag.bucket-size</code>. This setting can not be changed after data has been written.</p>
<p>More billion per day per tag? You probably need a specialised schema rather than a general library like this.</p>
<p>If a cassandra partition gets too large it will perform badly (and has a hard limit of 2 billion cells, a cell being similar to a column). Given there is ~10 columns in the table there was a hard limit previously of 200million but performance would degrade before reaching this. </p>
<p>The support for <code>Minute</code> bucket size means that there are 1440 partitions per day. Given a large C* cluster this should work until you have in the order of 10s of millions per minute when the write rate to that partition would likely become the bottleneck rather than partition size.</p>
<p>The increased scalability comes at the cost of having to query more partitions on the read side so don&rsquo;t use <code>Minute</code> unless necessary.</p>
<h3><a href="#setting-a-write-batch-size" name="setting-a-write-batch-size" class="anchor"><span class="anchor-link"></span></a>Setting a write batch size</h3>
<p>The size of the of the batch is controlled via <code>max-message-batch-size</code>. Cassandra imposes a limit on the serialized size of a batch, currently 50kb by default. The larger this value the more efficient the tag writes will be but care must be taken not to have batches that will be rejected by Cassandra. Two other cases cause the batch to be written before the batch size is reached: * Periodically: By default 250ms. To prevent eventsByTag queries being too out of date. * When a starting a new timebucket, which translates to a new partition in Cassandra, the events for the old timebucket are written.</p>
<h2><a href="#how-it-works" name="how-it-works" class="anchor"><span class="anchor-link"></span></a>How it works</h2>
<p>The following section describes more about how the events by tag query work, it is not required knowledge for using it.</p>
<p>A separate table is maintained for events by tag queries to that is written to in batches.</p>
<p>The table is partitioned via tag and a time bucket. This allows events for the same tag can be queried and the time bucket prevents all events for the same tag being in a single partition.</p>
<p>The timebucket causes a hot spot for writes but this is kept to a minimum by making the bucket small enough and by batching the writes into unlogged batches.</p>
<p>Each events by tag query starts at the provided offset and queries the events. The stream will initially do a query per time bucket to get up to the current (many of these could be empty so very little over head, some may bring back many events). For example if you set the offset to be 30 days ago and a day time bucket, it will require 30 * nr queries to get each stream up to date. If a particular partition contains many events then it is paged back from Cassandra based on demand.</p>
<p>When no offset is provided EventsByTag queries start at the configured <code>first-time-bucket</code>. For new applications increase this to the day your application is initially deployed to speed up <code>NoOffset</code> queries.</p>
<h3><a href="#implementation" name="implementation" class="anchor"><span class="anchor-link"></span></a>Implementation</h3>
<p>A <code>TagWriter</code> actor is created, on demand, per tag that batches (unlogged batch grouped by the partition key) up writes to a separate table partitioned by tag name and a time bucket.</p>
<p>When a message is persisted, if it has tags, it is sent to each of the <code>TagWriter</code>s asynchronously.</p>
<p>This allows us to be more efficient and thus support more tags than the old version (limited to 3). No limit is imposed with new implementation but it is advised to keep it small i.e. less than 10.</p>
<h3><a href="#crash-recovery" name="crash-recovery" class="anchor"><span class="anchor-link"></span></a>Crash recovery</h3>
<p><code>TagWriter</code> maintains a separate table with how far it has gotten up to for each persistenceId.</p>
<pre><code>CREATE TABLE akka.tag_views_progress (                              
    peristence_id text,           
    tag text,                     
    sequence_nr bigint,           
    PRIMARY KEY (peristence_id, tag)                                
)
</code></pre>
<p>Part of recovery checks that all events have been written by the tag writer.</p>
<p>On the happy path this table will be written to after the tag_view write is complete so it could be lost in a crash. </p>
<h4><a href="#recovery-restart-scenarios" name="recovery-restart-scenarios" class="anchor"><span class="anchor-link"></span></a>Recovery/Restart scenarios</h4>
<p>On recovery the tag write progress for a given pid / tag is sent to the tag writer so that it bases its tag pid sequence nrs off the recovery. Following scenarios:</p>
<p>No event buffered in the tag writer. Tag write progress has been written. * Recovery will see that no events needs to be recovered</p>
<p>No events buffered in the tag writer. Tag write progress is lost. * Events will be in the <code>tag_views</code> table but not the <code>tag_write_progress</code>. * Tag write progress will be out of date * Events will be recovered and sent to the tag writer, should receive the same tag pid sequence nr and be upserted.</p>
<p>Events buffered in the tag writer. * Buffered events for the persistenceId should be dropped as if they are buffered the tag write progress won&rsquo;t have been saved as it happens after the write of the events to tag_views.</p>
<h3><a href="#deletion-of-events" name="deletion-of-events" class="anchor"><span class="anchor-link"></span></a>Deletion of events</h3>
<p><em>Deletes are not propagated to the events by tag table.</em></p>
<p>It is assumed that the eventsByTag query is used to populate a separate read view or events are never deleted.</p>
</div>
</article>
<div class="row">
<div class="small-12 column">
<section class="nav-prev-next row">
<div class="nav-prev small-6 column">
<a href="read-journal.html"><i class="icon-prev"></i> <span class="link-prev">Query Plugin</span></a>
</div>
<div class="nav-next small-6 column clearfix">
<a class="float-right" href="snapshots.html">Snapshots <i class="icon-next"></i></a>
</div>
</section>
</div>
</div>
<div class="source-github row">
Found an error in this documentation? The source code for this page can be found <a href="https://github.com/akka/akka-persistence-cassandra/tree/v0.104/docs/src/main/paradox/events-by-tag.md">here</a>.
Please feel free to edit and contribute a pull request.
</div>

<footer class="page-footer row clearfix">
<img class="akka-icon float-left show-for-medium" src="images/akka-icon.svg" />
<section class="copyright">
<div>Akka Persistence Cassandra is Open Source and available under the Apache 2 License.</div>
<p class="legal">
&copy; 2011-2020 <a href="https://www.lightbend.com" target="_blank">Lightbend, Inc.</a> |
<a href="https://www.lightbend.com/legal/licenses" target="_blank">Licenses</a> |
<a href="https://www.lightbend.com/legal/terms" target="_blank">Terms</a> |
<a href="https://www.lightbend.com/legal/privacy" target="_blank">Privacy Policy</a> |
<a href="https://akka.io/cookie/" target="_blank">Cookie Listing</a> |
<a class="optanon-toggle-display">Cookie Settings</a>
</p>
</section>

</footer>
</section>
</main>
</div>

<script type="text/javascript" src="js/scrollsneak.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="js/groups.js"></script>
<script type="text/javascript" src="js/page.js"></script>
<script type="text/javascript" src="js/magellan.js"></script>
<script type="text/javascript" src="js/metadata-toggle.js"></script>

<style type="text/css">@import "lib/prettify/prettify.css";</style>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(){window.prettyPrint && prettyPrint()});
//]]></script>
<script type="text/javascript" src="assets/js/warnOldVersion.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(jq){initOldVersionWarnings(jq, '0.104', 'https://doc.akka.io/docs/akka-persistence-cassandra/current/')});
//]]></script>


</body>
</html>
