<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Testing &bull; Akka Projection</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="Akka Projection."/>
<link rel="canonical" href="https://doc.akka.io/docs/akka-projection/current/testing.html"/>
<script type="text/javascript" src="lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="lib/foundation/dist/js/foundation.min.js"></script>
<link rel="stylesheet" type="text/css" href="lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="lib/foundation/dist/css/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<link rel="stylesheet" type="text/css" href="css/icons.css"/>
<link rel="stylesheet" type="text/css" href="css/page-8.css"/>
<link rel="stylesheet" type="text/css" href="css/banner-1.css"/>
<link rel="shortcut icon" href="images/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png"/>
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png"/>
<link rel="manifest" href="images/manifest.json"/>
<meta name="msapplication-TileImage" content="images/mstile-150x150.png"/>
<meta name="msapplication-TileColor" content="#15a9ce"/>
<meta name="theme-color" content="#15a9ce"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) start -->
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js"  type="text/javascript" charset="UTF-8" data-domain-script="28b912e7-09e9-43d5-91e4-3d1897044004" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) end -->
<!--Google Analytics-->
<script type="text/plain" class="optanon-category-2">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', '']);
_gaq.push(['_setDomainName', '']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})()
</script>
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-2">
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KBJGH35');
</script>
<!--Marketo-->
<script type="text/plain" class="optanon-category-3">
(function() {
var didInit = false;
function initMunchkin() {
if(didInit === false) {
didInit = true;
Munchkin.init('558-NCX-702', { 'asyncOnly': true, 'disableClickDelay': true });
}
}
var s = document.createElement('script');
s.type = 'text/javascript';
s.async = true;
s.src = '//munchkin.marketo.net/munchkin.js';
s.onreadystatechange = function() {
if (this.readyState == 'complete' || this.readyState == 'loaded') {
initMunchkin();
}
};
s.onload = initMunchkin;
document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
</head>

<body id="underlay" data-toggler="nav-open">
<div id="lightbend-banner" class="lightbend-banner akka full-width" data-category="OSS Lightbend Banner Impression" data-label="Akka Banner Impression">
<div class="wrapper">
<div class="brand">
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Lightbend Logo - Akka Banner" href="https://www.lightbend.com?r=oss-banner-akka" target="_blank">
<img class="lightbend-logo" src="images/banner-logos/lightbend-reverse.svg" alt="Lightbend" title="Lightbend">
</a>
</div>
<div class="nav">
<a class="banner-btn oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Enhance your Akka systems with Akka Platform [Button] - Akka Banner" href="https://www.lightbend.com/akka-platform?r=oss-banner-akka" target="_blank">
<span>Enhance your Akka systems with</span>
<img class="akka-platform-reverse-logo" src="images/banner-logos/akka-platform-reverse.svg" alt="Akka Platform" title="Akka Platform">
</a>
<div class="drop-down">
<svg class="svg-chevon-circle-down" version="1.1" id="Chevron_circled_down" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
<path fill="#ffffff" d="M12.505,8.698L10,11L7.494,8.698c-0.198-0.196-0.518-0.196-0.718,0c-0.197,0.196-0.197,0.515,0,0.71l2.864,2.807
c0.199,0.196,0.52,0.196,0.717,0l2.864-2.807c0.199-0.195,0.198-0.514,0-0.71C13.024,8.502,12.704,8.502,12.505,8.698z M10,0.4
c-5.302,0-9.6,4.298-9.6,9.6c0,5.303,4.298,9.6,9.6,9.6s9.6-4.297,9.6-9.6C19.6,4.698,15.302,0.4,10,0.4z M10,18.354
c-4.615,0-8.354-3.74-8.354-8.354c0-4.614,3.739-8.354,8.354-8.354c4.613,0,8.354,3.74,8.354,8.354
C18.354,14.614,14.613,18.354,10,18.354z" />
</svg>
<div class="drop-down-content">
<div class="lightbend-family">
<a href="https://cloudflow.io" class="cloudflow oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Cloudflow - Logo Tag Line - Akka Banner">
<img class="cloudflow-full-color-logo" src="images/banner-logos/cloudflow-full-color.svg" alt="Cloudflow by Lightbend" title="Cloudflow by Lightbend">
</a>
<a href="https://cloudstate.io" class="cloudstate oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Cloudstate - Logo Tag Line - Akka Banner">
<img class="cloudstate-full-color-logo" src="images/banner-logos/cloudstate-full-color.svg" alt="Cloudstate by Lightbend" title="Cloudstate by Lightbend">
</a>
<a href="https://www.lagomframework.com" class="lagom oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Lagom - Logo Tag Line - Akka Banner">
<img class="lagom-full-color-logo" src="images/banner-logos/lagom-full-color.svg" alt="Lagom Framework by Lightbend" title="Lagom Framework by Lightbend">
</a>
<a href="https://www.playframework.com" class="play oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Play - Logo Tag Line - Akka Banner">
<img class="play-full-color-logo" src="images/banner-logos/play-full-color.svg" alt="Play Framework by Lightbend" title="Play Framework by Lightbend">
</a>
<a href="https://www.scala-lang.org" class="scala oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Scala - Logo Tag Line - Akka Banner">
<img class="scala-full-color-logo" src="images/banner-logos/scala-full-color.svg" alt="Scala by Lightbend" title="Scala by Lightbend">
</a>
<div class="akka current">
<img class="akka-full-color-logo" src="images/banner-logos/akka-full-color.svg" alt="Akka by Lightbend" title="Akka by Lightbend">
<span>From the creators of <strong>Akka</strong>, get technology enhancements, monitoring, and expert support with Akka Platform from Lightbend.</span>
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Learn More [Button] - Akka Banner" href="https://www.lightbend.com/akka-platform?r=oss-banner-akka" target="_blank">Learn More</a>
</div>
</div>
<div class="title">The Lightbend Family</div>
</div>      
</div>
</div>
</div>
</div>

<header class="site-header hide-for-large">
<div class="sticky-header clearfix">
<a href="https://akka.io"><img class="logo" src="images/akka-logo-reverse.svg"/></a>

<button class="menu-icon float-right" type="button" data-toggle="underlay overlay"></button>
</div>
<div id="overlay" class="overlay-nav" data-toggler="nav-open">
<header class="nav-header">
<div class="nav-header-title">
<h1><a href="index.html">Akka Projection</a></h1>
</div>
<div class="nav-header-version">
Version 1.2.1
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
</div>
</header>
<nav class="nav-toc">
<ul>
  <li><a href="overview.html" class="page">Overview</a></li>
  <li><a href="use-cases.html" class="page">Use Cases</a></li>
  <li><a href="getting-started/index.html" class="page">Getting Started Guide</a></li>
  <li><a href="eventsourced.html" class="page">Events from Akka Persistence</a></li>
  <li><a href="kafka.html" class="page">Messages from and to Kafka</a></li>
  <li><a href="cassandra.html" class="page">Offset in Cassandra</a></li>
  <li><a href="jdbc.html" class="page">Offset in a relational DB with JDBC</a></li>
  <li><a href="slick.html" class="page">Offset in a relational DB with Slick</a></li>
  <li><a href="running.html" class="page">Running a Projection</a></li>
  <li><a href="actor.html" class="page">Processing with Actor</a></li>
  <li><a href="flow.html" class="page">Processing with Akka Streams</a></li>
  <li><a href="error.html" class="page">Error handling</a></li>
  <li><a href="projection-settings.html" class="page">Projection Settings</a></li>
  <li><a href="management.html" class="page">Management of a Projection</a></li>
  <li><a href="testing.html#testing" class="active page">Testing</a>
  <ul>
    <li><a href="testing.html#dependencies" class="header">Dependencies</a></li>
    <li><a href="testing.html#initializing-the-projection-testkit" class="header">Initializing the Projection TestKit</a></li>
    <li><a href="testing.html#testing-with-an-assert-function" class="header">Testing with an assert function</a></li>
    <li><a href="testing.html#testing-with-a-testsubscriber-probe" class="header">Testing with a TestSubscriber.Probe</a></li>
    <li><a href="testing.html#testing-with-mocked-projection-and-sourceprovider" class="header">Testing with mocked Projection and SourceProvider</a></li>
  </ul></li>
  <li><a href="classic.html" class="page">Akka Classic</a></li>
  <li><a href="snapshots.html" class="page">Snapshots</a></li>
</ul>
</nav>
</div>
</header>
<div class="site-content-wrapper">
<aside class="sticky-sidebar show-for-large">
<header class="nav-header sticky-sidebar-header">
<div class="nav-header-title">
<h1><a href="index.html">Akka Projection</a></h1>
</div>
<div class="nav-header-version">
Version 1.2.1
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
</div>
</header>
<nav class="site-nav sticky-sidebar-contents">
<div class="nav-toc">
<ul>
  <li><a href="overview.html" class="page">Overview</a></li>
  <li><a href="use-cases.html" class="page">Use Cases</a></li>
  <li><a href="getting-started/index.html" class="page">Getting Started Guide</a></li>
  <li><a href="eventsourced.html" class="page">Events from Akka Persistence</a></li>
  <li><a href="kafka.html" class="page">Messages from and to Kafka</a></li>
  <li><a href="cassandra.html" class="page">Offset in Cassandra</a></li>
  <li><a href="jdbc.html" class="page">Offset in a relational DB with JDBC</a></li>
  <li><a href="slick.html" class="page">Offset in a relational DB with Slick</a></li>
  <li><a href="running.html" class="page">Running a Projection</a></li>
  <li><a href="actor.html" class="page">Processing with Actor</a></li>
  <li><a href="flow.html" class="page">Processing with Akka Streams</a></li>
  <li><a href="error.html" class="page">Error handling</a></li>
  <li><a href="projection-settings.html" class="page">Projection Settings</a></li>
  <li><a href="management.html" class="page">Management of a Projection</a></li>
  <li><a href="testing.html#testing" class="active page">Testing</a>
  <ul>
    <li><a href="testing.html#dependencies" class="header">Dependencies</a></li>
    <li><a href="testing.html#initializing-the-projection-testkit" class="header">Initializing the Projection TestKit</a></li>
    <li><a href="testing.html#testing-with-an-assert-function" class="header">Testing with an assert function</a></li>
    <li><a href="testing.html#testing-with-a-testsubscriber-probe" class="header">Testing with a TestSubscriber.Probe</a></li>
    <li><a href="testing.html#testing-with-mocked-projection-and-sourceprovider" class="header">Testing with mocked Projection and SourceProvider</a></li>
  </ul></li>
  <li><a href="classic.html" class="page">Akka Classic</a></li>
  <li><a href="snapshots.html" class="page">Snapshots</a></li>
</ul>
</div>
</nav>
<footer class="nav-footer sticky-sidebar-footer">
<a href="https://akka.io"><img class="logo" src="images/akka-logo-reverse.svg"/></a>

</footer>
</aside>
<main class="fixed-shift-for-large expanded row">
<section class="site-content small-12 column">
<article class="page-content row">
<div class="small-12 column" id="docs">
<h1><a href="#testing" name="testing" class="anchor"><span class="anchor-link"></span></a>Testing</h1>
<p>Akka Projections provides a TestKit to ease testing. There are two supported styles of test: running with an assert function and driving it with an Akka Streams TestKit <code>TestSubscriber.Probe</code>.</p>
<h2><a href="#dependencies" name="dependencies" class="anchor"><span class="anchor-link"></span></a>Dependencies</h2>
<p>To use the Akka Projections TestKit add the following dependency in your project:</p><dl class="dependency"><dt>sbt</dt><dd><pre class="prettyprint"><code class="language-scala">libraryDependencies += "com.lightbend.akka" %% "akka-projection-testkit" % "1.2.1" % Test</code></pre></dd><dt>Maven</dt><dd><pre class="prettyprint"><code class="language-xml">&lt;properties&gt;
  &lt;scala.binary.version&gt;2.13&lt;/scala.binary.version&gt;
&lt;/properties&gt;
&lt;dependencies&gt
  &lt;dependency&gt;
    &lt;groupId&gt;com.lightbend.akka&lt;/groupId&gt;
    &lt;artifactId&gt;akka-projection-testkit_${scala.binary.version}&lt;/artifactId&gt;
    &lt;version&gt;1.2.1&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
  &lt;/dependency&gt
&lt;/dependencies&gt;</code></pre></dd><dt>Gradle</dt><dd><pre class="prettyprint"><code class="language-gradle">def versions = [
  ScalaBinary: "2.13"
]
dependencies {
  testImplementation "com.lightbend.akka:akka-projection-testkit_${versions.ScalaBinary}:1.2.1"
}</code></pre></dd></dl>
<p>Akka Projections require Akka 2.6.14 or later, see <a href="overview.html#akka-version">Akka version</a>.</p>
<table class="project-info">
<tr><th colspan="2">Project Info: Akka Projections TestKit</th></tr>
  <tr><th>Artifact</th><td><div>com.lightbend.akka</div>
  <div>akka-projection-testkit</div>
  <div>1.2.1</div>
  <div><a href="snapshots.html">Snapshots are available</a></div>
  </td></tr>
  <tr><th>JDK versions</th><td><div>AdoptOpenJDK 8</div><div>AdoptOpenJDK 11</div></td></tr>
  <tr><th>Scala versions</th><td>2.13.3, 2.12.13</td></tr>
  <tr><th>JPMS module name</th><td>akka.projection.testkit</td></tr>
  <tr><th>License</th><td><div><a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="noopener noreferrer">Apache-2.0</a></div>
  </td></tr>
  <tr><th>Readiness level</th><td><div class="readiness-level"><a href="https://developer.lightbend.com/docs/introduction/getting-help/support-terminology.html#supported" target="_blank" rel="noopener">Supported</a>, <a href="https://www.lightbend.com/lightbend-subscription" target="_blank" rel="noopener">Lightbend Subscription</a> provides support</div>
  <div>Since 1.0.0, 2020-09-10</div>
  </td></tr>
  <tr><th>Home page</th><td><a href="https://akka.io">https://akka.io</a></td></tr>
  <tr><th>API documentation</th><td>
  <div><a href="https://doc.akka.io/api/akka-projection/1.2.1/akka/projection/" target="_blank" rel="noopener noreferrer">API (Scaladoc)</a></div>
  </td></tr>
  <tr><th>Forums</th><td>
  <div><a href="https://discuss.lightbend.com/c/akka/" target="_blank" rel="noopener noreferrer">Lightbend Discuss</a></div>
  <div><a href="https://gitter.im/akka/akka" target="_blank" rel="noopener noreferrer">akka/akka Gitter channel</a></div>
  </td></tr>
  <tr><th>Release notes</th><td><a href="https://github.com/akka/akka-projection/releases" target="_blank" rel="noopener noreferrer">GitHub releases</a></td></tr>
  <tr><th>Issues</th><td><a href="https://github.com/akka/akka-projection/issues" target="_blank" rel="noopener noreferrer">GitHub issues</a></td></tr>
  <tr><th>Sources</th><td><a href="https://github.com/akka/akka-projection" target="_blank" rel="noopener noreferrer">https://github.com/akka/akka-projection</a></td></tr>
</table>

<h3><a href="#transitive-dependencies" name="transitive-dependencies" class="anchor"><span class="anchor-link"></span></a>Transitive dependencies</h3>

<p>The table below shows <code>akka-projection-testkit</code>&rsquo;s direct dependencies and the second tab shows all libraries it depends on transitively.</p>

<dl class="dependencies"><dt>Direct dependencies</dt><dd><table>
  <thead><tr><th>Organization</th><th>Artifact</th><th>Version</th></thead>
  <tbody>
    <tr><td>com.lightbend.akka</td><td>akka-projection-core_2.13</td><td><a href="https://mvnrepository.com/artifact/com.lightbend.akka/akka-projection-core_2.13/1.2.1" target="_blank">1.2.1</a></td></tr>
    <tr><td>com.typesafe.akka</td><td>akka-actor-testkit-typed_2.13</td><td><a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor-testkit-typed_2.13/2.6.14" target="_blank">2.6.14</a></td></tr>
    <tr><td>com.typesafe.akka</td><td>akka-stream-testkit_2.13</td><td><a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream-testkit_2.13/2.6.14" target="_blank">2.6.14</a></td></tr>
    <tr><td>org.scala-lang</td><td>scala-library</td><td><a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a></td></tr>
  </tbody>
</table></dd>
<dt>Dependency tree</dt><dd><pre>
com.lightbend.akka    akka-projection-core_2.13    <a href="https://mvnrepository.com/artifact/com.lightbend.akka/akka-projection-core_2.13/1.2.1" target="_blank">1.2.1</a>
    com.typesafe.akka    akka-actor-typed_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor-typed_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
        com.typesafe.akka    akka-actor_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
            com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
            org.scala-lang.modules    scala-java8-compat_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.13/0.9.0" target="_blank">0.9.0</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        com.typesafe.akka    akka-slf4j_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-slf4j_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
            com.typesafe.akka    akka-actor_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
                com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
                org.scala-lang.modules    scala-java8-compat_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.13/0.9.0" target="_blank">0.9.0</a>    Apache-2.0
                    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.slf4j    slf4j-api    <a href="https://mvnrepository.com/artifact/org.slf4j/slf4j-api/1.7.30" target="_blank">1.7.30</a>
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        org.slf4j    slf4j-api    <a href="https://mvnrepository.com/artifact/org.slf4j/slf4j-api/1.7.30" target="_blank">1.7.30</a>
    com.typesafe.akka    akka-persistence-query_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-persistence-query_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
        com.typesafe.akka    akka-persistence_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-persistence_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
            com.typesafe.akka    akka-actor_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
                com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
                org.scala-lang.modules    scala-java8-compat_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.13/0.9.0" target="_blank">0.9.0</a>    Apache-2.0
                    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            com.typesafe.akka    akka-stream_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
                com.typesafe.akka    akka-actor_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
                    com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
                    org.scala-lang.modules    scala-java8-compat_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.13/0.9.0" target="_blank">0.9.0</a>    Apache-2.0
                        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
                    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
                com.typesafe.akka    akka-protobuf-v3_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-protobuf-v3_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
                com.typesafe    ssl-config-core_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe/ssl-config-core_2.13/0.4.2" target="_blank">0.4.2</a>    Apache-2.0
                    com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
                    org.scala-lang.modules    scala-parser-combinators_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-parser-combinators_2.13/1.1.2" target="_blank">1.1.2</a>    Apache-2.0
                        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
                    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
                org.reactivestreams    reactive-streams    <a href="https://mvnrepository.com/artifact/org.reactivestreams/reactive-streams/1.0.3" target="_blank">1.0.3</a>    CC0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        com.typesafe.akka    akka-stream_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
            com.typesafe.akka    akka-actor_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
                com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
                org.scala-lang.modules    scala-java8-compat_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.13/0.9.0" target="_blank">0.9.0</a>    Apache-2.0
                    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            com.typesafe.akka    akka-protobuf-v3_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-protobuf-v3_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
            com.typesafe    ssl-config-core_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe/ssl-config-core_2.13/0.4.2" target="_blank">0.4.2</a>    Apache-2.0
                com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
                org.scala-lang.modules    scala-parser-combinators_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-parser-combinators_2.13/1.1.2" target="_blank">1.1.2</a>    Apache-2.0
                    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.reactivestreams    reactive-streams    <a href="https://mvnrepository.com/artifact/org.reactivestreams/reactive-streams/1.0.3" target="_blank">1.0.3</a>    CC0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
    com.typesafe.akka    akka-protobuf-v3_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-protobuf-v3_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
    com.typesafe.akka    akka-stream_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
        com.typesafe.akka    akka-actor_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
            com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
            org.scala-lang.modules    scala-java8-compat_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.13/0.9.0" target="_blank">0.9.0</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        com.typesafe.akka    akka-protobuf-v3_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-protobuf-v3_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
        com.typesafe    ssl-config-core_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe/ssl-config-core_2.13/0.4.2" target="_blank">0.4.2</a>    Apache-2.0
            com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
            org.scala-lang.modules    scala-parser-combinators_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-parser-combinators_2.13/1.1.2" target="_blank">1.1.2</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        org.reactivestreams    reactive-streams    <a href="https://mvnrepository.com/artifact/org.reactivestreams/reactive-streams/1.0.3" target="_blank">1.0.3</a>    CC0
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
com.typesafe.akka    akka-actor-testkit-typed_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor-testkit-typed_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
    com.typesafe.akka    akka-actor-typed_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor-typed_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
        com.typesafe.akka    akka-actor_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
            com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
            org.scala-lang.modules    scala-java8-compat_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.13/0.9.0" target="_blank">0.9.0</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        com.typesafe.akka    akka-slf4j_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-slf4j_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
            com.typesafe.akka    akka-actor_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
                com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
                org.scala-lang.modules    scala-java8-compat_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.13/0.9.0" target="_blank">0.9.0</a>    Apache-2.0
                    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.slf4j    slf4j-api    <a href="https://mvnrepository.com/artifact/org.slf4j/slf4j-api/1.7.30" target="_blank">1.7.30</a>
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        org.slf4j    slf4j-api    <a href="https://mvnrepository.com/artifact/org.slf4j/slf4j-api/1.7.30" target="_blank">1.7.30</a>
    com.typesafe.akka    akka-slf4j_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-slf4j_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
        com.typesafe.akka    akka-actor_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
            com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
            org.scala-lang.modules    scala-java8-compat_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.13/0.9.0" target="_blank">0.9.0</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        org.slf4j    slf4j-api    <a href="https://mvnrepository.com/artifact/org.slf4j/slf4j-api/1.7.30" target="_blank">1.7.30</a>
    com.typesafe.akka    akka-testkit_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-testkit_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
        com.typesafe.akka    akka-actor_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
            com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
            org.scala-lang.modules    scala-java8-compat_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.13/0.9.0" target="_blank">0.9.0</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
com.typesafe.akka    akka-stream-testkit_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream-testkit_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
    com.typesafe.akka    akka-stream_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
        com.typesafe.akka    akka-actor_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
            com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
            org.scala-lang.modules    scala-java8-compat_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.13/0.9.0" target="_blank">0.9.0</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        com.typesafe.akka    akka-protobuf-v3_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-protobuf-v3_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
        com.typesafe    ssl-config-core_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe/ssl-config-core_2.13/0.4.2" target="_blank">0.4.2</a>    Apache-2.0
            com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
            org.scala-lang.modules    scala-parser-combinators_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-parser-combinators_2.13/1.1.2" target="_blank">1.1.2</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        org.reactivestreams    reactive-streams    <a href="https://mvnrepository.com/artifact/org.reactivestreams/reactive-streams/1.0.3" target="_blank">1.0.3</a>    CC0
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
    com.typesafe.akka    akka-testkit_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-testkit_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
        com.typesafe.akka    akka-actor_2.13    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.13/2.6.14" target="_blank">2.6.14</a>    Apache-2.0
            com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.0" target="_blank">1.4.0</a>    Apache-2.0
            org.scala-lang.modules    scala-java8-compat_2.13    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.13/0.9.0" target="_blank">0.9.0</a>    Apache-2.0
                org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0
org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.13.3" target="_blank">2.13.3</a>    Apache-2.0</pre></dd>
</dl>

<h2><a href="#initializing-the-projection-testkit" name="initializing-the-projection-testkit" class="anchor"><span class="anchor-link"></span></a>Initializing the Projection TestKit</h2>

<p>The Projection TestKit requires an instance of <code>ActorTestKit</code>. We recommend using Akka&rsquo;s <span class="group-scala"><code>ScalaTestWithActorTestKit</code></span><span class="group-java"><code>TestKitJunitResource</code></span></p>

<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-projection/tree/v1.2.1/examples/src/test/scala/docs/testkit/TestKitDocExample.scala#L16-L18" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import akka.actor.testkit.typed.scaladsl.ScalaTestWithActorTestKit
import akka.projection.testkit.scaladsl.ProjectionTestKit

class TestKitDocExample extends ScalaTestWithActorTestKit {
  private val projectionTestKit = ProjectionTestKit(system)

}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-projection/tree/v1.2.1/examples/src/test/java/jdocs/testkit/TestKitDocExample.java#L18-L22" target="_blank" title="Go to snippet source">source</a><code class="language-java">import akka.projection.testkit.javadsl.TestSourceProvider;
import org.junit.ClassRule;
import akka.actor.testkit.typed.javadsl.TestKitJunitResource;
import akka.projection.testkit.javadsl.ProjectionTestKit;

@ClassRule static final TestKitJunitResource testKit = new TestKitJunitResource();
ProjectionTestKit projectionTestKit = ProjectionTestKit.create(testKit.system());</code></pre></dd>
</dl>
<h2><a href="#testing-with-an-assert-function" name="testing-with-an-assert-function" class="anchor"><span class="anchor-link"></span></a>Testing with an assert function</h2>
<p>When testing with an assert function the Projection is started and stopped by the TestKit. While the projection is running, the assert function will be called until it completes without errors (no exceptions or assertion errors are thrown).</p>
<p>In the example below the Projection will update a <code>CartView</code>. The test will run until it observes that the <code>CartView</code> for id <code>abc-def</code> is available in the repository. </p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-projection/tree/v1.2.1/examples/src/test/scala/docs/testkit/TestKitDocExample.scala#L16-L18" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import akka.actor.testkit.typed.scaladsl.ScalaTestWithActorTestKit
import akka.projection.testkit.scaladsl.ProjectionTestKit

projectionTestKit.run(projection) {
  // confirm that cart checkout was inserted in db
  cartViewRepository.findById(&quot;abc-def&quot;).futureValue
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-projection/tree/v1.2.1/examples/src/test/java/jdocs/testkit/TestKitDocExample.java#L74-L80" target="_blank" title="Go to snippet source">source</a><code class="language-java">projectionTestKit.run(
    projection,
    () -&gt;
        cartCheckoutRepository
            .findById(&quot;abc-def&quot;)
            .toCompletableFuture()
            .get(1, TimeUnit.SECONDS));</code></pre></dd>
</dl>
<p>By default, the test will run for 3 seconds. The assert function will be called every 100 milliseconds. Those values can be modified programatically.</p>
<p>Note: when testing a Projection with this method, the Restart Backoff is disabled. Any backoff configuration settings from <code>.conf</code> file or programmatically added will be overwritten.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-projection/tree/v1.2.1/examples/src/test/scala/docs/testkit/TestKitDocExample.scala#L22-L23" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import scala.concurrent.duration._

projectionTestKit.run(projection, max = 5.seconds, interval = 300.millis) {
  // confirm that cart checkout was inserted in db
  cartViewRepository.findById(&quot;abc-def&quot;).futureValue
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-projection/tree/v1.2.1/examples/src/test/java/jdocs/testkit/TestKitDocExample.java#L26-L31" target="_blank" title="Go to snippet source">source</a><code class="language-java">import java.time.Duration;
import java.util.concurrent.TimeUnit;
import java.util.function.Function;
import java.util.stream.Collectors;
import java.util.stream.Stream;

projectionTestKit.run(
    projection,
    Duration.ofSeconds(5),
    Duration.ofMillis(300),
    () -&gt;
        cartCheckoutRepository
            .findById(&quot;abc-def&quot;)
            .toCompletableFuture()
            .get(1, TimeUnit.SECONDS));</code></pre></dd>
</dl>
<h2><a href="#testing-with-a-testsubscriber-probe" name="testing-with-a-testsubscriber-probe" class="anchor"><span class="anchor-link"></span></a>Testing with a TestSubscriber.Probe</h2>
<p>The <a href="https://doc.akka.io/docs/akka/current/stream/stream-testkit.html#using-the-testkit">Akka Stream TestKit</a> can be used to drive the pace of envelopes flowing through the Projection.</p>
<p>The Projection starts as soon as the first element is requested by the <code>TestSubscriber.Probe</code>, new elements will be emitted as requested. The Projection is stopped once the assert function completes.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-projection/tree/v1.2.1/examples/src/test/scala/docs/testkit/TestKitDocExample.scala#L70-L77" target="_blank" title="Go to snippet source">source</a><code class="language-scala">projectionTestKit.runWithTestSink(projection) { sinkProbe =&gt;
  sinkProbe.request(1)
  sinkProbe.expectNext(Done)
}

// confirm that cart checkout was inserted in db
cartViewRepository.findById(&quot;abc-def&quot;).futureValue
</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-projection/tree/v1.2.1/examples/src/test/java/jdocs/testkit/TestKitDocExample.java#L35-L36" target="_blank" title="Go to snippet source">source</a><code class="language-java">import static org.junit.Assert.assertEquals;

projectionTestKit.runWithTestSink(
    projection,
    sinkProbe -&gt; {
      sinkProbe.request(1);
      sinkProbe.expectNext(Done.getInstance());
      cartCheckoutRepository.findById(&quot;abc-def&quot;).toCompletableFuture().get(1, TimeUnit.SECONDS);
    });
</code></pre></dd>
</dl>
<h2><a href="#testing-with-mocked-projection-and-sourceprovider" name="testing-with-mocked-projection-and-sourceprovider" class="anchor"><span class="anchor-link"></span></a>Testing with mocked Projection and SourceProvider</h2>
<p>To test a handler in isolation you may want to mock out the implementation of a Projection or SourceProvider so that you don&rsquo;t have to setup and teardown the associated technology as part of your <em>integration</em> test. For example, you may want to project against a Cassandra database, or read envelopes from an Akka Persistence journal source, but you don&rsquo;t want to have to run Docker containers or embedded/in-memory services just to run your tests. The <span class="group-java"><a href="/api/akka-projection/1.2.1/akka/projection/testkit/javadsl/TestProjection.html" title="akka.projection.testkit.javadsl.TestProjection"><code>TestProjection</code></a></span><span class="group-scala"><a href="/api/akka-projection/1.2.1/akka/projection/testkit/scaladsl/TestProjection.html" title="akka.projection.testkit.scaladsl.TestProjection"><code>TestProjection</code></a></span> allows you to isolate the runtime of your handler so that you don&rsquo;t need to run these services. Using a <code>TestProjection</code> has the added benefit of being fast, since you can run everything within the JVM that runs your tests.</p>
<p>Alongside the <code>TestProjection</code> is the <span class="group-java"><a href="/api/akka-projection/1.2.1/akka/projection/testkit/javadsl/TestSourceProvider.html" title="akka.projection.testkit.javadsl.TestSourceProvider"><code>TestSourceProvider</code></a></span><span class="group-scala"><a href="/api/akka-projection/1.2.1/akka/projection/testkit/scaladsl/TestSourceProvider.html" title="akka.projection.testkit.scaladsl.TestSourceProvider"><code>TestSourceProvider</code></a></span> which can be used to provide test data to the <code>TestProjection</code> running the handler. Test data can be represented in an akka streams <span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/stream/javadsl/Source.html" title="akka.stream.javadsl.Source"><code>Source</code></a></span><span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/stream/scaladsl/Source.html" title="akka.stream.scaladsl.Source"><code>Source</code></a></span> that is passed to the <code>TestSourceProvider</code> constructor.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-projection/tree/v1.2.1/examples/src/test/scala/docs/testkit/TestKitDocExample.scala#L27-L94" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import akka.stream.scaladsl.Source

val testData = Source((0, &quot;abc&quot;) :: (1, &quot;def&quot;) :: Nil)

val extractOffset = (envelope: (Int, String)) =&gt; envelope._1

val sourceProvider = TestSourceProvider(testData, extractOffset)

val projection = TestProjection(ProjectionId(&quot;test&quot;, &quot;00&quot;), sourceProvider, () =&gt; handler)

projectionTestKit.run(projection) {
  // assert logic ..
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-projection/tree/v1.2.1/examples/src/test/java/jdocs/testkit/TestKitDocExample.java#L40-L134" target="_blank" title="Go to snippet source">source</a><code class="language-java"><br/>import akka.japi.Pair;
import akka.stream.javadsl.Source;
import akka.projection.testkit.javadsl.TestProjection;

List&lt;Pair&lt;Integer, String&gt;&gt; testData =
    Stream.of(Pair.create(0, &quot;abc&quot;), Pair.create(1, &quot;def&quot;)).collect(Collectors.toList());

Source&lt;Pair&lt;Integer, String&gt;, NotUsed&gt; source = Source.from(testData);

Function&lt;Pair&lt;Integer, String&gt;, Integer&gt; extractOffsetFn =
    (Pair&lt;Integer, String&gt; env) -&gt; env.first();

TestSourceProvider&lt;Integer, Pair&lt;Integer, String&gt;&gt; sourceProvider =
    TestSourceProvider.create(source, extractOffsetFn);

Projection&lt;Pair&lt;Integer, String&gt;&gt; projection =
    TestProjection.create(ProjectionId.of(&quot;test&quot;, &quot;00&quot;), sourceProvider, () -&gt; handler);

projectionTestKit.run(
    projection,
    () -&gt; {
      // assert logic ...
    });</code></pre></dd>
</dl>
</div>
</article>
<div class="row">
<div class="small-12 column">
<section class="nav-prev-next row">
<div class="nav-prev small-6 column">
<a href="management.html"><i class="icon-prev"></i> <span class="link-prev">Management of a Projection</span></a>
</div>
<div class="nav-next small-6 column clearfix">
<a class="float-right" href="classic.html">Akka Classic <i class="icon-next"></i></a>
</div>
</section>
</div>
</div>
<div class="source-github row">
Found an error in this documentation? The source code for this page can be found <a href="https://github.com/akka/akka-projection/tree/v1.2.1/docs/src/main/paradox/testing.md">here</a>.
Please feel free to edit and contribute a pull request.
</div>

<footer class="page-footer row clearfix">
<img class="akka-icon float-left show-for-medium" src="images/akka-icon.svg" />
<section class="copyright">
<div>Akka Projections is Open Source and available under the Apache 2 License.</div>
<p class="legal">
&copy; 2011-2021 <a href="https://www.lightbend.com" target="_blank">Lightbend, Inc.</a> |
<a href="https://www.lightbend.com/legal/licenses" target="_blank">Licenses</a> |
<a href="https://www.lightbend.com/legal/terms" target="_blank">Terms</a> |
<a href="https://www.lightbend.com/legal/privacy" target="_blank">Privacy Policy</a> |
<a href="https://akka.io/cookie/" target="_blank">Cookie Listing</a> |
<a class="optanon-toggle-display">Cookie Settings</a>
</p>
</section>

</footer>
</section>
</main>
</div>

<script type="text/javascript" src="js/scrollsneak.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="js/groups.js"></script>
<script type="text/javascript" src="js/page.js"></script>
<script type="text/javascript" src="js/snippets.js"></script>
<script type="text/javascript" src="js/magellan.js"></script>
<script type="text/javascript" src="js/metadata-toggle.js"></script>

<style type="text/css">@import "lib/prettify/prettify.css";</style>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(){window.prettyPrint && prettyPrint()});
//]]></script>
<script type="text/javascript" src="assets/js/warnOldVersion.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(jq){initOldVersionWarnings(jq, '1.2.1', 'https://doc.akka.io/docs/akka-projection/current/')});
//]]></script>


</body>
</html>
