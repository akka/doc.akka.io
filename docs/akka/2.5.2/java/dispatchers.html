<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Dispatchers &bull; Akka Documentation</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="Akka is a toolkit for building highly concurrent, distributed, and resilient message-driven applications for Java and Scala."/>
<link rel="canonical" href="https://doc.akka.io/docs/akka/current/dispatchers.html"/>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../lib/foundation/dist/js/foundation.min.js"></script>
<link rel="stylesheet" type="text/css" href="../lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="../lib/foundation/dist/css/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<link rel="stylesheet" type="text/css" href="../css/icons.css"/>
<link rel="stylesheet" type="text/css" href="../css/page.css"/>
<link rel="shortcut icon" href="../images/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="../images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../images/favicon-16x16.png">
<link rel="manifest" href="../images/manifest.json">
<meta name="msapplication-TileImage" content="../images/mstile-150x150.png">
<meta name="msapplication-TileColor" content="#15a9ce">
<meta name="theme-color" content="#15a9ce">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!--Google Analytics-->
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-21117439-1']);
_gaq.push(['_setDomainName', 'akka.io']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})()
</script>
<!--Google Analytics & Marketo-->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-23127719-1', 'lightbend.com', {'allowLinker': true, 'name': 'tsTracker'});
ga('tsTracker.require', 'linker');
ga('tsTracker.linker:autoLink', ['lightbend.com','playframework.com','scala-lang.org','scaladays.org','spray.io','akka.io','scala-sbt.org','scala-ide.org']);
ga('tsTracker.send', 'pageview');
(function() {
var didInit = false;
function initMunchkin() {
if(didInit === false) {
didInit = true;
Munchkin.init('558-NCX-702');
}
}
var s = document.createElement('script');
s.type = 'text/javascript';
s.async = true;
s.src = '//munchkin.marketo.net/munchkin.js';
s.onreadystatechange = function() {
if (this.readyState == 'complete' || this.readyState == 'loaded') {
initMunchkin();
}
};
s.onload = initMunchkin;
document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>

</head>

<body id="underlay" data-toggler="nav-open">

<header class="site-header hide-for-large">
<div class="sticky-header clearfix">
<a href="https://akka.io"><img class="logo" src="../images/akka-logo-reverse.svg"></a>

<button class="menu-icon float-right" type="button" data-toggle="underlay overlay"></button>
</div>
<div id="overlay" class="overlay-nav" data-toggler="nav-open">
<header class="nav-header">
<div class="nav-header-title">
<h1><a href="../java/index.html">Akka Documentation</a></h1>
</div>
<div class="nav-header-version">
Version 2.5.2
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Languages"><option class="group" value="group-scala">Scala</option><option class="group" value="group-java">Java</option></select>
</div>
<div id="overlay-search-container" class="nav-header-search">
<input id="overlay-search" type="search" class="search" placeholder="Search"/>
</div>
</header>
<nav class="nav-toc">
<ul>
  <li><a href="../java/security/index.html" class="page">Security Announcements</a></li>
  <li><a href="../java/guide/index.html" class="page">Getting Started Guide</a></li>
  <li><a href="../java/general/index.html" class="page">General Concepts</a></li>
  <li><a href="../java/index-actors.html" class="page">Actors</a>
  <ul>
    <li><a href="../java/actors.html" class="page">Actors</a></li>
    <li><a href="../java/typed.html" class="page">Akka Typed</a></li>
    <li><a href="../java/fault-tolerance.html" class="page">Fault Tolerance</a></li>
    <li><a href="../java/dispatchers.html#dispatchers" class="active page">Dispatchers</a>
    <ul>
      <li><a href="../java/dispatchers.html#default-dispatcher" class="header">Default dispatcher</a></li>
      <li><a href="../java/dispatchers.html#looking-up-a-dispatcher" class="header">Looking up a Dispatcher</a></li>
      <li><a href="../java/dispatchers.html#setting-the-dispatcher-for-an-actor" class="header">Setting the dispatcher for an Actor</a></li>
      <li><a href="../java/dispatchers.html#types-of-dispatchers" class="header">Types of dispatchers</a></li>
    </ul></li>
    <li><a href="../java/mailboxes.html" class="page">Mailboxes</a></li>
    <li><a href="../java/routing.html" class="page">Routing</a></li>
    <li><a href="../java/fsm.html" class="page">FSM</a></li>
    <li><a href="../java/persistence.html" class="page">Persistence</a></li>
    <li><a href="../java/persistence-schema-evolution.html" class="page">Persistence - Schema Evolution</a></li>
    <li><a href="../java/persistence-query.html" class="page">Persistence Query</a></li>
    <li><a href="../java/persistence-query-leveldb.html" class="page">Persistence Query for LevelDB</a></li>
    <li><a href="../java/testing.html" class="page">Testing Actor Systems</a></li>
    <li><a href="../java/typed-actors.html" class="page">Typed Actors</a></li>
  </ul></li>
  <li><a href="../java/index-network.html" class="page">Networking</a></li>
  <li><a href="../java/stream/index.html" class="page">Streams</a></li>
  <li><a href="../java/index-futures.html" class="page">Futures and Agents</a></li>
  <li><a href="../java/index-utilities.html" class="page">Utilities</a></li>
  <li><a href="../java/common/other-modules.html" class="page">Other Akka modules</a></li>
  <li><a href="../java/howto.html" class="page">HowTo: Common Patterns</a></li>
  <li><a href="../java/scala-compat.html" class="page">Java 8 and Scala Compatibility</a></li>
  <li><a href="../java/project/index.html" class="page">Project Information</a></li>
  <li><a href="../java/additional/index.html" class="page">Additional Information</a></li>
</ul>
</nav>
</div>
</header>

<aside class="show-for-large">
<header class="nav-header fixed-sidebar-header">
<div class="nav-header-title">
<h1><a href="../java/index.html">Akka Documentation</a></h1>
</div>
<div class="nav-header-version">
Version 2.5.2
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Languages"><option class="group" value="group-scala">Scala</option><option class="group" value="group-java">Java</option></select>
</div>
<div class="nav-header-search">
<input id="search" type="search" class="search" placeholder="Search"/>
</div>
</header>
<nav class="site-nav fixed-sidebar-contents">
<div class="nav-toc">
<ul>
  <li><a href="../java/security/index.html" class="page">Security Announcements</a></li>
  <li><a href="../java/guide/index.html" class="page">Getting Started Guide</a></li>
  <li><a href="../java/general/index.html" class="page">General Concepts</a></li>
  <li><a href="../java/index-actors.html" class="page">Actors</a>
  <ul>
    <li><a href="../java/actors.html" class="page">Actors</a></li>
    <li><a href="../java/typed.html" class="page">Akka Typed</a></li>
    <li><a href="../java/fault-tolerance.html" class="page">Fault Tolerance</a></li>
    <li><a href="../java/dispatchers.html#dispatchers" class="active page">Dispatchers</a>
    <ul>
      <li><a href="../java/dispatchers.html#default-dispatcher" class="header">Default dispatcher</a></li>
      <li><a href="../java/dispatchers.html#looking-up-a-dispatcher" class="header">Looking up a Dispatcher</a></li>
      <li><a href="../java/dispatchers.html#setting-the-dispatcher-for-an-actor" class="header">Setting the dispatcher for an Actor</a></li>
      <li><a href="../java/dispatchers.html#types-of-dispatchers" class="header">Types of dispatchers</a></li>
    </ul></li>
    <li><a href="../java/mailboxes.html" class="page">Mailboxes</a></li>
    <li><a href="../java/routing.html" class="page">Routing</a></li>
    <li><a href="../java/fsm.html" class="page">FSM</a></li>
    <li><a href="../java/persistence.html" class="page">Persistence</a></li>
    <li><a href="../java/persistence-schema-evolution.html" class="page">Persistence - Schema Evolution</a></li>
    <li><a href="../java/persistence-query.html" class="page">Persistence Query</a></li>
    <li><a href="../java/persistence-query-leveldb.html" class="page">Persistence Query for LevelDB</a></li>
    <li><a href="../java/testing.html" class="page">Testing Actor Systems</a></li>
    <li><a href="../java/typed-actors.html" class="page">Typed Actors</a></li>
  </ul></li>
  <li><a href="../java/index-network.html" class="page">Networking</a></li>
  <li><a href="../java/stream/index.html" class="page">Streams</a></li>
  <li><a href="../java/index-futures.html" class="page">Futures and Agents</a></li>
  <li><a href="../java/index-utilities.html" class="page">Utilities</a></li>
  <li><a href="../java/common/other-modules.html" class="page">Other Akka modules</a></li>
  <li><a href="../java/howto.html" class="page">HowTo: Common Patterns</a></li>
  <li><a href="../java/scala-compat.html" class="page">Java 8 and Scala Compatibility</a></li>
  <li><a href="../java/project/index.html" class="page">Project Information</a></li>
  <li><a href="../java/additional/index.html" class="page">Additional Information</a></li>
</ul>
</div>
</nav>
<footer class="nav-footer fixed-sidebar-footer">
<a href="https://akka.io"><img class="logo" src="../images/akka-logo-reverse.svg"></a>

</footer>
</aside>

<main class="fixed-shift-for-large expanded row">
<section class="site-content small-12 column">

<article class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#dispatchers" name="dispatchers" class="anchor"><span class="anchor-link"></span></a>Dispatchers</h1>
<p>An Akka <code>MessageDispatcher</code> is what makes Akka Actors &ldquo;tick&rdquo;, it is the engine of the machine so to speak. All <code>MessageDispatcher</code> implementations are also an <code>ExecutionContext</code>, which means that they can be used to execute arbitrary code, for instance <a href="futures.html">Futures</a>.</p>
<h2><a href="#default-dispatcher" name="default-dispatcher" class="anchor"><span class="anchor-link"></span></a>Default dispatcher</h2>
<p>Every <code>ActorSystem</code> will have a default dispatcher that will be used in case nothing else is configured for an <code>Actor</code>. The default dispatcher can be configured, and is by default a <code>Dispatcher</code> with the specified <code>default-executor</code>. If an ActorSystem is created with an ExecutionContext passed in, this ExecutionContext will be used as the default executor for all dispatchers in this ActorSystem. If no ExecutionContext is given, it will fallback to the executor specified in <code>akka.actor.default-dispatcher.default-executor.fallback</code>. By default this is a &ldquo;fork-join-executor&rdquo;, which gives excellent performance in most cases.</p>
<a id="dispatcher-lookup"></a>
<h2><a href="#looking-up-a-dispatcher" name="looking-up-a-dispatcher" class="anchor"><span class="anchor-link"></span></a>Looking up a Dispatcher</h2>
<p>Dispatchers implement the <code>ExecutionContext</code> interface and can thus be used to run <code>Future</code> invocations etc.</p>
<pre class="prettyprint"><code class="language-java">// this is scala.concurrent.ExecutionContext
// for use with Futures, Scheduler, etc.
final ExecutionContext ex = system.dispatchers().lookup(&quot;my-dispatcher&quot;);</code></pre>
<h2><a href="#setting-the-dispatcher-for-an-actor" name="setting-the-dispatcher-for-an-actor" class="anchor"><span class="anchor-link"></span></a>Setting the dispatcher for an Actor</h2>
<p>So in case you want to give your <code>Actor</code> a different dispatcher than the default, you need to do two things, of which the first is is to configure the dispatcher:</p>
<pre class="prettyprint"><code class="language-scala">my-dispatcher {
  # Dispatcher is the name of the event-based dispatcher
  type = Dispatcher
  # What kind of ExecutionService to use
  executor = &quot;fork-join-executor&quot;
  # Configuration for the fork join pool
  fork-join-executor {
    # Min number of threads to cap factor-based parallelism number to
    parallelism-min = 2
    # Parallelism (threads) ... ceil(available processors * factor)
    parallelism-factor = 2.0
    # Max number of threads to cap factor-based parallelism number to
    parallelism-max = 10
  }
  # Throughput defines the maximum number of messages to be
  # processed per actor before the thread jumps to the next actor.
  # Set to 1 for as fair as possible.
  throughput = 100
}</code></pre><div class="callout note "><div class="callout-title">Note</div>
<p>Note that the <code>parallelism-max</code> does not set the upper bound on the total number of threads allocated by the ForkJoinPool. It is a setting specifically talking about the number of <em>hot</em> threads the pool keep running in order to reduce the latency of handling a new incoming task. You can read more about parallelism in the JDK&rsquo;s <a href="https://docs.oracle.com/javase/8/jdocs/api/java/util/concurrent/ForkJoinPool.html">ForkJoinPool documentation</a>.</p></div>
<p>Another example that uses the &ldquo;thread-pool-executor&rdquo;:</p>
<pre class="prettyprint"><code class="language-scala">blocking-io-dispatcher {
  type = Dispatcher
  executor = &quot;thread-pool-executor&quot;
  thread-pool-executor {
    fixed-pool-size = 32
  }
  throughput = 1
}</code></pre><div class="callout note "><div class="callout-title">Note</div>
<p>The thread pool executor dispatcher is implemented using by a <code>java.util.concurrent.ThreadPoolExecutor</code>. You can read more about it in the JDK&rsquo;s <a href="https://docs.oracle.com/javase/8/jdocs/api/java/util/concurrent/ThreadPoolExecutor.html">ThreadPoolExecutor documentation</a>.</p></div>
<p>For more options, see the default-dispatcher section of the <a href="general/configuration.html">configuration</a>.</p>
<p>Then you create the actor as usual and define the dispatcher in the deployment configuration.</p>
<pre class="prettyprint"><code class="language-java">ActorRef myActor =
  system.actorOf(Props.create(MyActor.class),
    &quot;myactor&quot;);</code></pre>
<pre class="prettyprint"><code class="language-scala">akka.actor.deployment {
  /myactor {
    dispatcher = my-dispatcher
  }
}</code></pre>
<p>An alternative to the deployment configuration is to define the dispatcher in code. If you define the <code>dispatcher</code> in the deployment configuration then this value will be used instead of programmatically provided parameter.</p>
<pre class="prettyprint"><code class="language-java">ActorRef myActor =
  system.actorOf(Props.create(MyActor.class).withDispatcher(&quot;my-dispatcher&quot;),
    &quot;myactor3&quot;);</code></pre><div class="callout note "><div class="callout-title">Note</div>
<p>The dispatcher you specify in <code>withDispatcher</code> and the <code>dispatcher</code> property in the deployment configuration is in fact a path into your configuration. So in this example it&rsquo;s a top-level section, but you could for instance put it as a sub-section, where you&rsquo;d use periods to denote sub-sections, like this: <code>&quot;foo.bar.my-dispatcher&quot;</code></p></div>
<h2><a href="#types-of-dispatchers" name="types-of-dispatchers" class="anchor"><span class="anchor-link"></span></a>Types of dispatchers</h2>
<p>There are 3 different types of message dispatchers:</p>
<ul>
  <li>
    <p><strong>Dispatcher</strong></p>
    <p>This is an event-based dispatcher that binds a set of Actors to a thread pool. It is the default dispatcher used if one is not specified.</p>
    <ul>
      <li>Sharability: Unlimited</li>
      <li>Mailboxes: Any, creates one per Actor</li>
      <li>Use cases: Default dispatcher, Bulkheading</li>
      <li>Driven by: <code>java.util.concurrent.ExecutorService</code>.  Specify using &ldquo;executor&rdquo; using &ldquo;fork-join-executor&rdquo;, &ldquo;thread-pool-executor&rdquo; or the FQCN of  an <code>akka.dispatcher.ExecutorServiceConfigurator</code>.</li>
    </ul>
  </li>
  <li>
    <p><strong>PinnedDispatcher</strong></p>
    <p>This dispatcher dedicates a unique thread for each actor using it; i.e. each actor will have its own thread pool with only one thread in the pool.</p>
    <ul>
      <li>Sharability: None</li>
      <li>Mailboxes: Any, creates one per Actor</li>
      <li>Use cases: Bulkheading</li>
      <li>Driven by: Any <code>akka.dispatch.ThreadPoolExecutorConfigurator</code>.  By default a &ldquo;thread-pool-executor&rdquo;.</li>
    </ul>
  </li>
  <li>
    <p><strong>CallingThreadDispatcher</strong></p>
    <p>This dispatcher runs invocations on the current thread only. This dispatcher does not create any new threads, but it can be used from different threads concurrently for the same actor. See <a href="testing.html#callingthreaddispatcher">CallingThreadDispatcher</a> for details and restrictions.</p>
    <ul>
      <li>Sharability: Unlimited</li>
      <li>Mailboxes: Any, creates one per Actor per Thread (on demand)</li>
      <li>Use cases: Testing</li>
      <li>Driven by: The calling thread (duh)</li>
    </ul>
  </li>
</ul>
<h3><a href="#more-dispatcher-configuration-examples" name="more-dispatcher-configuration-examples" class="anchor"><span class="anchor-link"></span></a>More dispatcher configuration examples</h3>
<p>Configuring a dispatcher with fixed thread pool size, e.g. for actors that perform blocking IO:</p>
<pre class="prettyprint"><code class="language-scala">blocking-io-dispatcher {
  type = Dispatcher
  executor = &quot;thread-pool-executor&quot;
  thread-pool-executor {
    fixed-pool-size = 32
  }
  throughput = 1
}</code></pre>
<p>And then using it:</p>
<pre class="prettyprint"><code class="language-java">ActorRef myActor = system.actorOf(Props.create(MyActor.class)
    .withDispatcher(&quot;blocking-io-dispatcher&quot;));</code></pre>
<p>Another example that uses the thread pool based on the number of cores (e.g. for CPU bound tasks)</p>
<pre class="prettyprint"><code class="language-scala">my-thread-pool-dispatcher {
  # Dispatcher is the name of the event-based dispatcher
  type = Dispatcher
  # What kind of ExecutionService to use
  executor = &quot;thread-pool-executor&quot;
  # Configuration for the thread pool
  thread-pool-executor {
    # minimum number of threads to cap factor-based core number to
    core-pool-size-min = 2
    # No of core threads ... ceil(available processors * factor)
    core-pool-size-factor = 2.0
    # maximum number of threads to cap factor-based number to
    core-pool-size-max = 10
  }
  # Throughput defines the maximum number of messages to be
  # processed per actor before the thread jumps to the next actor.
  # Set to 1 for as fair as possible.
  throughput = 100
}</code></pre>
<p>Configuring a <code>PinnedDispatcher</code>:</p>
<pre class="prettyprint"><code class="language-scala">my-pinned-dispatcher {
  executor = &quot;thread-pool-executor&quot;
  type = PinnedDispatcher
}</code></pre>
<p>And then using it:</p>
<pre class="prettyprint"><code class="language-java">ActorRef myActor = system.actorOf(Props.create(MyActor.class)
    .withDispatcher(&quot;my-pinned-dispatcher&quot;));</code></pre>
<p>Note that <code>thread-pool-executor</code> configuration as per the above <code>my-thread-pool-dispatcher</code> example is NOT applicable. This is because every actor will have its own thread pool when using <code>PinnedDispatcher</code>, and that pool will have only one thread.</p>
<p>Note that it&rsquo;s not guaranteed that the <em>same</em> thread is used over time, since the core pool timeout is used for <code>PinnedDispatcher</code> to keep resource usage down in case of idle actors. To use the same thread all the time you need to add <code>thread-pool-executor.allow-core-timeout=off</code> to the configuration of the <code>PinnedDispatcher</code>.</p>
</div>
</article>

<div class="row">
<div class="small-12 large-9 column">
<section class="nav-prev-next row">
<div class="nav-prev small-6 column">
<a href="../java/fault-tolerance-sample.html"><i class="icon-prev"></i> <span class="link-prev">Diagrams of the Fault Tolerance Sample</span></a>
</div>
<div class="nav-next small-6 column clearfix">
<a class="float-right" href="../java/mailboxes.html">Mailboxes <i class="icon-next"></i></a>
</div>
</section>
</div>
</div>

<div class="source-github row">
The source code for this page can be found <a href="http://github.com/akka/akka/tree/master/akka-docs/src/main/paradox/java/dispatchers.md">here</a>.
</div>


<footer class="page-footer row clearfix">
<img class="akka-icon float-left show-for-medium" src="../images/akka-icon.svg">
<section class="copyright">
<div>&copy; 2011-2017 <a href="https://www.lightbend.com">Lightbend</a></div>
<div>Akka is Open Source and available under the Apache 2 License.</div>
</section>
</footer>

</section>
</main>

<script type="text/javascript" src="../js/scrollsneak.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../js/groups.js"></script>
<script type="text/javascript" src="../js/page.js"></script>
<script type="text/javascript" src="../js/magellan.js"></script>

<style type="text/css">@import "../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>

<!-- Algolia docs search -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
<style>.algolia-autocomplete { display: block !important }</style>
<script type="text/javascript">
var lang = "scala";
var path = window.location.pathname;
if (path.includes("/java/") || path.includes("java.html")) {
lang = "java";
}

docsearch({
apiKey: '543bad5ad786495d9ccd445ed34ed082',
indexName: 'akka_io',
inputSelector: '#search',
algoliaOptions: {
hitsPerPage: 5,
facetFilters: ["language:" + lang]
}
});

docsearch({
apiKey: '543bad5ad786495d9ccd445ed34ed082',
indexName: 'akka_io',
inputSelector: '#overlay-search',
algoliaOptions: {
hitsPerPage: 5,
facetFilters: ["language:" + lang]
}
});

// set up "/" as global shortcut for focusing on search
jQuery(document).keypress(function (event) {
if (event.keyCode == 47) {
jQuery("#search").focus();
return false; // swallow key event, otherwise the / char would be input into the search box
}
});
</script>


</body>
</html>
