<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Building Native Images &bull; Akka Documentation</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="How to build native image executables with Akka"/>
<link rel="canonical" href="https://doc.akka.io/docs/akka/current/additional/native-image.html"/>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../lib/foundation/dist/js/foundation.min.js"></script>
<link rel="stylesheet" type="text/css" href="../lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="../lib/foundation/dist/css/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<link rel="stylesheet" type="text/css" href="../css/icons.css"/>
<link rel="stylesheet" type="text/css" href="../css/page-8.css"/>
<link rel="stylesheet" type="text/css" href="../css/banner-2.css"/>
<link rel="shortcut icon" href="../images/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="../images/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="../images/favicon-32x32.png"/>
<link rel="icon" type="image/png" sizes="16x16" href="../images/favicon-16x16.png"/>
<link rel="manifest" href="../images/manifest.json"/>
<meta name="msapplication-TileImage" content="../images/mstile-150x150.png"/>
<meta name="msapplication-TileColor" content="#15a9ce"/>
<meta name="theme-color" content="#15a9ce"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) start -->
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js"  type="text/javascript" charset="UTF-8" data-domain-script="28b912e7-09e9-43d5-91e4-3d1897044004" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) end -->
<!-- Google Tag Manager now loads Google Analytics and any other tracking scripts. GTM also performs respects a users cookie choices-->
<script type="text/javascript">
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KBJGH35');
</script>

</head>

<body id="underlay" data-toggler="nav-open">
<div id="lightbend-banner" class="lightbend-banner akka full-width" data-category="OSS Lightbend Banner Impression" data-label="Akka Banner Impression">
<div class="oss-wrapper">
<div class="oss-brand">
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Lightbend Logo - Akka Banner" href="https://www.lightbend.com">
<img class="lightbend-logo" src="../images/banner-logos/lightbend-reverse.svg" alt="Lightbend" title="Lightbend">
</a>
</div>
<div class="oss-ad no-drop-down">
<nav id="lightbendRotator" class="lightbend-rotator">
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Promo Rotator - Introducing Akka Cloud to Edge Continuum. Build once for the Cloud. Seamlessly deploy to the Edge. [Learn more] - Akka Banner" href="https://www.lightbend.com/blog/akka-edge-unifying-the-cloud-and-edge">
Introducing Akka Cloud to Edge Continuum. Build once for the Cloud. Seamlessly deploy to the Edge. <span class="akka-btn">Learn more</span>
</a>
</nav>
</div>
</div>
</div>

<header class="site-header hide-for-large">
<div class="sticky-header clearfix">
<a href="https://akka.io"><img class="logo" src="../images/akka-logo-reverse.svg"/></a>

<button class="menu-icon float-right" type="button" data-toggle="underlay overlay"></button>
</div>
<div id="overlay" class="overlay-nav" data-toggler="nav-open">
<header class="nav-header">
<div class="nav-header-title">
<h1><a href="../index.html">Akka Documentation</a></h1>
</div>
<div class="nav-header-version">
Version 2.9.2
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-scala">Scala</option><option class="group" value="group-java">Java</option></select>
<select class="supergroup" name="BuildTool"><option class="group" value="group-sbt">sbt</option><option class="group" value="group-maven">Maven</option><option class="group" value="group-gradle">Gradle</option></select>
</div>
<div id="overlay-search-container" class="nav-header-search">
<input id="overlay-search" type="search" class="search" placeholder="Search" />
</div>
</header>
<nav class="nav-toc">
<ul>
  <li><a href="../security/index.html" class="page">Security Announcements</a></li>
  <li><a href="../typed/guide/index.html" class="page">Getting Started Guide</a></li>
  <li><a href="../general/index.html" class="page">General Concepts</a></li>
  <li><a href="../typed/index.html" class="page">Actors</a></li>
  <li><a href="../typed/index-cluster.html" class="page">Cluster</a></li>
  <li><a href="../typed/index-persistence.html" class="page">Persistence (Event Sourcing)</a></li>
  <li><a href="../typed/index-persistence-durable-state.html" class="page">Persistence (Durable State)</a></li>
  <li><a href="../stream/index.html" class="page">Streams</a></li>
  <li><a href="../discovery/index.html" class="page">Discovery</a></li>
  <li><a href="../index-utilities.html" class="page">Utilities</a></li>
  <li><a href="../common/other-modules.html" class="page">Other Akka modules</a></li>
  <li><a href="../additional/deploy.html" class="page">Package, Deploy and Run</a>
  <ul>
    <li><a href="../additional/packaging.html" class="page">Packaging</a></li>
    <li><a href="../additional/operations.html" class="page">Operating a Cluster</a></li>
    <li><a href="../additional/deploying.html" class="page">Deploying</a></li>
    <li><a href="../additional/rolling-updates.html" class="page">Rolling Updates</a></li>
    <li><a href="../additional/native-image.html#building-native-images" class="active page">Building Native Images</a>
    <ul>
      <li><a href="../additional/native-image.html#unsupported-features" class="header">Unsupported features</a></li>
      <li><a href="../additional/native-image.html#features-requiring-additional-metadata" class="header">Features requiring additional metadata</a></li>
    </ul></li>
  </ul></li>
  <li><a href="../project/index.html" class="page">Project Information</a></li>
  <li><a href="../index-classic.html" class="page">Akka Classic</a></li>
</ul>
</nav>
</div>
</header>
<div class="site-content-wrapper">
<aside class="sticky-sidebar show-for-large">
<header class="nav-header sticky-sidebar-header">
<div class="nav-header-title">
<h1><a href="../index.html">Akka Documentation</a></h1>
</div>
<div class="nav-header-version">
Version 2.9.2
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-scala">Scala</option><option class="group" value="group-java">Java</option></select>
<select class="supergroup" name="BuildTool"><option class="group" value="group-sbt">sbt</option><option class="group" value="group-maven">Maven</option><option class="group" value="group-gradle">Gradle</option></select>
</div>
<div class="nav-header-search">
<input id="search" type="search" class="search" placeholder="Search" />
</div>
</header>
<nav class="site-nav sticky-sidebar-contents">
<div class="nav-toc">
<ul>
  <li><a href="../security/index.html" class="page">Security Announcements</a></li>
  <li><a href="../typed/guide/index.html" class="page">Getting Started Guide</a></li>
  <li><a href="../general/index.html" class="page">General Concepts</a></li>
  <li><a href="../typed/index.html" class="page">Actors</a></li>
  <li><a href="../typed/index-cluster.html" class="page">Cluster</a></li>
  <li><a href="../typed/index-persistence.html" class="page">Persistence (Event Sourcing)</a></li>
  <li><a href="../typed/index-persistence-durable-state.html" class="page">Persistence (Durable State)</a></li>
  <li><a href="../stream/index.html" class="page">Streams</a></li>
  <li><a href="../discovery/index.html" class="page">Discovery</a></li>
  <li><a href="../index-utilities.html" class="page">Utilities</a></li>
  <li><a href="../common/other-modules.html" class="page">Other Akka modules</a></li>
  <li><a href="../additional/deploy.html" class="page">Package, Deploy and Run</a>
  <ul>
    <li><a href="../additional/packaging.html" class="page">Packaging</a></li>
    <li><a href="../additional/operations.html" class="page">Operating a Cluster</a></li>
    <li><a href="../additional/deploying.html" class="page">Deploying</a></li>
    <li><a href="../additional/rolling-updates.html" class="page">Rolling Updates</a></li>
    <li><a href="../additional/native-image.html#building-native-images" class="active page">Building Native Images</a>
    <ul>
      <li><a href="../additional/native-image.html#unsupported-features" class="header">Unsupported features</a></li>
      <li><a href="../additional/native-image.html#features-requiring-additional-metadata" class="header">Features requiring additional metadata</a></li>
    </ul></li>
  </ul></li>
  <li><a href="../project/index.html" class="page">Project Information</a></li>
  <li><a href="../index-classic.html" class="page">Akka Classic</a></li>
</ul>
</div>
</nav>
<footer class="nav-footer sticky-sidebar-footer">
<a href="https://akka.io"><img class="logo" src="../images/akka-logo-reverse.svg"/></a>

</footer>
</aside>
<main class="fixed-shift-for-large expanded row">
<section class="site-content small-12 column">
<article class="page-content row">
<div class="small-12 column" id="docs">
<h1><a href="#building-native-images" name="building-native-images" class="anchor"><span class="anchor-link"></span></a>Building Native Images</h1>
<p>Building native images with Akka is supported, both for local and cluster actor system applications. </p>
<p>Most built-in features in Akka can be used as is, however some functionality is not available and some extension points require additional metadata for reflective access to work. Akka and the Akka umbrella tries to provide metadata for third party dependencies where needed and not provided by the dependency to allow applications with zero or little extra native-image metadata.</p>
<p>A full sample including many of the Akka projects and build tool set up can be found in the <a href="https://doc.akka.io/docs/akka-edge/current/lightweight-deployments.html#graalvm-native-image">Akka Edge Documentation</a>. </p>
<h2><a href="#unsupported-features" name="unsupported-features" class="anchor"><span class="anchor-link"></span></a>Unsupported features</h2>
<p>The following features and aspects are not currently supported out of the box:</p>
<ul>
  <li>Lightbend Telemetry</li>
  <li>Aeron UDP remoting</li>
  <li>Testkits</li>
  <li>LevelDB and InMem Akka Persistence plugins</li>
  <li><a href="../typed/distributed-data.html#durable-storage">Durable storage</a> for Akka Distributed Data</li>
  <li>Scala 3</li>
</ul>
<h2><a href="#features-requiring-additional-metadata" name="features-requiring-additional-metadata" class="anchor"><span class="anchor-link"></span></a>Features requiring additional metadata</h2>
<p>In general, any feature that allows a custom implementation provided by a third party library or user code that is then plugged into Akka through an entry in the application config file needs to have reflection metadata explicitly added as described in the <a href="https://www.graalvm.org/latest/reference-manual/native-image/metadata/">GraalVM docs here</a>.</p>
<p>Examples of such classes are:</p>
<ul>
  <li>Custom Serializers</li>
  <li>Custom Mailbox Types</li>
  <li>Akka Persistence plugins</li>
  <li>Akka Discovery implementations</li>
  <li>Akka Lease implementations</li>
</ul>
<p>For plugins provided in libraries, metadata is preferably provided with the library so that end user applications do not need to provide metadata for them.</p>
<h3><a href="#serialization-with-jackson" name="serialization-with-jackson" class="anchor"><span class="anchor-link"></span></a>Serialization with Jackson</h3>
<p>When using the built-in <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.9/akka/serialization/jackson/JsonSerializable.html" title="akka.serialization.jackson.JsonSerializable"><code>JsonSerializable</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.9/akka/serialization/jackson/JsonSerializable.html" title="akka.serialization.jackson.JsonSerializable"><code>JsonSerializable</code></a></span> and <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.9/akka/serialization/jackson/CborSerializable.html" title="akka.serialization.jackson.CborSerializable"><code>CborSerializable</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.9/akka/serialization/jackson/CborSerializable.html" title="akka.serialization.jackson.CborSerializable"><code>CborSerializable</code></a></span> marker traits, message types are automatically added for reflective access by Akka. But there are a few important caveats:</p>
<p>Messages with only primitives, standard library, your own or Akka provided types are automatically registered. More complex message structures and special Jackson annotations must be carefully tested as it is hard to predict if and how Jackson will reflectively interact with them. </p>
<p>Types only referenced in fields as type parameters of other generic types, like for example in a collection <span class="group-scala">List[MyClass]</span><span class="group-java">List<MyClass></span>, will require explicit marker traits to be picked up <span class="group-scala"><code>class MyClass() extends JsonSerializable</code></span> <span class="group-java"><code>class MyClass implements JsonSerializable</code></span> or explicit entries in the <code>reflect-config.json</code> of your application.</p>
<p><span class="group-scala">Scala standard library enumerations are not supported for serialization out of the box.</span></p>
<p>If self-defined marker traits are being used, then the marker trait defined in <code>serialization-bindings</code>, as well as each concrete message type (lookup, constructor fields as needed by Jackson) and the field types, need to be added to the reflection metadata.</p>
<p>Applications that define and configure <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.9/akka/serialization/jackson/JacksonMigration.html" title="akka.serialization.jackson.JacksonMigration"><code>JacksonMigration</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.9/akka/serialization/jackson/JacksonMigration.html" title="akka.serialization.jackson.JacksonMigration"><code>JacksonMigration</code></a></span> to evolve data formats need to list each concrete migration implementation (lookup and zero parameter constructor) in reflection metadata.</p>
<p>Additional object mappers added through config <code>akka.serialization.jackson.jackson-modules</code> need entries in the reflective metadata (lookup and constructor).</p>
<h3><a href="#third-party-serializers" name="third-party-serializers" class="anchor"><span class="anchor-link"></span></a>Third party serializers</h3>
<p>Third party serializers will need reflection metadata for the serializer implementation, the types used in <code>serialization-bindings</code> and possibly further per-message metadata depending on the specific serializer logic.</p>
<h3><a href="#extensions" name="extensions" class="anchor"><span class="anchor-link"></span></a>Extensions</h3>
<p>Classic and typed <code>Extension</code>s loaded via configuration (<code>akka.extensions</code>, <code>akka.actor.typed.extensions</code>, <code>akka.actor.library-extensions</code> or <code>akka.actor.typed.library-extensions</code>) need an entry in the reflection metadata (class and constructor).</p>
<h3><a href="#akka-persistence-event-adapters" name="akka-persistence-event-adapters" class="anchor"><span class="anchor-link"></span></a>Akka Persistence Event Adapters</h3>
<p>Event adapters defined in an application need to be listed in reflection metadata (class and constructor).</p>
<h3><a href="#reflective-classic-actor-construction" name="reflective-classic-actor-construction" class="anchor"><span class="anchor-link"></span></a>Reflective classic actor construction</h3>
<p>Classic actors that have a <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.9/akka/actor/Props$.html" title="akka.actor.Props"><code>Props</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.9/akka/actor/Props.html" title="akka.actor.Props"><code>Props</code></a></span> defined using the <span class="group-scala">type <code>Props[T]()</code> or class <code>Props(classOf[T], ...)</code></span> <span class="group-java">class <code>Props.create(T.getClass, ...)</code></span> need reflection entries for lookup and the constructor matching the set of passed parameters. </p>
<p>An easier path is to instead use lambda factories <span class="group-scala">type <code>Props(new T)</code></span> <span class="group-java">class <code>Props.create(T.getClass, () -&gt; new T())</code></span> to define props. The only reason to use the reflection based approach is the classic remote deploy feature.</p>
<h3><a href="#logging" name="logging" class="anchor"><span class="anchor-link"></span></a>Logging</h3>
<p>When using <code>akka-slf4j</code> for logging, automatically used for <code>akka-actor-typed</code>, it is very likely that the concrete logger chosen needs extra configuration.</p>
<p>While Akka does not mandate a logger implementation, <code>logback-classic</code> is used in many Akka samples throughout the Akka projects. Because of this Akka provides reflection metadata for logback out of the box, however projects using it will need an extra native image flag <code>--initialize-at-build-time=ch.qos.logback</code>.</p>
<p>Special care needs to be taken if using the async logback appender. Either avoid using <code>ch.qos.logback.classic.AsyncAppender</code> or declare your own lazy version of the appender (not starting any threads at native image build time). You can see an example of such a lazy appender in the <span class="group-scala"><a href="https://github.com/akka/akka-projection/blob/main/samples/grpc/local-drone-control-scala/src/main/scala/local/logback/NativeImageAsyncAppender.scala">Akka Projections edge replication sample</a></span><span class="group-java"><a href="https://github.com/akka/akka-projection/blob/main/samples/grpc/local-drone-control-java/src/main/java/local/logback/NativeImageAsyncAppender.java">Akka Projections edge replication sample</a></span></p>
</div>
</article>
<div class="row">
<div class="small-12 column">
<section class="nav-prev-next row">
<div class="nav-prev small-6 column">
<a href="../additional/rolling-updates.html"><i class="icon-prev"></i> <span class="link-prev">Rolling Updates</span></a>
</div>
<div class="nav-next small-6 column clearfix">
<a class="float-right" href="../project/index.html">Project Information <i class="icon-next"></i></a>
</div>
</section>
</div>
</div>
<div class="source-github row">
Found an error in this documentation? The source code for this page can be found <a href="https://github.com/akka/akka/tree/v2.9.2/akka-docs/src/main/paradox/additional/native-image.md">here</a>.
Please feel free to edit and contribute a pull request.
</div>

<footer class="page-footer row clearfix">
<img class="akka-icon float-left show-for-medium" src="../images/akka-icon.svg" />
<section class="copyright">
<div>Akka is available under the <a href="https://www.lightbend.com/akka/license" target="_blank">Business Source License 1.1</a>.</div>
<p class="legal">
&copy; 2011-2024 <a href="https://www.lightbend.com" target="_blank">Lightbend, Inc.</a> |
<a href="https://www.lightbend.com/legal/licenses" target="_blank">Licenses</a> |
<a href="https://www.lightbend.com/legal/terms" target="_blank">Terms</a> |
<a href="https://www.lightbend.com/legal/privacy" target="_blank">Privacy Policy</a> |
<a href="https://akka.io/cookie/" target="_blank">Cookie Listing</a> |
<a class="optanon-toggle-display">Cookie Settings</a>
</p>
</section>

</footer>
</section>
</main>
</div>

<script type="text/javascript" src="../js/scrollsneak.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../js/groups.js"></script>
<script type="text/javascript" src="../js/page.js"></script>
<script type="text/javascript" src="../js/snippets.js"></script>
<script type="text/javascript" src="../js/magellan.js"></script>
<script type="text/javascript" src="../js/metadata-toggle.js"></script>
<script type="text/javascript" src="../js/lbHeader.js"></script>

<style type="text/css">@import "../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(){window.prettyPrint && prettyPrint()});
//]]></script>
<!-- Algolia docs search -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
<style>.algolia-autocomplete { display: block !important }</style>
<script type="text/javascript">
docsearch({
appId: 'XUXZ6LW9B1',
apiKey: '5b6260148e92f7c5e38338fcf7eaa3e0',
indexName: 'akka_docs',
inputSelector: '#search',
algoliaOptions: {
hitsPerPage: 5
}
});

docsearch({
appId: 'XUXZ6LW9B1',
apiKey: '5b6260148e92f7c5e38338fcf7eaa3e0',
indexName: 'akka_docs',
inputSelector: '#overlay-search',
algoliaOptions: {
hitsPerPage: 5
}
});

// set up "/" as global shortcut for focusing on search
jQuery(document).keypress(function (event) {
if (event.keyCode == 47) {
jQuery("#search").focus();
return false; // swallow key event, otherwise the / char would be input into the search box
}
});
</script>

<script type="text/javascript" src="../assets/js/warnOldVersion.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(jq){initOldVersionWarnings(jq, '2.9.2', 'https://akka.io/')});
//]]></script>


</body>
</html>
