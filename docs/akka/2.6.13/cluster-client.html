<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Classic Cluster Client &bull; Akka Documentation</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="Akka is a toolkit for building highly concurrent, distributed, and resilient message-driven applications for Java and Scala."/>
<link rel="canonical" href="https://doc.akka.io/docs/akka/current/cluster-client.html"/>
<script type="text/javascript" src="lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="lib/foundation/dist/js/foundation.min.js"></script>
<link rel="stylesheet" type="text/css" href="lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="lib/foundation/dist/css/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<link rel="stylesheet" type="text/css" href="css/icons.css"/>
<link rel="stylesheet" type="text/css" href="css/page-8.css"/>
<link rel="stylesheet" type="text/css" href="css/banner-1.css"/>
<link rel="shortcut icon" href="images/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png"/>
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png"/>
<link rel="manifest" href="images/manifest.json"/>
<meta name="msapplication-TileImage" content="images/mstile-150x150.png"/>
<meta name="msapplication-TileColor" content="#15a9ce"/>
<meta name="theme-color" content="#15a9ce"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) start -->
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js"  type="text/javascript" charset="UTF-8" data-domain-script="28b912e7-09e9-43d5-91e4-3d1897044004" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) end -->
<!--Google Analytics-->
<script type="text/plain" class="optanon-category-2">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-21117439-1']);
_gaq.push(['_setDomainName', 'akka.io']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})()
</script>
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-2">
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KBJGH35');
</script>
<!--Marketo-->
<script type="text/plain" class="optanon-category-3">
(function() {
var didInit = false;
function initMunchkin() {
if(didInit === false) {
didInit = true;
Munchkin.init('558-NCX-702', { 'asyncOnly': true, 'disableClickDelay': true });
}
}
var s = document.createElement('script');
s.type = 'text/javascript';
s.async = true;
s.src = '//munchkin.marketo.net/munchkin.js';
s.onreadystatechange = function() {
if (this.readyState == 'complete' || this.readyState == 'loaded') {
initMunchkin();
}
};
s.onload = initMunchkin;
document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
</head>

<body id="underlay" data-toggler="nav-open">
<div id="lightbend-banner" class="lightbend-banner akka full-width" data-category="OSS Lightbend Banner Impression" data-label="Akka Banner Impression">
<div class="wrapper">
<div class="brand">
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Lightbend Logo - Akka Banner" href="https://www.lightbend.com?r=oss-banner-akka" target="_blank">
<img class="lightbend-logo" src="images/banner-logos/lightbend-reverse.svg" alt="Lightbend" title="Lightbend">
</a>
</div>
<div class="nav">
<a class="banner-btn oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Enhance your Akka systems with Akka Platform [Button] - Akka Banner" href="https://www.lightbend.com/akka-platform?r=oss-banner-akka" target="_blank">
<span>Enhance your Akka systems with</span>
<img class="akka-platform-reverse-logo" src="images/banner-logos/akka-platform-reverse.svg" alt="Akka Platform" title="Akka Platform">
</a>
<div class="drop-down">
<svg class="svg-chevon-circle-down" version="1.1" id="Chevron_circled_down" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
<path fill="#ffffff" d="M12.505,8.698L10,11L7.494,8.698c-0.198-0.196-0.518-0.196-0.718,0c-0.197,0.196-0.197,0.515,0,0.71l2.864,2.807
c0.199,0.196,0.52,0.196,0.717,0l2.864-2.807c0.199-0.195,0.198-0.514,0-0.71C13.024,8.502,12.704,8.502,12.505,8.698z M10,0.4
c-5.302,0-9.6,4.298-9.6,9.6c0,5.303,4.298,9.6,9.6,9.6s9.6-4.297,9.6-9.6C19.6,4.698,15.302,0.4,10,0.4z M10,18.354
c-4.615,0-8.354-3.74-8.354-8.354c0-4.614,3.739-8.354,8.354-8.354c4.613,0,8.354,3.74,8.354,8.354
C18.354,14.614,14.613,18.354,10,18.354z" />
</svg>
<div class="drop-down-content">
<div class="lightbend-family">
<a href="https://cloudflow.io" class="cloudflow oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Cloudflow - Logo Tag Line - Akka Banner">
<img class="cloudflow-full-color-logo" src="images/banner-logos/cloudflow-full-color.svg" alt="Cloudflow by Lightbend" title="Cloudflow by Lightbend">
</a>
<a href="https://cloudstate.io" class="cloudstate oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Cloudstate - Logo Tag Line - Akka Banner">
<img class="cloudstate-full-color-logo" src="images/banner-logos/cloudstate-full-color.svg" alt="Cloudstate by Lightbend" title="Cloudstate by Lightbend">
</a>
<a href="https://www.lagomframework.com" class="lagom oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Lagom - Logo Tag Line - Akka Banner">
<img class="lagom-full-color-logo" src="images/banner-logos/lagom-full-color.svg" alt="Lagom Framework by Lightbend" title="Lagom Framework by Lightbend">
</a>
<a href="https://www.playframework.com" class="play oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Play - Logo Tag Line - Akka Banner">
<img class="play-full-color-logo" src="images/banner-logos/play-full-color.svg" alt="Play Framework by Lightbend" title="Play Framework by Lightbend">
</a>
<a href="https://www.scala-lang.org" class="scala oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Scala - Logo Tag Line - Akka Banner">
<img class="scala-full-color-logo" src="images/banner-logos/scala-full-color.svg" alt="Scala by Lightbend" title="Scala by Lightbend">
</a>
<div class="akka current">
<img class="akka-full-color-logo" src="images/banner-logos/akka-full-color.svg" alt="Akka by Lightbend" title="Akka by Lightbend">
<span>From the creators of <strong>Akka</strong>, get technology enhancements, monitoring, and expert support with Akka Platform from Lightbend.</span>
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Learn More [Button] - Akka Banner" href="https://www.lightbend.com/akka-platform?r=oss-banner-akka" target="_blank">Learn More</a>
</div>
</div>
<div class="title">The Lightbend Family</div>
</div>      
</div>
</div>
</div>
</div>

<header class="site-header hide-for-large">
<div class="sticky-header clearfix">
<a href="https://akka.io"><img class="logo" src="images/akka-logo-reverse.svg"/></a>

<button class="menu-icon float-right" type="button" data-toggle="underlay overlay"></button>
</div>
<div id="overlay" class="overlay-nav" data-toggler="nav-open">
<header class="nav-header">
<div class="nav-header-title">
<h1><a href="index.html">Akka Documentation</a></h1>
</div>
<div class="nav-header-version">
Version 2.6.13
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-scala">Scala</option><option class="group" value="group-java">Java</option></select>
</div>
<div id="overlay-search-container" class="nav-header-search">
<input id="overlay-search" type="search" class="search" placeholder="Search" />
</div>
</header>
<nav class="nav-toc">
<ul>
  <li><a href="security/index.html" class="page">Security Announcements</a></li>
  <li><a href="typed/guide/index.html" class="page">Getting Started Guide</a></li>
  <li><a href="general/index.html" class="page">General Concepts</a></li>
  <li><a href="typed/index.html" class="page">Actors</a></li>
  <li><a href="typed/index-cluster.html" class="page">Cluster</a></li>
  <li><a href="typed/index-persistence.html" class="page">Persistence</a></li>
  <li><a href="stream/index.html" class="page">Streams</a></li>
  <li><a href="discovery/index.html" class="page">Discovery</a></li>
  <li><a href="index-utilities.html" class="page">Utilities</a></li>
  <li><a href="common/other-modules.html" class="page">Other Akka modules</a></li>
  <li><a href="additional/deploy.html" class="page">Package, Deploy and Run</a></li>
  <li><a href="project/index.html" class="page">Project Information</a></li>
  <li><a href="index-classic.html" class="page">Akka Classic</a>
  <ul>
    <li><a href="index-actors.html" class="page">Classic Actors</a></li>
    <li><a href="index-cluster.html" class="page">Classic Clustering</a>
    <ul>
      <li><a href="cluster-usage.html" class="page">Classic Cluster Usage</a></li>
      <li><a href="cluster-routing.html" class="page">Classic Cluster Aware Routers</a></li>
      <li><a href="cluster-singleton.html" class="page">Classic Cluster Singleton</a></li>
      <li><a href="distributed-pub-sub.html" class="page">Classic Distributed Publish Subscribe in Cluster</a></li>
      <li><a href="cluster-client.html#classic-cluster-client" class="active page">Classic Cluster Client</a>
      <ul>
        <li><a href="cluster-client.html#module-info" class="header">Module info</a></li>
        <li><a href="cluster-client.html#introduction" class="header">Introduction</a></li>
        <li><a href="cluster-client.html#an-example" class="header">An Example</a></li>
        <li><a href="cluster-client.html#clusterclientreceptionist-extension" class="header">ClusterClientReceptionist Extension</a></li>
        <li><a href="cluster-client.html#events" class="header">Events</a></li>
        <li><a href="cluster-client.html#configuration" class="header">Configuration</a></li>
        <li><a href="cluster-client.html#failure-handling" class="header">Failure handling</a></li>
        <li><a href="cluster-client.html#when-the-cluster-cannot-be-reached-at-all" class="header">When the cluster cannot be reached at all</a></li>
        <li><a href="cluster-client.html#migration-to-akka-grpc" class="header">Migration to Akka gRPC</a></li>
      </ul></li>
      <li><a href="cluster-sharding.html" class="page">Classic Cluster Sharding</a></li>
      <li><a href="cluster-metrics.html" class="page">Classic Cluster Metrics Extension</a></li>
      <li><a href="distributed-data.html" class="page">Classic Distributed Data</a></li>
      <li><a href="cluster-dc.html" class="page">Classic Multi-DC Cluster</a></li>
      <li><a href="serialization-classic.html" class="page">Classic Serialization</a></li>
    </ul></li>
    <li><a href="index-network.html" class="page">Classic Networking</a></li>
    <li><a href="index-utilities-classic.html" class="page">Classic Utilities</a></li>
  </ul></li>
</ul>
</nav>
</div>
</header>
<div class="site-content-wrapper">
<aside class="sticky-sidebar show-for-large">
<header class="nav-header sticky-sidebar-header">
<div class="nav-header-title">
<h1><a href="index.html">Akka Documentation</a></h1>
</div>
<div class="nav-header-version">
Version 2.6.13
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-scala">Scala</option><option class="group" value="group-java">Java</option></select>
</div>
<div class="nav-header-search">
<input id="search" type="search" class="search" placeholder="Search" />
</div>
</header>
<nav class="site-nav sticky-sidebar-contents">
<div class="nav-toc">
<ul>
  <li><a href="security/index.html" class="page">Security Announcements</a></li>
  <li><a href="typed/guide/index.html" class="page">Getting Started Guide</a></li>
  <li><a href="general/index.html" class="page">General Concepts</a></li>
  <li><a href="typed/index.html" class="page">Actors</a></li>
  <li><a href="typed/index-cluster.html" class="page">Cluster</a></li>
  <li><a href="typed/index-persistence.html" class="page">Persistence</a></li>
  <li><a href="stream/index.html" class="page">Streams</a></li>
  <li><a href="discovery/index.html" class="page">Discovery</a></li>
  <li><a href="index-utilities.html" class="page">Utilities</a></li>
  <li><a href="common/other-modules.html" class="page">Other Akka modules</a></li>
  <li><a href="additional/deploy.html" class="page">Package, Deploy and Run</a></li>
  <li><a href="project/index.html" class="page">Project Information</a></li>
  <li><a href="index-classic.html" class="page">Akka Classic</a>
  <ul>
    <li><a href="index-actors.html" class="page">Classic Actors</a></li>
    <li><a href="index-cluster.html" class="page">Classic Clustering</a>
    <ul>
      <li><a href="cluster-usage.html" class="page">Classic Cluster Usage</a></li>
      <li><a href="cluster-routing.html" class="page">Classic Cluster Aware Routers</a></li>
      <li><a href="cluster-singleton.html" class="page">Classic Cluster Singleton</a></li>
      <li><a href="distributed-pub-sub.html" class="page">Classic Distributed Publish Subscribe in Cluster</a></li>
      <li><a href="cluster-client.html#classic-cluster-client" class="active page">Classic Cluster Client</a>
      <ul>
        <li><a href="cluster-client.html#module-info" class="header">Module info</a></li>
        <li><a href="cluster-client.html#introduction" class="header">Introduction</a></li>
        <li><a href="cluster-client.html#an-example" class="header">An Example</a></li>
        <li><a href="cluster-client.html#clusterclientreceptionist-extension" class="header">ClusterClientReceptionist Extension</a></li>
        <li><a href="cluster-client.html#events" class="header">Events</a></li>
        <li><a href="cluster-client.html#configuration" class="header">Configuration</a></li>
        <li><a href="cluster-client.html#failure-handling" class="header">Failure handling</a></li>
        <li><a href="cluster-client.html#when-the-cluster-cannot-be-reached-at-all" class="header">When the cluster cannot be reached at all</a></li>
        <li><a href="cluster-client.html#migration-to-akka-grpc" class="header">Migration to Akka gRPC</a></li>
      </ul></li>
      <li><a href="cluster-sharding.html" class="page">Classic Cluster Sharding</a></li>
      <li><a href="cluster-metrics.html" class="page">Classic Cluster Metrics Extension</a></li>
      <li><a href="distributed-data.html" class="page">Classic Distributed Data</a></li>
      <li><a href="cluster-dc.html" class="page">Classic Multi-DC Cluster</a></li>
      <li><a href="serialization-classic.html" class="page">Classic Serialization</a></li>
    </ul></li>
    <li><a href="index-network.html" class="page">Classic Networking</a></li>
    <li><a href="index-utilities-classic.html" class="page">Classic Utilities</a></li>
  </ul></li>
</ul>
</div>
</nav>
<footer class="nav-footer sticky-sidebar-footer">
<a href="https://akka.io"><img class="logo" src="images/akka-logo-reverse.svg"/></a>

</footer>
</aside>
<main class="fixed-shift-for-large expanded row">
<section class="site-content small-12 column">
<article class="page-content row">
<div class="small-12 column" id="docs">
<h1><a href="#classic-cluster-client" name="classic-cluster-client" class="anchor"><span class="anchor-link"></span></a>Classic Cluster Client</h1><div class="callout warning "><div class="callout-title">Warning</div>
<p>Cluster Client is deprecated in favor of using <a href="https://doc.akka.io/docs/akka-grpc/current/index.html">Akka gRPC</a>. It is not advised to build new applications with Cluster Client, and existing users <a href="cluster-client.html#migration-to-akka-grpc">should migrate</a>.</p></div><div class="callout note "><div class="callout-title">Note</div>
<p>Akka Classic pertains to the original Actor APIs, which have been improved by more type safe and guided Actor APIs. Akka Classic is still fully supported and existing applications can continue to use the classic APIs. It is also possible to use the new Actor APIs together with classic actors in the same ActorSystem, see <a href="typed/coexisting.html">coexistence</a>. For new projects we recommend using <a href="typed/actors.html">the new Actor API</a>.</p></div>
<h2><a href="#module-info" name="module-info" class="anchor"><span class="anchor-link"></span></a>Module info</h2>
<p>To use Cluster Client, you must add the following dependency in your project:</p><dl class="dependency"><dt>sbt</dt><dd><pre class="prettyprint"><code class="language-scala">val AkkaVersion = "2.6.13"
libraryDependencies += "com.typesafe.akka" %% "akka-cluster-tools" % AkkaVersion</code></pre></dd><dt>Maven</dt><dd><pre class="prettyprint"><code class="language-xml">&lt;properties&gt;
  &lt;scala.binary.version&gt;2.13&lt;/scala.binary.version&gt;
&lt;/properties&gt;
&lt;dependencyManagement&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.typesafe.akka&lt;/groupId&gt;
      &lt;artifactId&gt;akka-bom_${scala.binary.version}&lt;/artifactId&gt;
      &lt;version&gt;2.6.13&lt;/version&gt;
      &lt;type&gt;pom&lt;/type&gt;
      &lt;scope&gt;import&lt;/scope&gt;
    &lt;/dependency&gt
  &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;
&lt;dependencies&gt
  &lt;dependency&gt;
    &lt;groupId&gt;com.typesafe.akka&lt;/groupId&gt;
    &lt;artifactId&gt;akka-cluster-tools_${scala.binary.version}&lt;/artifactId&gt;
  &lt;/dependency&gt
&lt;/dependencies&gt;</code></pre></dd><dt>Gradle</dt><dd><pre class="prettyprint"><code class="language-gradle">def versions = [
  ScalaBinary: "2.13"
]
dependencies {
  implementation platform("com.typesafe.akka:akka-bom_${versions.ScalaBinary}:2.6.13")

  implementation "com.typesafe.akka:akka-cluster-tools_${versions.ScalaBinary}"
}</code></pre></dd></dl>
<table class="project-info">
<tr><th colspan="2">Project Info: Akka Cluster Tools (classic)</th></tr>
  <tr><th>Artifact</th><td><div>com.typesafe.akka</div>
  <div>akka-cluster-tools</div>
  <div>2.6.13</div>
  <div><a href="project/links.html#snapshots-repository">Snapshots are available</a></div>
  </td></tr>
  <tr><th>JDK versions</th><td><div>Adopt OpenJDK 8</div><div>Adopt OpenJDK 11</div></td></tr>
  <tr><th>Scala versions</th><td>2.12.13, 2.13.3</td></tr>
  <tr><th>JPMS module name</th><td>akka.cluster.tools</td></tr>
  <tr><th>License</th><td><div><a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer">Apache-2.0</a></div>
  </td></tr>
  <tr><th>Readiness level</th><td><div class="readiness-level"><a href="https://developer.lightbend.com/docs/introduction/getting-help/support-terminology.html#supported" target="_blank" rel="noopener">Supported</a>, <a href="https://www.lightbend.com/lightbend-subscription" target="_blank" rel="noopener">Lightbend Subscription</a> provides support</div>
  <div>Since 2.3.0, 2014-03-05</div>
  </td></tr>
  <tr><th>Home page</th><td><a href="https://akka.io/">https://akka.io/</a></td></tr>
  <tr><th>API documentation</th><td>
  <div><a href="https://doc.akka.io/api/akka/2.6.13/akka/cluster/tools/index.html" target="_blank" rel="noopener noreferrer">API (Scaladoc)</a></div>
  <div><a href="https://doc.akka.io/japi/akka/2.6.13/akka/cluster/tools/package-summary.html" target="_blank" rel="noopener noreferrer">API (Javadoc)</a></div>
  </td></tr>
  <tr><th>Forums</th><td>
  <div><a href="https://discuss.akka.io" target="_blank" rel="noopener noreferrer">Lightbend Discuss</a></div>
  <div><a href="https://gitter.im/akka/akka" target="_blank" rel="noopener noreferrer">akka/akka Gitter channel</a></div>
  </td></tr>
  <tr><th>Release notes</th><td><a href="https://akka.io/blog/news-archive.html">akka.io blog</a></td></tr>
  <tr><th>Issues</th><td><a href="https://github.com/akka/akka/issues" target="_blank" rel="noopener noreferrer">Github issues</a></td></tr>
  <tr><th>Sources</th><td><a href="https://github.com/akka/akka" target="_blank" rel="noopener noreferrer">https://github.com/akka/akka</a></td></tr>
</table>

<h2><a href="#introduction" name="introduction" class="anchor"><span class="anchor-link"></span></a>Introduction</h2>

<p>An actor system that is not part of the cluster can communicate with actors somewhere in the cluster via the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span>, the client can run in an <code>ActorSystem</code> that is part of another cluster. It only needs to know the location of one (or more) nodes to use as initial contact points. It will establish a connection to a <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterReceptionist.html" title="akka.cluster.client.ClusterReceptionist"><code>ClusterReceptionist</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterReceptionist.html" title="akka.cluster.client.ClusterReceptionist"><code>ClusterReceptionist</code></a></span> somewhere in the cluster. It will monitor the connection to the receptionist and establish a new connection if the link goes down. When looking for a new receptionist it uses fresh contact points retrieved from previous establishment, or periodically refreshed contacts, i.e. not necessarily the initial contact points.</p>

<p>Using the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span> for communicating with a cluster from the outside requires that the system with the client can both connect and be connected to with Akka Remoting from all the nodes in the cluster with a receptionist. This creates a tight coupling in that the client and cluster systems may need to have the same version of both Akka, libraries, message classes, serializers and potentially even the JVM. In many cases it is a better solution to use a more explicit and decoupling protocol such as <a href="https://doc.akka.io/docs/akka-http/current/index.html">HTTP</a> or <a href="https://doc.akka.io/docs/akka-grpc/current/">gRPC</a>.</p>

<p>Additionally since Akka Remoting is primarily designed as a protocol for Akka Cluster there is no explicit resource management, when a <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span> has been used it will cause connections with the cluster until the ActorSystem is stopped (unlike other kinds of network clients). </p>

<p><span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span> should not be used when sending messages to actors that run within the same cluster. Similar functionality as the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span> is provided in a more efficient way by <a href="distributed-pub-sub.html">Distributed Publish Subscribe in Cluster</a> for actors that belong to the same cluster.</p>

<p>It is necessary that the connecting system has its <code>akka.actor.provider</code> set to <code>remote</code> or <code>cluster</code> when using the cluster client.</p>

<p>The receptionist is supposed to be started on all nodes, or all nodes with specified role, in the cluster. The receptionist can be started with the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterReceptionist.html" title="akka.cluster.client.ClusterReceptionist"><code>ClusterReceptionist</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterReceptionist.html" title="akka.cluster.client.ClusterReceptionist"><code>ClusterReceptionist</code></a></span> extension or as an ordinary actor.</p>

<p>You can send messages via the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span> to any actor in the cluster that is registered in the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/pubsub/DistributedPubSubMediator.html" title="akka.cluster.pubsub.DistributedPubSubMediator"><code>DistributedPubSubMediator</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/pubsub/DistributedPubSubMediator.html" title="akka.cluster.pubsub.DistributedPubSubMediator"><code>DistributedPubSubMediator</code></a></span> used by the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterReceptionist.html" title="akka.cluster.client.ClusterReceptionist"><code>ClusterReceptionist</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterReceptionist.html" title="akka.cluster.client.ClusterReceptionist"><code>ClusterReceptionist</code></a></span>. The <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span> provides methods for registration of actors that should be reachable from the client. Messages are wrapped in <code>ClusterClient.Send</code>, <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient$.html" title="akka.cluster.client.ClusterClient"><code>`ClusterClient.SendToAll`</code></a></span><span class="group-java"><code>ClusterClient.SendToAll</code></span> or <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient$.html" title="akka.cluster.client.ClusterClient"><code>`ClusterClient.Publish`</code></a></span><span class="group-java"><code>ClusterClient.Publish</code></span>.</p>

<p>Both the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span> and the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span> emit events that can be subscribed to. The <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span> sends out notifications in relation to having received a list of contact points from the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span>. One use of this list might be for the client to record its contact points. A client that is restarted could then use this information to supersede any previously configured contact points.</p>

<p>The <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span> sends out notifications in relation to having received a contact from a <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span>. This notification enables the server containing the receptionist to become aware of what clients are connected.</p>

<ol>
  <li>
    <p><strong>ClusterClient.Send</strong></p>
    <p>The message will be delivered to one recipient with a matching path, if any such exists. If several entries match the path the message will be delivered to one random destination. The sender of the message can specify that local affinity is preferred, i.e. the message is sent to an actor in the same local actor system as the used receptionist actor, if any such exists, otherwise random to any other matching entry.</p>
  </li>
  <li>
    <p><strong>ClusterClient.SendToAll</strong></p>
    <p>The message will be delivered to all recipients with a matching path.</p>
  </li>
  <li>
    <p><strong>ClusterClient.Publish</strong></p>
    <p>The message will be delivered to all recipients Actors that have been registered as subscribers to the named topic.</p>
  </li>
</ol>
<p>Response messages from the destination actor are tunneled via the receptionist to avoid inbound connections from other cluster nodes to the client:</p>
<ul>
  <li><span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/actor/Actor.html" title="akka.actor.Actor"><code>`sender()`</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/actor/Actor.html" title="akka.actor.Actor"><code>`getSender()`</code></a></span>, as seen by the destination actor, is not the client itself,  but the receptionist</li>
  <li><span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/actor/Actor.html" title="akka.actor.Actor"><code>`sender()`</code></a></span> <span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/actor/Actor.html" title="akka.actor.Actor"><code>`getSender()`</code></a></span> of the response messages, sent back from the destination and seen by the client,  is <code>deadLetters</code></li>
</ul>
<p>since the client should normally send subsequent messages via the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span>. It is possible to pass the original sender inside the reply messages if the client is supposed to communicate directly to the actor in the cluster.</p>
<p>While establishing a connection to a receptionist the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span> will buffer messages and send them when the connection is established. If the buffer is full the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span> will drop old messages when new messages are sent via the client. The size of the buffer is configurable and it can be disabled by using a buffer size of 0.</p>
<p>It&rsquo;s worth noting that messages can always be lost because of the distributed nature of these actors. As always, additional logic should be implemented in the destination (acknowledgement) and in the client (retry) actors to ensure at-least-once message delivery.</p>
<h2><a href="#an-example" name="an-example" class="anchor"><span class="anchor-link"></span></a>An Example</h2>
<p>On the cluster nodes first start the receptionist. Note, it is recommended to load the extension when the actor system is started by defining it in the <code>akka.extensions</code> configuration property:</p>
<pre><code>akka.extensions = [&quot;akka.cluster.client.ClusterClientReceptionist&quot;]
</code></pre>
<p>Next, register the actors that should be available for the client.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka/tree/v2.6.13/akka-cluster-tools/src/multi-jvm/scala/akka/cluster/client/ClusterClientSpec.scala#L268-L276" target="_blank" title="Go to snippet source">source</a><code class="language-scala">runOn(host1) {
  val serviceA = system.actorOf(Props[Service](), &quot;serviceA&quot;)
  ClusterClientReceptionist(system).registerService(serviceA)
}

runOn(host2, host3) {
  val serviceB = system.actorOf(Props[Service](), &quot;serviceB&quot;)
  ClusterClientReceptionist(system).registerService(serviceB)
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka/tree/v2.6.13/akka-cluster-tools/src/test/java/akka/cluster/client/ClusterClientTest.java#L44-L48" target="_blank" title="Go to snippet source">source</a><code class="language-java">ActorRef serviceA = system.actorOf(Props.create(Service.class), &quot;serviceA&quot;);
ClusterClientReceptionist.get(system).registerService(serviceA);

ActorRef serviceB = system.actorOf(Props.create(Service.class), &quot;serviceB&quot;);
ClusterClientReceptionist.get(system).registerService(serviceB);</code></pre></dd>
</dl>
<p>On the client you create the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span> actor and use it as a gateway for sending messages to the actors identified by their path (without address information) somewhere in the cluster.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka/tree/v2.6.13/akka-cluster-tools/src/multi-jvm/scala/akka/cluster/client/ClusterClientSpec.scala#L285-L291" target="_blank" title="Go to snippet source">source</a><code class="language-scala">runOn(client) {
  val c = system.actorOf(
    ClusterClient.props(ClusterClientSettings(system).withInitialContacts(initialContacts)),
    &quot;client&quot;)
  c ! ClusterClient.Send(&quot;/user/serviceA&quot;, &quot;hello&quot;, localAffinity = true)
  c ! ClusterClient.SendToAll(&quot;/user/serviceB&quot;, &quot;hi&quot;)
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka/tree/v2.6.13/akka-cluster-tools/src/test/java/akka/cluster/client/ClusterClientTest.java#L52-L58" target="_blank" title="Go to snippet source">source</a><code class="language-java">final ActorRef c =
    system.actorOf(
        ClusterClient.props(
            ClusterClientSettings.create(system).withInitialContacts(initialContacts())),
        &quot;client&quot;);
c.tell(new ClusterClient.Send(&quot;/user/serviceA&quot;, &quot;hello&quot;, true), ActorRef.noSender());
c.tell(new ClusterClient.SendToAll(&quot;/user/serviceB&quot;, &quot;hi&quot;), ActorRef.noSender());</code></pre></dd>
</dl>
<p>The <code>initialContacts</code> parameter is a <span class="group-scala"><code>Set[ActorPath]</code></span><span class="group-java"><code>Set&lt;ActorPath&gt;</code></span>, which can be created like this:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka/tree/v2.6.13/akka-cluster-tools/src/multi-jvm/scala/akka/cluster/client/ClusterClientSpec.scala#L200-L203" target="_blank" title="Go to snippet source">source</a><code class="language-scala">val initialContacts = Set(
  ActorPath.fromString(&quot;akka://OtherSys@host1:2552/system/receptionist&quot;),
  ActorPath.fromString(&quot;akka://OtherSys@host2:2552/system/receptionist&quot;))
val settings = ClusterClientSettings(system).withInitialContacts(initialContacts)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka/tree/v2.6.13/akka-cluster-tools/src/test/java/akka/cluster/client/ClusterClientTest.java#L32-L37" target="_blank" title="Go to snippet source">source</a><code class="language-java">Set&lt;ActorPath&gt; initialContacts() {
  return new HashSet&lt;ActorPath&gt;(
      Arrays.asList(
          ActorPaths.fromString(&quot;akka://OtherSys@host1:2552/system/receptionist&quot;),
          ActorPaths.fromString(&quot;akka://OtherSys@host2:2552/system/receptionist&quot;)));
}</code></pre></dd>
</dl>
<p>You will probably define the address information of the initial contact points in configuration or system property. See also <a href="cluster-client.html#cluster-client-config">Configuration</a>.</p>
<p>A more comprehensive sample is available in the tutorial named <span class="group-scala"><a href="https://github.com/typesafehub/activator-akka-distributed-workers">Distributed workers with Akka and Scala</a>.</span> <span class="group-java"><a href="https://github.com/typesafehub/activator-akka-distributed-workers-java">Distributed workers with Akka and Java</a>.</span></p>
<h2><a href="#clusterclientreceptionist-extension" name="clusterclientreceptionist-extension" class="anchor"><span class="anchor-link"></span></a>ClusterClientReceptionist Extension</h2>
<p>In the example above the receptionist is started and accessed with the <code>akka.cluster.client.ClusterClientReceptionist</code> extension. That is convenient and perfectly fine in most cases, but it can be good to know that it is possible to start the <code>akka.cluster.client.ClusterReceptionist</code> actor as an ordinary actor and you can have several different receptionists at the same time, serving different types of clients.</p>
<p>Note that the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span> uses the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/pubsub/DistributedPubSub.html" title="akka.cluster.pubsub.DistributedPubSub"><code>DistributedPubSub</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/pubsub/DistributedPubSub.html" title="akka.cluster.pubsub.DistributedPubSub"><code>DistributedPubSub</code></a></span> extension, which is described in <a href="distributed-pub-sub.html">Distributed Publish Subscribe in Cluster</a>.</p>
<p>It is recommended to load the extension when the actor system is started by defining it in the <code>akka.extensions</code> configuration property:</p>
<pre><code>akka.extensions = [&quot;akka.cluster.client.ClusterClientReceptionist&quot;]
</code></pre>
<h2><a href="#events" name="events" class="anchor"><span class="anchor-link"></span></a>Events</h2>
<p>As mentioned earlier, both the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span> and <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span> emit events that can be subscribed to. The following code snippet declares an actor that will receive notifications on contact points (addresses to the available receptionists), as they become available. The code illustrates subscribing to the events and receiving the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient.html" title="akka.cluster.client.ClusterClient"><code>ClusterClient</code></a></span> initial state.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka/tree/v2.6.13/akka-cluster-tools/src/multi-jvm/scala/akka/cluster/client/ClusterClientSpec.scala#L82-L100" target="_blank" title="Go to snippet source">source</a><code class="language-scala">class ClientListener(targetClient: ActorRef) extends Actor {
  override def preStart(): Unit =
    targetClient ! SubscribeContactPoints

  def receive: Receive =
    receiveWithContactPoints(Set.empty)

  def receiveWithContactPoints(contactPoints: Set[ActorPath]): Receive = {
    case ContactPoints(cps) =&gt;
      context.become(receiveWithContactPoints(cps))
    // Now do something with the up-to-date &quot;cps&quot;
    case ContactPointAdded(cp) =&gt;
      context.become(receiveWithContactPoints(contactPoints + cp))
    // Now do something with an up-to-date &quot;contactPoints + cp&quot;
    case ContactPointRemoved(cp) =&gt;
      context.become(receiveWithContactPoints(contactPoints - cp))
    // Now do something with an up-to-date &quot;contactPoints - cp&quot;
  }
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka/tree/v2.6.13/akka-cluster-tools/src/test/java/akka/cluster/client/ClusterClientTest.java#L72-L108" target="_blank" title="Go to snippet source">source</a><code class="language-java">public static class ClientListener extends AbstractActor {
  private final ActorRef targetClient;
  private final Set&lt;ActorPath&gt; contactPoints = new HashSet&lt;&gt;();

  public ClientListener(ActorRef targetClient) {
    this.targetClient = targetClient;
  }

  @Override
  public void preStart() {
    targetClient.tell(SubscribeContactPoints.getInstance(), sender());
  }

  @Override
  public Receive createReceive() {
    return receiveBuilder()
        .match(
            ContactPoints.class,
            msg -&gt; {
              contactPoints.addAll(msg.getContactPoints());
              // Now do something with an up-to-date &quot;contactPoints&quot;
            })
        .match(
            ContactPointAdded.class,
            msg -&gt; {
              contactPoints.add(msg.contactPoint());
              // Now do something with an up-to-date &quot;contactPoints&quot;
            })
        .match(
            ContactPointRemoved.class,
            msg -&gt; {
              contactPoints.remove(msg.contactPoint());
              // Now do something with an up-to-date &quot;contactPoints&quot;
            })
        .build();
  }
}</code></pre></dd>
</dl>
<p>Similarly we can have an actor that behaves in a similar fashion for learning what cluster clients are connected to a <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span>:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka/tree/v2.6.13/akka-cluster-tools/src/multi-jvm/scala/akka/cluster/client/ClusterClientSpec.scala#L121-L139" target="_blank" title="Go to snippet source">source</a><code class="language-scala">class ReceptionistListener(targetReceptionist: ActorRef) extends Actor {
  override def preStart(): Unit =
    targetReceptionist ! SubscribeClusterClients

  def receive: Receive =
    receiveWithClusterClients(Set.empty)

  def receiveWithClusterClients(clusterClients: Set[ActorRef]): Receive = {
    case ClusterClients(cs) =&gt;
      context.become(receiveWithClusterClients(cs))
    // Now do something with the up-to-date &quot;c&quot;
    case ClusterClientUp(c) =&gt;
      context.become(receiveWithClusterClients(clusterClients + c))
    // Now do something with an up-to-date &quot;clusterClients + c&quot;
    case ClusterClientUnreachable(c) =&gt;
      context.become(receiveWithClusterClients(clusterClients - c))
    // Now do something with an up-to-date &quot;clusterClients - c&quot;
  }
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka/tree/v2.6.13/akka-cluster-tools/src/test/java/akka/cluster/client/ClusterClientTest.java#L112-L148" target="_blank" title="Go to snippet source">source</a><code class="language-java">public static class ReceptionistListener extends AbstractActor {
  private final ActorRef targetReceptionist;
  private final Set&lt;ActorRef&gt; clusterClients = new HashSet&lt;&gt;();

  public ReceptionistListener(ActorRef targetReceptionist) {
    this.targetReceptionist = targetReceptionist;
  }

  @Override
  public void preStart() {
    targetReceptionist.tell(SubscribeClusterClients.getInstance(), sender());
  }

  @Override
  public Receive createReceive() {
    return receiveBuilder()
        .match(
            ClusterClients.class,
            msg -&gt; {
              clusterClients.addAll(msg.getClusterClients());
              // Now do something with an up-to-date &quot;clusterClients&quot;
            })
        .match(
            ClusterClientUp.class,
            msg -&gt; {
              clusterClients.add(msg.clusterClient());
              // Now do something with an up-to-date &quot;clusterClients&quot;
            })
        .match(
            ClusterClientUnreachable.class,
            msg -&gt; {
              clusterClients.remove(msg.clusterClient());
              // Now do something with an up-to-date &quot;clusterClients&quot;
            })
        .build();
  }
}</code></pre></dd>
</dl>
<a id="cluster-client-config"></a>
<h2><a href="#configuration" name="configuration" class="anchor"><span class="anchor-link"></span></a>Configuration</h2>
<p>The <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClientReceptionist.html" title="akka.cluster.client.ClusterClientReceptionist"><code>ClusterClientReceptionist</code></a></span> extension (or <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterReceptionistSettings.html" title="akka.cluster.client.ClusterReceptionistSettings"><code>ClusterReceptionistSettings</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterReceptionistSettings.html" title="akka.cluster.client.ClusterReceptionistSettings"><code>ClusterReceptionistSettings</code></a></span>) can be configured with the following properties:</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka/tree/v2.6.13/akka-cluster-tools/src/main/resources/reference.conf#L57-L91" target="_blank" title="Go to snippet source">source</a><code class="language-conf"># Settings for the ClusterClientReceptionist extension
akka.cluster.client.receptionist {
  # Actor name of the ClusterReceptionist actor, /system/receptionist
  name = receptionist

  # Start the receptionist on members tagged with this role.
  # All members are used if undefined or empty.
  role = &quot;&quot;

  # The receptionist will send this number of contact points to the client
  number-of-contacts = 3

  # The actor that tunnel response messages to the client will be stopped
  # after this time of inactivity.
  response-tunnel-receive-timeout = 30s
  
  # The id of the dispatcher to use for ClusterReceptionist actors.
  # If specified you need to define the settings of the actual dispatcher.
  use-dispatcher = &quot;akka.actor.internal-dispatcher&quot;

  # How often failure detection heartbeat messages should be received for
  # each ClusterClient
  heartbeat-interval = 2s

  # Number of potentially lost/delayed heartbeats that will be
  # accepted before considering it to be an anomaly.
  # The ClusterReceptionist is using the akka.remote.DeadlineFailureDetector, which
  # will trigger if there are no heartbeats within the duration
  # heartbeat-interval + acceptable-heartbeat-pause, i.e. 15 seconds with
  # the default settings.
  acceptable-heartbeat-pause = 13s

  # Failure detection checking interval for checking all ClusterClients
  failure-detection-interval = 2s
}</code></pre>
<p>The following configuration properties are read by the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClientSettings.html" title="akka.cluster.client.ClusterClientSettings"><code>ClusterClientSettings</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClientSettings.html" title="akka.cluster.client.ClusterClientSettings"><code>ClusterClientSettings</code></a></span> when created with a <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/actor/ActorSystem.html" title="akka.actor.ActorSystem"><code>`ActorSystem`</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/actor/ActorSystem.html" title="akka.actor.ActorSystem"><code>`ActorSystem`</code></a></span> parameter. It is also possible to amend the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClientSettings.html" title="akka.cluster.client.ClusterClientSettings"><code>ClusterClientSettings</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClientSettings.html" title="akka.cluster.client.ClusterClientSettings"><code>ClusterClientSettings</code></a></span> or create it from another config section with the same layout as below. <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClientSettings.html" title="akka.cluster.client.ClusterClientSettings"><code>ClusterClientSettings</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClientSettings.html" title="akka.cluster.client.ClusterClientSettings"><code>ClusterClientSettings</code></a></span> is a parameter to the <span class="group-scala"><a href="https://doc.akka.io/api/akka/2.6/akka/cluster/client/ClusterClient$.html" title="akka.cluster.client.ClusterClient"><code>`ClusterClient.props`</code></a></span><span class="group-java"><a href="https://doc.akka.io/japi/akka/2.6/akka/cluster/client/ClusterClient$.html" title="akka.cluster.client.ClusterClient"><code>`ClusterClient.props`</code></a></span> factory method, i.e. each client can be configured with different settings if needed.</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka/tree/v2.6.13/akka-cluster-tools/src/main/resources/reference.conf#L95-L139" target="_blank" title="Go to snippet source">source</a><code class="language-conf"># Settings for the ClusterClient
akka.cluster.client {
  # Actor paths of the ClusterReceptionist actors on the servers (cluster nodes)
  # that the client will try to contact initially. It is mandatory to specify
  # at least one initial contact. 
  # Comma separated full actor paths defined by a string on the form of
  # &quot;akka://system@hostname:port/system/receptionist&quot;
  initial-contacts = []
  
  # Interval at which the client retries to establish contact with one of 
  # ClusterReceptionist on the servers (cluster nodes)
  establishing-get-contacts-interval = 3s
  
  # Interval at which the client will ask the ClusterReceptionist for
  # new contact points to be used for next reconnect.
  refresh-contacts-interval = 60s
  
  # How often failure detection heartbeat messages should be sent
  heartbeat-interval = 2s
  
  # Number of potentially lost/delayed heartbeats that will be
  # accepted before considering it to be an anomaly.
  # The ClusterClient is using the akka.remote.DeadlineFailureDetector, which
  # will trigger if there are no heartbeats within the duration 
  # heartbeat-interval + acceptable-heartbeat-pause, i.e. 15 seconds with
  # the default settings.
  acceptable-heartbeat-pause = 13s
  
  # If connection to the receptionist is not established the client will buffer
  # this number of messages and deliver them the connection is established.
  # When the buffer is full old messages will be dropped when new messages are sent
  # via the client. Use 0 to disable buffering, i.e. messages will be dropped
  # immediately if the location of the singleton is unknown.
  # Maximum allowed buffer size is 10000.
  buffer-size = 1000

  # If connection to the receiptionist is lost and the client has not been
  # able to acquire a new connection for this long the client will stop itself.
  # This duration makes it possible to watch the cluster client and react on a more permanent
  # loss of connection with the cluster, for example by accessing some kind of
  # service registry for an updated set of initial contacts to start a new cluster client with.
  # If this is not wanted it can be set to &quot;off&quot; to disable the timeout and retry
  # forever.
  reconnect-timeout = off
}</code></pre>
<h2><a href="#failure-handling" name="failure-handling" class="anchor"><span class="anchor-link"></span></a>Failure handling</h2>
<p>When the cluster client is started it must be provided with a list of initial contacts which are cluster nodes where receptionists are running. It will then repeatedly (with an interval configurable by <code>establishing-get-contacts-interval</code>) try to contact those until it gets in contact with one of them. While running, the list of contacts are continuously updated with data from the receptionists (again, with an interval configurable with <code>refresh-contacts-interval</code>), so that if there are more receptionists in the cluster than the initial contacts provided to the client the client will learn about them.</p>
<p>While the client is running it will detect failures in its connection to the receptionist by heartbeats if more than a configurable amount of heartbeats are missed the client will try to reconnect to its known set of contacts to find a receptionist it can access.</p>
<h2><a href="#when-the-cluster-cannot-be-reached-at-all" name="when-the-cluster-cannot-be-reached-at-all" class="anchor"><span class="anchor-link"></span></a>When the cluster cannot be reached at all</h2>
<p>It is possible to make the cluster client stop entirely if it cannot find a receptionist it can talk to within a configurable interval. This is configured with the <code>reconnect-timeout</code>, which defaults to <code>off</code>. This can be useful when initial contacts are provided from some kind of service registry, cluster node addresses are entirely dynamic and the entire cluster might shut down or crash, be restarted on new addresses. Since the client will be stopped in that case a monitoring actor can watch it and upon <code>Terminate</code> a new set of initial contacts can be fetched and a new cluster client started.</p>
<h2><a href="#migration-to-akka-grpc" name="migration-to-akka-grpc" class="anchor"><span class="anchor-link"></span></a>Migration to Akka gRPC</h2>
<p>Cluster Client is deprecated and it is not advised to build new applications with it. As a replacement we recommend using <a href="https://doc.akka.io/docs/akka-grpc/current/">Akka gRPC</a> with an application-specific protocol. The benefits of this approach are:</p>
<ul>
  <li>Improved security by using TLS for gRPC (HTTP/2) versus exposing Akka Remoting outside the Akka Cluster</li>
  <li>Easier to update clients and servers independent of each other</li>
  <li>Improved protocol definition between client and server</li>
  <li>Usage of <a href="https://doc.akka.io/docs/akka-grpc/current/client/configuration.html#using-akka-discovery-for-endpoint-discovery">Akka gRPC Service Discovery</a></li>
  <li>Clients do not need to use Akka</li>
  <li>See also <a href="https://doc.akka.io/docs/akka-grpc/current/whygrpc.html#grpc-vs-akka-remoting">gRPC versus Akka Remoting</a></li>
</ul>
<h3><a href="#migrating-directly" name="migrating-directly" class="anchor"><span class="anchor-link"></span></a>Migrating directly</h3>
<p>Existing users of Cluster Client may migrate directly to Akka gRPC and use it as documented in <a href="https://doc.akka.io/docs/akka-grpc/current/">its documentation</a>.</p>
<h3><a href="#migrating-gradually" name="migrating-gradually" class="anchor"><span class="anchor-link"></span></a>Migrating gradually</h3>
<p>If your application extensively uses Cluster Client, a more gradual migration might be desired that requires less re-write of the application. That migration step is described in this section. We recommend migration directly if feasible, though.</p>
<p>An example is provided to illustrate an approach to migrate from the deprecated Cluster Client to Akka gRPC, with minimal changes to your existing code. The example is intended to be copied and adjusted to your needs. It will not be provided as a published artifact.</p>
<ul>
  <li><a href="https://github.com/akka/akka-samples/tree/2.6/akka-sample-cluster-client-grpc-scala">akka-samples/akka-sample-cluster-cluster-client-grpc-scala</a> implemented in Scala</li>
  <li><a href="https://github.com/akka/akka-samples/tree/2.6/akka-sample-cluster-client-grpc-java">akka-samples/akka-sample-cluster-cluster-client-grpc-java</a> implemented in Java</li>
</ul>
<p>The example is still using an actor on the client side to have an API that is very close to the original Cluster Client. The messages this actor can handle correspond to the <a href="distributed-pub-sub.html">Distributed Pub Sub</a> messages on the server side, such as <code>ClusterClient.Send</code> and <code>ClusterClient.Publish</code>.</p>
<p>The <code>ClusterClient</code> actor delegates those messages to the gRPC client, and on the server side those are translated and delegated to the destination actors that are registered via the <code>ClusterClientReceptionist</code> in the same way as in the original.</p>
<p>Akka gRPC is used as the transport for the messages between client and server, instead of Akka Remoting.</p>
<p>The application specific messages are wrapped and serialized with Akka Serialization, which means that care must be taken to keep wire compatibility when changing any messages used between the client and server. The Akka configuration of Akka serializers must be the same (or being compatible) on client and server.</p>
<h4><a href="#next-steps" name="next-steps" class="anchor"><span class="anchor-link"></span></a>Next steps</h4>
<p>After this first migration step from Cluster Client to Akka gRPC, you can start replacing calls to <code>ClusterClientReceptionistService</code> with new, application-specific gRPC endpoints.</p>
<h4><a href="#differences" name="differences" class="anchor"><span class="anchor-link"></span></a>Differences</h4>
<p>Aside from the underlying implementation using gRPC instead of Actor messages and Akka Remoting it&rsquo;s worth pointing out the following differences between the Cluster Client and the example emulating Cluster Client with Akka gRPC as transport.</p>
<h5><a href="#single-request-reply" name="single-request-reply" class="anchor"><span class="anchor-link"></span></a>Single request-reply</h5>
<p>For request-reply interactions when there is only one reply message for each request it is more efficient to use the <code>ClusterClient.AskSend</code> message instead of <code>ClusterClient.Send</code> as illustrated in the example. Then it doesn&rsquo;t have to setup a full bidirectional gRPC stream for each request but can use the <span class="group-scala"><code>Future</code></span><span class="group-java"><code>CompletionStage</code></span> based API.</p>
<h5><a href="#initial-contact-points" name="initial-contact-points" class="anchor"><span class="anchor-link"></span></a>Initial contact points</h5>
<p>Instead of configured initial contact points the <a href="https://doc.akka.io/docs/akka-grpc/current/client/configuration.html#using-akka-discovery-for-endpoint-discovery">Akka gRPC Service Discovery</a> can be used.</p>
<h5><a href="#failure-detection" name="failure-detection" class="anchor"><span class="anchor-link"></span></a>Failure detection</h5>
<p>Heartbeat messages and failure detection of the connections have been removed since that should be handled by the gRPC connections.</p>
</div>
</article>
<div class="row">
<div class="small-12 column">
<section class="nav-prev-next row">
<div class="nav-prev small-6 column">
<a href="distributed-pub-sub.html"><i class="icon-prev"></i> <span class="link-prev">Classic Distributed Publish Subscribe in Cluster</span></a>
</div>
<div class="nav-next small-6 column clearfix">
<a class="float-right" href="cluster-sharding.html">Classic Cluster Sharding <i class="icon-next"></i></a>
</div>
</section>
</div>
</div>
<div class="source-github row">
Found an error in this documentation? The source code for this page can be found <a href="https://github.com/akka/akka/tree/v2.6.13/akka-docs/src/main/paradox/cluster-client.md">here</a>.
Please feel free to edit and contribute a pull request.
</div>

<footer class="page-footer row clearfix">
<img class="akka-icon float-left show-for-medium" src="images/akka-icon.svg" />
<section class="copyright">
<div>Akka is Open Source and available under the Apache 2 License.</div>
<p class="legal">
&copy; 2011-2021 <a href="https://www.lightbend.com" target="_blank">Lightbend, Inc.</a> |
<a href="https://www.lightbend.com/legal/licenses" target="_blank">Licenses</a> |
<a href="https://www.lightbend.com/legal/terms" target="_blank">Terms</a> |
<a href="https://www.lightbend.com/legal/privacy" target="_blank">Privacy Policy</a> |
<a href="https://akka.io/cookie/" target="_blank">Cookie Listing</a> |
<a class="optanon-toggle-display">Cookie Settings</a>
</p>
</section>

</footer>
</section>
</main>
</div>

<script type="text/javascript" src="js/scrollsneak.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="js/groups.js"></script>
<script type="text/javascript" src="js/page.js"></script>
<script type="text/javascript" src="js/snippets.js"></script>
<script type="text/javascript" src="js/magellan.js"></script>
<script type="text/javascript" src="js/metadata-toggle.js"></script>

<style type="text/css">@import "lib/prettify/prettify.css";</style>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(){window.prettyPrint && prettyPrint()});
//]]></script>
<!-- Algolia docs search -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
<style>.algolia-autocomplete { display: block !important }</style>
<script type="text/javascript">
docsearch({
apiKey: '543bad5ad786495d9ccd445ed34ed082',
indexName: 'akka_io',
inputSelector: '#search',
algoliaOptions: {
hitsPerPage: 5
}
});

docsearch({
apiKey: '543bad5ad786495d9ccd445ed34ed082',
indexName: 'akka_io',
inputSelector: '#overlay-search',
algoliaOptions: {
hitsPerPage: 5
}
});

// set up "/" as global shortcut for focusing on search
jQuery(document).keypress(function (event) {
if (event.keyCode == 47) {
jQuery("#search").focus();
return false; // swallow key event, otherwise the / char would be input into the search box
}
});
</script>

<script type="text/javascript" src="assets/js/warnOldDocs.js"></script>
<script type="text/javascript" src="assets/js/scalafiddle.js"></script>


</body>
</html>
