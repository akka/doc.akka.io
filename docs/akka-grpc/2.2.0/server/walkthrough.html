<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Walkthrough &bull; Akka gRPC</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="Akka gRPC - Support for building streaming gRPC servers and clients on top of Akka Streams."/>
<link rel="canonical" href="https://doc.akka.io/docs/akka-grpc/current/server/walkthrough.html"/>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../lib/foundation/dist/js/foundation.min.js"></script>
<link rel="stylesheet" type="text/css" href="../lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="../lib/foundation/dist/css/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<link rel="stylesheet" type="text/css" href="../css/icons.css"/>
<link rel="stylesheet" type="text/css" href="../css/page-8.css"/>
<link rel="stylesheet" type="text/css" href="../css/banner-2.css"/>
<link rel="shortcut icon" href="../images/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="../images/apple-touch-icon.png"/>
<link rel="icon" type="image/png" sizes="32x32" href="../images/favicon-32x32.png"/>
<link rel="icon" type="image/png" sizes="16x16" href="../images/favicon-16x16.png"/>
<link rel="manifest" href="../images/manifest.json"/>
<meta name="msapplication-TileImage" content="../images/mstile-150x150.png"/>
<meta name="msapplication-TileColor" content="#15a9ce"/>
<meta name="theme-color" content="#15a9ce"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) start -->
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js"  type="text/javascript" charset="UTF-8" data-domain-script="28b912e7-09e9-43d5-91e4-3d1897044004" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice (Production Standard, akka.io, en-GB) end -->
<!--Google Analytics-->
<script type="text/plain" class="optanon-category-2">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', '']);
_gaq.push(['_setDomainName', '']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})()
</script>
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-2">
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KBJGH35');
</script>
<!--Marketo-->
<script type="text/plain" class="optanon-category-3">
(function() {
var didInit = false;
function initMunchkin() {
if(didInit === false) {
didInit = true;
Munchkin.init('558-NCX-702', { 'asyncOnly': true, 'disableClickDelay': true });
}
}
var s = document.createElement('script');
s.type = 'text/javascript';
s.async = true;
s.src = '//munchkin.marketo.net/munchkin.js';
s.onreadystatechange = function() {
if (this.readyState == 'complete' || this.readyState == 'loaded') {
initMunchkin();
}
};
s.onload = initMunchkin;
document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
</head>

<body id="underlay" data-toggler="nav-open">
<div id="lightbend-banner" class="lightbend-banner akka full-width" data-category="OSS Lightbend Banner Impression" data-label="Akka Banner Impression">
<div class="oss-wrapper">
<div class="oss-brand">
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Lightbend Logo - Akka Banner" href="https://www.lightbend.com">
<img class="lightbend-logo" src="../images/banner-logos/lightbend-reverse.svg" alt="Lightbend" title="Lightbend">
</a>
</div>
<div class="oss-ad no-drop-down">
<nav id="lightbendRotator" class="lightbend-rotator">
<a class="oss-track-link-label" data-category="OSS Lightbend Banner Clicks" data-label="Promo Rotator - Lightbend is Changing its Software Licensing Model for Akka Technology. [License FAQ] - Akka Banner" href="https://www.lightbend.com/akka/license-faq">
<strong>Lightbend</strong> is Changing its Software Licensing Model for Akka Technology. <span class="akka-btn">License FAQ</span>
</a>
</nav>
</div>
</div>
</div>

<header class="site-header hide-for-large">
<div class="sticky-header clearfix">
<a href="https://akka.io"><img class="logo" src="../images/akka-logo-reverse.svg"/></a>

<button class="menu-icon float-right" type="button" data-toggle="underlay overlay"></button>
</div>
<div id="overlay" class="overlay-nav" data-toggler="nav-open">
<header class="nav-header">
<div class="nav-header-title">
<h1><a href="../index.html">Akka gRPC</a></h1>
</div>
<div class="nav-header-version">
Version 2.2.0
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
<select class="supergroup" name="Buildtool"><option class="group" value="group-sbt">sbt</option><option class="group" value="group-gradle">Gradle</option><option class="group" value="group-maven">Maven</option></select>
</div>
</header>
<nav class="nav-toc">
<ul>
  <li><a href="../overview.html" class="page">Overview</a></li>
  <li><a href="../whygrpc.html" class="page">Why gRPC?</a></li>
  <li><a href="../getting-started.html" class="page">Getting started</a></li>
  <li><a href="../proto.html" class="page">Protobuf Service Descriptors</a></li>
  <li><a href="../server/index.html" class="page">Providing Services (Server)</a>
  <ul>
    <li><a href="../server/walkthrough.html#walkthrough" class="active page">Walkthrough</a>
    <ul>
      <li><a href="../server/walkthrough.html#setting-up" class="header">Setting up</a></li>
      <li><a href="../server/walkthrough.html#writing-a-service-definition" class="header">Writing a service definition</a></li>
      <li><a href="../server/walkthrough.html#generating-interfaces-and-stubs" class="header">Generating interfaces and stubs</a></li>
      <li><a href="../server/walkthrough.html#implementing-the-service" class="header">Implementing the service</a></li>
      <li><a href="../server/walkthrough.html#serving-the-service-with-akka-http" class="header">Serving the service with Akka HTTP</a></li>
      <li><a href="../server/walkthrough.html#serving-multiple-services" class="header">Serving multiple services</a></li>
      <li><a href="../server/walkthrough.html#running-the-server" class="header">Running the server</a></li>
      <li><a href="../server/walkthrough.html#stateful-services" class="header">Stateful services</a></li>
    </ul></li>
    <li><a href="../server/grpc-web.html" class="page">gRPC-Web</a></li>
    <li><a href="../server/reflection.html" class="page">Server Reflection</a></li>
    <li><a href="../server/akka-http.html" class="page">Akka HTTP interop</a></li>
    <li><a href="../server/details.html" class="page">Details</a></li>
    <li><a href="../server/kubernetes.html" class="page">Kubernetes</a></li>
  </ul></li>
  <li><a href="../client/index.html" class="page">Consuming Services (Client)</a></li>
  <li><a href="../buildtools/index.html" class="page">Build Tool Support</a></li>
  <li><a href="../binary-compatibility.html" class="page">Binary compatibility</a></li>
  <li><a href="../apidesign.html" class="page">API Design</a></li>
  <li><a href="../deploy.html" class="page">Deployment</a></li>
  <li><a href="../troubleshooting.html" class="page">Troubleshooting</a></li>
</ul>
</nav>
</div>
</header>
<div class="site-content-wrapper">
<aside class="sticky-sidebar show-for-large">
<header class="nav-header sticky-sidebar-header">
<div class="nav-header-title">
<h1><a href="../index.html">Akka gRPC</a></h1>
</div>
<div class="nav-header-version">
Version 2.2.0
</div>
<div class="nav-header-groups">
<select class="supergroup" name="Language"><option class="group" value="group-java">Java</option><option class="group" value="group-scala">Scala</option></select>
<select class="supergroup" name="Buildtool"><option class="group" value="group-sbt">sbt</option><option class="group" value="group-gradle">Gradle</option><option class="group" value="group-maven">Maven</option></select>
</div>
</header>
<nav class="site-nav sticky-sidebar-contents">
<div class="nav-toc">
<ul>
  <li><a href="../overview.html" class="page">Overview</a></li>
  <li><a href="../whygrpc.html" class="page">Why gRPC?</a></li>
  <li><a href="../getting-started.html" class="page">Getting started</a></li>
  <li><a href="../proto.html" class="page">Protobuf Service Descriptors</a></li>
  <li><a href="../server/index.html" class="page">Providing Services (Server)</a>
  <ul>
    <li><a href="../server/walkthrough.html#walkthrough" class="active page">Walkthrough</a>
    <ul>
      <li><a href="../server/walkthrough.html#setting-up" class="header">Setting up</a></li>
      <li><a href="../server/walkthrough.html#writing-a-service-definition" class="header">Writing a service definition</a></li>
      <li><a href="../server/walkthrough.html#generating-interfaces-and-stubs" class="header">Generating interfaces and stubs</a></li>
      <li><a href="../server/walkthrough.html#implementing-the-service" class="header">Implementing the service</a></li>
      <li><a href="../server/walkthrough.html#serving-the-service-with-akka-http" class="header">Serving the service with Akka HTTP</a></li>
      <li><a href="../server/walkthrough.html#serving-multiple-services" class="header">Serving multiple services</a></li>
      <li><a href="../server/walkthrough.html#running-the-server" class="header">Running the server</a></li>
      <li><a href="../server/walkthrough.html#stateful-services" class="header">Stateful services</a></li>
    </ul></li>
    <li><a href="../server/grpc-web.html" class="page">gRPC-Web</a></li>
    <li><a href="../server/reflection.html" class="page">Server Reflection</a></li>
    <li><a href="../server/akka-http.html" class="page">Akka HTTP interop</a></li>
    <li><a href="../server/details.html" class="page">Details</a></li>
    <li><a href="../server/kubernetes.html" class="page">Kubernetes</a></li>
  </ul></li>
  <li><a href="../client/index.html" class="page">Consuming Services (Client)</a></li>
  <li><a href="../buildtools/index.html" class="page">Build Tool Support</a></li>
  <li><a href="../binary-compatibility.html" class="page">Binary compatibility</a></li>
  <li><a href="../apidesign.html" class="page">API Design</a></li>
  <li><a href="../deploy.html" class="page">Deployment</a></li>
  <li><a href="../troubleshooting.html" class="page">Troubleshooting</a></li>
</ul>
</div>
</nav>
<footer class="nav-footer sticky-sidebar-footer">
<a href="https://akka.io"><img class="logo" src="../images/akka-logo-reverse.svg"/></a>

</footer>
</aside>
<main class="fixed-shift-for-large expanded row">
<section class="site-content small-12 column">
<article class="page-content row">
<div class="small-12 column" id="docs">
<h1><a href="#walkthrough" name="walkthrough" class="anchor"><span class="anchor-link"></span></a>Walkthrough</h1>
<h2><a href="#setting-up" name="setting-up" class="anchor"><span class="anchor-link"></span></a>Setting up</h2>
<p>To get started, you must obtain or write the <a href="../proto.html"><code>.proto</code></a> file(s) that describe the interface you want to implement and add those files to your project. Add <code>.proto</code> files to your project&rsquo;s <span class="group-sbt"><code>src/main/protobuf</code></span><span class="group-gradle"><code>src/main/proto</code></span><span class="group-maven"><code>src/main/proto</code></span> directory. (See the detailed chapters on <a href="../buildtools/sbt.html">sbt</a>, <a href="../buildtools/gradle.html">Gradle</a> and <a href="../buildtools/maven.html">Maven</a> for information on taking .proto definitions from dependencies)</p>
<p>Then add the Akka gRPC plugin to your build:</p>
<dl>
  <dt>sbt</dt>
  <dd>
  <pre class="prettyprint"><code class="language-scala">// in project/plugins.sbt:
addSbtPlugin(&quot;com.lightbend.akka.grpc&quot; % &quot;sbt-akka-grpc&quot; % &quot;2.2.0&quot;)
//
// in build.sbt:
enablePlugins(AkkaGrpcPlugin)
</code></pre></dd>
  <dt>Gradle</dt>
  <dd>
  <pre class="prettyprint"><code class="language-gradle">buildscript {
  repositories {
    mavenLocal()
    gradlePluginPortal()
  }
  dependencies {
    // see https://plugins.gradle.org/plugin/com.lightbend.akka.grpc.gradle
    // for the currently latest version.
    classpath &#39;gradle.plugin.com.lightbend.akka.grpc:akka-grpc-gradle-plugin:2.2.0&#39;
  }
}
plugins {
  id &#39;java&#39;
  id &#39;application&#39;
}
apply plugin: &#39;com.lightbend.akka.grpc.gradle&#39;
repositories {
  mavenLocal()
  mavenCentral()
}
</code></pre></dd>
  <dt>Maven</dt>
  <dd>
  <pre class="prettyprint"><code class="language-xml">&lt;project&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;name&gt;Project name&lt;/name&gt;
  &lt;groupId&gt;com.example&lt;/groupId&gt;
  &lt;artifactId&gt;my-grpc-app&lt;/artifactId&gt;
  &lt;version&gt;0.1-SNAPSHOT&lt;/version&gt;
  &lt;properties&gt;
    &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
    &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
    &lt;akka.grpc.version&gt;2.2.0&lt;/akka.grpc.version&gt;
    &lt;grpc.version&gt;1.48.1&lt;/grpc.version&gt;
    &lt;project.encoding&gt;UTF-8&lt;/project.encoding&gt;
  &lt;/properties&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.lightbend.akka.grpc&lt;/groupId&gt;
      &lt;artifactId&gt;akka-grpc-runtime_2.12&lt;/artifactId&gt;
      &lt;version&gt;${akka.grpc.version}&lt;/version&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;com.lightbend.akka.grpc&lt;/groupId&gt;
        &lt;artifactId&gt;akka-grpc-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;${akka.grpc.version}&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;generate&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;
</code></pre></dd>
</dl>
<p>For a complete overview of the configuration options see the chapter for your build tool, <a href="../buildtools/sbt.html">sbt</a>, <a href="../buildtools/gradle.html">Gradle</a> or <a href="../buildtools/maven.html">Maven</a>.</p>
<h3><a href="#dependencies" name="dependencies" class="anchor"><span class="anchor-link"></span></a>Dependencies</h3>
<p>The Akka gRPC plugin makes your code depend on the <code>akka-grpc-runtime</code> library.</p>
<p>The table below shows direct dependencies of it and the second tab shows all libraries it depends on transitively. Be aware that the <code>io.grpc.grpc-api</code> library depends on Guava.</p>
<dl class="dependencies"><dt>Direct dependencies</dt><dd><table>
  <thead><tr><th>Organization</th><th>Artifact</th><th>Version</th></thead>
  <tbody>
    <tr><td>com.google.protobuf</td><td>protobuf-java</td><td><a href="https://mvnrepository.com/artifact/com.google.protobuf/protobuf-java/3.21.1" target="_blank">3.21.1</a></td></tr>
    <tr><td>com.thesamet.scalapb</td><td>scalapb-runtime_2.12</td><td><a href="https://mvnrepository.com/artifact/com.thesamet.scalapb/scalapb-runtime_2.12/0.11.11" target="_blank">0.11.11</a></td></tr>
    <tr><td>com.typesafe.akka</td><td>akka-discovery_2.12</td><td><a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-discovery_2.12/2.7.0" target="_blank">2.7.0</a></td></tr>
    <tr><td>com.typesafe.akka</td><td>akka-http-core_2.12</td><td><a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-http-core_2.12/10.4.0" target="_blank">10.4.0</a></td></tr>
    <tr><td>com.typesafe.akka</td><td>akka-http_2.12</td><td><a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-http_2.12/10.4.0" target="_blank">10.4.0</a></td></tr>
    <tr><td>com.typesafe.akka</td><td>akka-stream_2.12</td><td><a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream_2.12/2.7.0" target="_blank">2.7.0</a></td></tr>
    <tr><td>io.grpc</td><td>grpc-core</td><td><a href="https://mvnrepository.com/artifact/io.grpc/grpc-core/1.48.1" target="_blank">1.48.1</a></td></tr>
    <tr><td>io.grpc</td><td>grpc-netty-shaded</td><td><a href="https://mvnrepository.com/artifact/io.grpc/grpc-netty-shaded/1.48.1" target="_blank">1.48.1</a></td></tr>
    <tr><td>io.grpc</td><td>grpc-protobuf</td><td><a href="https://mvnrepository.com/artifact/io.grpc/grpc-protobuf/1.48.1" target="_blank">1.48.1</a></td></tr>
    <tr><td>org.scala-lang</td><td>scala-library</td><td><a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a></td></tr>
  </tbody>
</table></dd>
<dt>Dependency tree</dt><dd><pre>
com.google.protobuf    protobuf-java    <a href="https://mvnrepository.com/artifact/com.google.protobuf/protobuf-java/3.21.1" target="_blank">3.21.1</a>
com.thesamet.scalapb    scalapb-runtime_2.12    <a href="https://mvnrepository.com/artifact/com.thesamet.scalapb/scalapb-runtime_2.12/0.11.11" target="_blank">0.11.11</a>    Apache 2
    com.google.protobuf    protobuf-java    <a href="https://mvnrepository.com/artifact/com.google.protobuf/protobuf-java/3.21.1" target="_blank">3.21.1</a>
    com.thesamet.scalapb    lenses_2.12    <a href="https://mvnrepository.com/artifact/com.thesamet.scalapb/lenses_2.12/0.11.11" target="_blank">0.11.11</a>    Apache 2
        org.scala-lang.modules    scala-collection-compat_2.12    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-collection-compat_2.12/2.7.0" target="_blank">2.7.0</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
    org.scala-lang.modules    scala-collection-compat_2.12    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-collection-compat_2.12/2.7.0" target="_blank">2.7.0</a>    Apache-2.0
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
com.typesafe.akka    akka-discovery_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-discovery_2.12/2.7.0" target="_blank">2.7.0</a>    BUSL-1.1
    com.typesafe.akka    akka-actor_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.12/2.7.0" target="_blank">2.7.0</a>    BUSL-1.1
        com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.2" target="_blank">1.4.2</a>    Apache-2.0
        org.scala-lang.modules    scala-java8-compat_2.12    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.12/0.8.0" target="_blank">0.8.0</a>    BSD 3-clause
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
com.typesafe.akka    akka-http-core_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-http-core_2.12/10.4.0" target="_blank">10.4.0</a>    BUSL-1.1
    com.typesafe.akka    akka-parsing_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-parsing_2.12/10.4.0" target="_blank">10.4.0</a>    BUSL-1.1
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
com.typesafe.akka    akka-http_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-http_2.12/10.4.0" target="_blank">10.4.0</a>    BUSL-1.1
    com.typesafe.akka    akka-http-core_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-http-core_2.12/10.4.0" target="_blank">10.4.0</a>    BUSL-1.1
        com.typesafe.akka    akka-parsing_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-parsing_2.12/10.4.0" target="_blank">10.4.0</a>    BUSL-1.1
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
com.typesafe.akka    akka-stream_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-stream_2.12/2.7.0" target="_blank">2.7.0</a>    BUSL-1.1
    com.typesafe.akka    akka-actor_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-actor_2.12/2.7.0" target="_blank">2.7.0</a>    BUSL-1.1
        com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.2" target="_blank">1.4.2</a>    Apache-2.0
        org.scala-lang.modules    scala-java8-compat_2.12    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-java8-compat_2.12/0.8.0" target="_blank">0.8.0</a>    BSD 3-clause
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
    com.typesafe.akka    akka-protobuf-v3_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe.akka/akka-protobuf-v3_2.12/2.7.0" target="_blank">2.7.0</a>    BUSL-1.1
    com.typesafe    ssl-config-core_2.12    <a href="https://mvnrepository.com/artifact/com.typesafe/ssl-config-core_2.12/0.4.3" target="_blank">0.4.3</a>    Apache-2.0
        com.typesafe    config    <a href="https://mvnrepository.com/artifact/com.typesafe/config/1.4.2" target="_blank">1.4.2</a>    Apache-2.0
        org.scala-lang.modules    scala-parser-combinators_2.12    <a href="https://mvnrepository.com/artifact/org.scala-lang.modules/scala-parser-combinators_2.12/1.1.2" target="_blank">1.1.2</a>    Apache-2.0
            org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
        org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
    org.reactivestreams    reactive-streams    <a href="https://mvnrepository.com/artifact/org.reactivestreams/reactive-streams/1.0.4" target="_blank">1.0.4</a>    MIT-0
    org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0
io.grpc    grpc-core    <a href="https://mvnrepository.com/artifact/io.grpc/grpc-core/1.48.1" target="_blank">1.48.1</a>    Apache 2.0
    com.google.android    annotations    <a href="https://mvnrepository.com/artifact/com.google.android/annotations/4.1.1.4" target="_blank">4.1.1.4</a>    Apache 2.0
    com.google.code.gson    gson    <a href="https://mvnrepository.com/artifact/com.google.code.gson/gson/2.9.0" target="_blank">2.9.0</a>    Apache-2.0
    com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
    com.google.guava    guava    <a href="https://mvnrepository.com/artifact/com.google.guava/guava/31.1-android" target="_blank">31.1-android</a>
        com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
        com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
        com.google.guava    failureaccess    <a href="https://mvnrepository.com/artifact/com.google.guava/failureaccess/1.0.1" target="_blank">1.0.1</a>
        com.google.guava    listenablefuture    <a href="https://mvnrepository.com/artifact/com.google.guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava" target="_blank">9999.0-empty-to-avoid-conflict-with-guava</a>
        com.google.j2objc    j2objc-annotations    <a href="https://mvnrepository.com/artifact/com.google.j2objc/j2objc-annotations/1.3" target="_blank">1.3</a>    The Apache Software License, Version 2.0
        org.checkerframework    checker-qual    <a href="https://mvnrepository.com/artifact/org.checkerframework/checker-qual/3.12.0" target="_blank">3.12.0</a>    The MIT License
    io.grpc    grpc-api    <a href="https://mvnrepository.com/artifact/io.grpc/grpc-api/1.48.1" target="_blank">1.48.1</a>    Apache 2.0
        com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
        com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
        com.google.guava    guava    <a href="https://mvnrepository.com/artifact/com.google.guava/guava/31.1-android" target="_blank">31.1-android</a>
            com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
            com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
            com.google.guava    failureaccess    <a href="https://mvnrepository.com/artifact/com.google.guava/failureaccess/1.0.1" target="_blank">1.0.1</a>
            com.google.guava    listenablefuture    <a href="https://mvnrepository.com/artifact/com.google.guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava" target="_blank">9999.0-empty-to-avoid-conflict-with-guava</a>
            com.google.j2objc    j2objc-annotations    <a href="https://mvnrepository.com/artifact/com.google.j2objc/j2objc-annotations/1.3" target="_blank">1.3</a>    The Apache Software License, Version 2.0
            org.checkerframework    checker-qual    <a href="https://mvnrepository.com/artifact/org.checkerframework/checker-qual/3.12.0" target="_blank">3.12.0</a>    The MIT License
        io.grpc    grpc-context    <a href="https://mvnrepository.com/artifact/io.grpc/grpc-context/1.48.1" target="_blank">1.48.1</a>    Apache 2.0
    io.perfmark    perfmark-api    <a href="https://mvnrepository.com/artifact/io.perfmark/perfmark-api/0.25.0" target="_blank">0.25.0</a>    Apache 2.0
    org.codehaus.mojo    animal-sniffer-annotations    <a href="https://mvnrepository.com/artifact/org.codehaus.mojo/animal-sniffer-annotations/1.21" target="_blank">1.21</a>
io.grpc    grpc-netty-shaded    <a href="https://mvnrepository.com/artifact/io.grpc/grpc-netty-shaded/1.48.1" target="_blank">1.48.1</a>    Apache 2.0
    com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
    com.google.guava    guava    <a href="https://mvnrepository.com/artifact/com.google.guava/guava/31.1-android" target="_blank">31.1-android</a>
        com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
        com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
        com.google.guava    failureaccess    <a href="https://mvnrepository.com/artifact/com.google.guava/failureaccess/1.0.1" target="_blank">1.0.1</a>
        com.google.guava    listenablefuture    <a href="https://mvnrepository.com/artifact/com.google.guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava" target="_blank">9999.0-empty-to-avoid-conflict-with-guava</a>
        com.google.j2objc    j2objc-annotations    <a href="https://mvnrepository.com/artifact/com.google.j2objc/j2objc-annotations/1.3" target="_blank">1.3</a>    The Apache Software License, Version 2.0
        org.checkerframework    checker-qual    <a href="https://mvnrepository.com/artifact/org.checkerframework/checker-qual/3.12.0" target="_blank">3.12.0</a>    The MIT License
    io.grpc    grpc-core    <a href="https://mvnrepository.com/artifact/io.grpc/grpc-core/1.48.1" target="_blank">1.48.1</a>    Apache 2.0
        com.google.android    annotations    <a href="https://mvnrepository.com/artifact/com.google.android/annotations/4.1.1.4" target="_blank">4.1.1.4</a>    Apache 2.0
        com.google.code.gson    gson    <a href="https://mvnrepository.com/artifact/com.google.code.gson/gson/2.9.0" target="_blank">2.9.0</a>    Apache-2.0
        com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
        com.google.guava    guava    <a href="https://mvnrepository.com/artifact/com.google.guava/guava/31.1-android" target="_blank">31.1-android</a>
            com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
            com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
            com.google.guava    failureaccess    <a href="https://mvnrepository.com/artifact/com.google.guava/failureaccess/1.0.1" target="_blank">1.0.1</a>
            com.google.guava    listenablefuture    <a href="https://mvnrepository.com/artifact/com.google.guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava" target="_blank">9999.0-empty-to-avoid-conflict-with-guava</a>
            com.google.j2objc    j2objc-annotations    <a href="https://mvnrepository.com/artifact/com.google.j2objc/j2objc-annotations/1.3" target="_blank">1.3</a>    The Apache Software License, Version 2.0
            org.checkerframework    checker-qual    <a href="https://mvnrepository.com/artifact/org.checkerframework/checker-qual/3.12.0" target="_blank">3.12.0</a>    The MIT License
        io.grpc    grpc-api    <a href="https://mvnrepository.com/artifact/io.grpc/grpc-api/1.48.1" target="_blank">1.48.1</a>    Apache 2.0
            com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
            com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
            com.google.guava    guava    <a href="https://mvnrepository.com/artifact/com.google.guava/guava/31.1-android" target="_blank">31.1-android</a>
                com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
                com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
                com.google.guava    failureaccess    <a href="https://mvnrepository.com/artifact/com.google.guava/failureaccess/1.0.1" target="_blank">1.0.1</a>
                com.google.guava    listenablefuture    <a href="https://mvnrepository.com/artifact/com.google.guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava" target="_blank">9999.0-empty-to-avoid-conflict-with-guava</a>
                com.google.j2objc    j2objc-annotations    <a href="https://mvnrepository.com/artifact/com.google.j2objc/j2objc-annotations/1.3" target="_blank">1.3</a>    The Apache Software License, Version 2.0
                org.checkerframework    checker-qual    <a href="https://mvnrepository.com/artifact/org.checkerframework/checker-qual/3.12.0" target="_blank">3.12.0</a>    The MIT License
            io.grpc    grpc-context    <a href="https://mvnrepository.com/artifact/io.grpc/grpc-context/1.48.1" target="_blank">1.48.1</a>    Apache 2.0
        io.perfmark    perfmark-api    <a href="https://mvnrepository.com/artifact/io.perfmark/perfmark-api/0.25.0" target="_blank">0.25.0</a>    Apache 2.0
        org.codehaus.mojo    animal-sniffer-annotations    <a href="https://mvnrepository.com/artifact/org.codehaus.mojo/animal-sniffer-annotations/1.21" target="_blank">1.21</a>
    io.perfmark    perfmark-api    <a href="https://mvnrepository.com/artifact/io.perfmark/perfmark-api/0.25.0" target="_blank">0.25.0</a>    Apache 2.0
io.grpc    grpc-protobuf    <a href="https://mvnrepository.com/artifact/io.grpc/grpc-protobuf/1.48.1" target="_blank">1.48.1</a>    Apache 2.0
    com.google.api.grpc    proto-google-common-protos    <a href="https://mvnrepository.com/artifact/com.google.api.grpc/proto-google-common-protos/2.9.0" target="_blank">2.9.0</a>    Apache-2.0
        com.google.protobuf    protobuf-java    <a href="https://mvnrepository.com/artifact/com.google.protobuf/protobuf-java/3.21.1" target="_blank">3.21.1</a>
    com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
    com.google.guava    guava    <a href="https://mvnrepository.com/artifact/com.google.guava/guava/31.1-android" target="_blank">31.1-android</a>
        com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
        com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
        com.google.guava    failureaccess    <a href="https://mvnrepository.com/artifact/com.google.guava/failureaccess/1.0.1" target="_blank">1.0.1</a>
        com.google.guava    listenablefuture    <a href="https://mvnrepository.com/artifact/com.google.guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava" target="_blank">9999.0-empty-to-avoid-conflict-with-guava</a>
        com.google.j2objc    j2objc-annotations    <a href="https://mvnrepository.com/artifact/com.google.j2objc/j2objc-annotations/1.3" target="_blank">1.3</a>    The Apache Software License, Version 2.0
        org.checkerframework    checker-qual    <a href="https://mvnrepository.com/artifact/org.checkerframework/checker-qual/3.12.0" target="_blank">3.12.0</a>    The MIT License
    com.google.protobuf    protobuf-java    <a href="https://mvnrepository.com/artifact/com.google.protobuf/protobuf-java/3.21.1" target="_blank">3.21.1</a>
    io.grpc    grpc-api    <a href="https://mvnrepository.com/artifact/io.grpc/grpc-api/1.48.1" target="_blank">1.48.1</a>    Apache 2.0
        com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
        com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
        com.google.guava    guava    <a href="https://mvnrepository.com/artifact/com.google.guava/guava/31.1-android" target="_blank">31.1-android</a>
            com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
            com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
            com.google.guava    failureaccess    <a href="https://mvnrepository.com/artifact/com.google.guava/failureaccess/1.0.1" target="_blank">1.0.1</a>
            com.google.guava    listenablefuture    <a href="https://mvnrepository.com/artifact/com.google.guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava" target="_blank">9999.0-empty-to-avoid-conflict-with-guava</a>
            com.google.j2objc    j2objc-annotations    <a href="https://mvnrepository.com/artifact/com.google.j2objc/j2objc-annotations/1.3" target="_blank">1.3</a>    The Apache Software License, Version 2.0
            org.checkerframework    checker-qual    <a href="https://mvnrepository.com/artifact/org.checkerframework/checker-qual/3.12.0" target="_blank">3.12.0</a>    The MIT License
        io.grpc    grpc-context    <a href="https://mvnrepository.com/artifact/io.grpc/grpc-context/1.48.1" target="_blank">1.48.1</a>    Apache 2.0
    io.grpc    grpc-protobuf-lite    <a href="https://mvnrepository.com/artifact/io.grpc/grpc-protobuf-lite/1.48.1" target="_blank">1.48.1</a>    Apache 2.0
        com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
        com.google.guava    guava    <a href="https://mvnrepository.com/artifact/com.google.guava/guava/31.1-android" target="_blank">31.1-android</a>
            com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
            com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
            com.google.guava    failureaccess    <a href="https://mvnrepository.com/artifact/com.google.guava/failureaccess/1.0.1" target="_blank">1.0.1</a>
            com.google.guava    listenablefuture    <a href="https://mvnrepository.com/artifact/com.google.guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava" target="_blank">9999.0-empty-to-avoid-conflict-with-guava</a>
            com.google.j2objc    j2objc-annotations    <a href="https://mvnrepository.com/artifact/com.google.j2objc/j2objc-annotations/1.3" target="_blank">1.3</a>    The Apache Software License, Version 2.0
            org.checkerframework    checker-qual    <a href="https://mvnrepository.com/artifact/org.checkerframework/checker-qual/3.12.0" target="_blank">3.12.0</a>    The MIT License
        io.grpc    grpc-api    <a href="https://mvnrepository.com/artifact/io.grpc/grpc-api/1.48.1" target="_blank">1.48.1</a>    Apache 2.0
            com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
            com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
            com.google.guava    guava    <a href="https://mvnrepository.com/artifact/com.google.guava/guava/31.1-android" target="_blank">31.1-android</a>
                com.google.code.findbugs    jsr305    <a href="https://mvnrepository.com/artifact/com.google.code.findbugs/jsr305/3.0.2" target="_blank">3.0.2</a>    The Apache Software License, Version 2.0
                com.google.errorprone    error_prone_annotations    <a href="https://mvnrepository.com/artifact/com.google.errorprone/error_prone_annotations/2.14.0" target="_blank">2.14.0</a>    Apache 2.0
                com.google.guava    failureaccess    <a href="https://mvnrepository.com/artifact/com.google.guava/failureaccess/1.0.1" target="_blank">1.0.1</a>
                com.google.guava    listenablefuture    <a href="https://mvnrepository.com/artifact/com.google.guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava" target="_blank">9999.0-empty-to-avoid-conflict-with-guava</a>
                com.google.j2objc    j2objc-annotations    <a href="https://mvnrepository.com/artifact/com.google.j2objc/j2objc-annotations/1.3" target="_blank">1.3</a>    The Apache Software License, Version 2.0
                org.checkerframework    checker-qual    <a href="https://mvnrepository.com/artifact/org.checkerframework/checker-qual/3.12.0" target="_blank">3.12.0</a>    The MIT License
            io.grpc    grpc-context    <a href="https://mvnrepository.com/artifact/io.grpc/grpc-context/1.48.1" target="_blank">1.48.1</a>    Apache 2.0
org.scala-lang    scala-library    <a href="https://mvnrepository.com/artifact/org.scala-lang/scala-library/2.12.17" target="_blank">2.12.17</a>    Apache-2.0</pre></dd>
</dl>

<h2><a href="#writing-a-service-definition" name="writing-a-service-definition" class="anchor"><span class="anchor-link"></span></a>Writing a service definition</h2>

<p>Define the interfaces you want to implement in your project&rsquo;s <span class="group-sbt"><code>src/main/protobuf</code></span><span class="group-gradle"><code>src/main/proto</code></span><span class="group-maven"><code>src/main/proto</code></span> file(s).</p>

<p>For example, this is the definition of a Hello World service:</p>

<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-grpc/tree/v2.2.0/plugin-tester-scala/src/main/protobuf/helloworld.proto" target="_blank" title="Go to snippet source">source</a><code class="language-proto">syntax = &quot;proto3&quot;;

import &quot;google/protobuf/timestamp.proto&quot;;

option java_multiple_files = true;
option java_package = &quot;example.myapp.helloworld.grpc&quot;;
option java_outer_classname = &quot;HelloWorldProto&quot;;

package helloworld;

////////////////////////////////////// The greeting service definition.
service GreeterService {
    //////////////////////
    // Sends a greeting //
    ////////*****/////////
    //      HELLO       //
    ////////*****/////////
    rpc SayHello (HelloRequest) returns (HelloReply) {}

    // Comment spanning
    // on several lines
    rpc ItKeepsTalking (stream HelloRequest) returns (HelloReply) {}

    /*
     * C style comments
     */
    rpc ItKeepsReplying (HelloRequest) returns (stream HelloReply) {}

    /* C style comments
     * on several lines
     * with non-empty heading/trailing line */
    rpc StreamHellos (stream HelloRequest) returns (stream HelloReply) {}
}

// The request message containing the user&#39;s name.
message HelloRequest {
    string name = 1;
}

// The response message containing the greetings
message HelloReply {
    string message = 1;
    google.protobuf.Timestamp timestamp = 2;
}</code></pre>
<h2><a href="#generating-interfaces-and-stubs" name="generating-interfaces-and-stubs" class="anchor"><span class="anchor-link"></span></a>Generating interfaces and stubs</h2>
<p>Start by generating code from the <code>.proto</code> definition with:</p>
<dl>
  <dt>sbt</dt>
  <dd>
  <pre><code>sbt compile
</code></pre></dd>
  <dt>Gradle</dt>
  <dd>
  <pre><code>./gradlew build
</code></pre></dd>
  <dt>Maven</dt>
  <dd>
  <pre><code>mvn akka-grpc:generate
</code></pre></dd>
</dl>
<p>From the above definition, Akka gRPC generates interfaces that look like this:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-grpc/tree/v2.2.0/plugin-tester-scala/target/scala-2.12/src_managed/main/example/myapp/helloworld/grpc/GreeterService.scala" target="_blank" title="Go to snippet source">source</a><code class="language-scala"><br/>// Generated by Akka gRPC. DO NOT EDIT.
package example.myapp.helloworld.grpc

import akka.annotation.ApiMayChange

import akka.grpc.AkkaGrpcGenerated

/**
 * #services
 * //////////////////////////////////// The greeting service definition.
 */
@AkkaGrpcGenerated
trait GreeterService {
  
  /**
   * ////////////////////
   * Sends a greeting //
   * //////&amp;#42;****&amp;#47;////////
   *      HELLO       //
   * //////&amp;#42;****&amp;#47;////////
   */
  def sayHello(in: example.myapp.helloworld.grpc.HelloRequest): scala.concurrent.Future[example.myapp.helloworld.grpc.HelloReply]
  
  /**
   * Comment spanning
   * on several lines
   */
  def itKeepsTalking(in: akka.stream.scaladsl.Source[example.myapp.helloworld.grpc.HelloRequest, akka.NotUsed]): scala.concurrent.Future[example.myapp.helloworld.grpc.HelloReply]
  
  /**
   *  C style comments
   */
  def itKeepsReplying(in: example.myapp.helloworld.grpc.HelloRequest): akka.stream.scaladsl.Source[example.myapp.helloworld.grpc.HelloReply, akka.NotUsed]
  
  /**
   * C style comments
   * on several lines
   * with non-empty heading/trailing line    */
  def streamHellos(in: akka.stream.scaladsl.Source[example.myapp.helloworld.grpc.HelloRequest, akka.NotUsed]): akka.stream.scaladsl.Source[example.myapp.helloworld.grpc.HelloReply, akka.NotUsed]
  
}



@AkkaGrpcGenerated
object GreeterService extends akka.grpc.ServiceDescription {
  val name = &quot;helloworld.GreeterService&quot;

  val descriptor: com.google.protobuf.Descriptors.FileDescriptor =
    example.myapp.helloworld.grpc.HelloworldProto.javaDescriptor;

  object Serializers {
    import akka.grpc.scaladsl.ScalapbProtobufSerializer
    
    val HelloRequestSerializer = new ScalapbProtobufSerializer(example.myapp.helloworld.grpc.HelloRequest.messageCompanion)
    
    val HelloReplySerializer = new ScalapbProtobufSerializer(example.myapp.helloworld.grpc.HelloReply.messageCompanion)
    
  }

  @ApiMayChange
  @AkkaGrpcGenerated
  object MethodDescriptors {
    import akka.grpc.internal.Marshaller
    import io.grpc.MethodDescriptor
    import Serializers._

    
    val sayHelloDescriptor: MethodDescriptor[example.myapp.helloworld.grpc.HelloRequest, example.myapp.helloworld.grpc.HelloReply] =
      MethodDescriptor.newBuilder()
        .setType(
   MethodDescriptor.MethodType.UNARY 
  
  
  
)
        .setFullMethodName(MethodDescriptor.generateFullMethodName(&quot;helloworld.GreeterService&quot;, &quot;SayHello&quot;))
        .setRequestMarshaller(new Marshaller(HelloRequestSerializer))
        .setResponseMarshaller(new Marshaller(HelloReplySerializer))
        .setSampledToLocalTracing(true)
        .build()
    
    val itKeepsTalkingDescriptor: MethodDescriptor[example.myapp.helloworld.grpc.HelloRequest, example.myapp.helloworld.grpc.HelloReply] =
      MethodDescriptor.newBuilder()
        .setType(
  
  MethodDescriptor.MethodType.CLIENT_STREAMING 
  
  
)
        .setFullMethodName(MethodDescriptor.generateFullMethodName(&quot;helloworld.GreeterService&quot;, &quot;ItKeepsTalking&quot;))
        .setRequestMarshaller(new Marshaller(HelloRequestSerializer))
        .setResponseMarshaller(new Marshaller(HelloReplySerializer))
        .setSampledToLocalTracing(true)
        .build()
    
    val itKeepsReplyingDescriptor: MethodDescriptor[example.myapp.helloworld.grpc.HelloRequest, example.myapp.helloworld.grpc.HelloReply] =
      MethodDescriptor.newBuilder()
        .setType(
  
  
   MethodDescriptor.MethodType.SERVER_STREAMING 
  
)
        .setFullMethodName(MethodDescriptor.generateFullMethodName(&quot;helloworld.GreeterService&quot;, &quot;ItKeepsReplying&quot;))
        .setRequestMarshaller(new Marshaller(HelloRequestSerializer))
        .setResponseMarshaller(new Marshaller(HelloReplySerializer))
        .setSampledToLocalTracing(true)
        .build()
    
    val streamHellosDescriptor: MethodDescriptor[example.myapp.helloworld.grpc.HelloRequest, example.myapp.helloworld.grpc.HelloReply] =
      MethodDescriptor.newBuilder()
        .setType(
  
  
  
  MethodDescriptor.MethodType.BIDI_STREAMING 
)
        .setFullMethodName(MethodDescriptor.generateFullMethodName(&quot;helloworld.GreeterService&quot;, &quot;StreamHellos&quot;))
        .setRequestMarshaller(new Marshaller(HelloRequestSerializer))
        .setResponseMarshaller(new Marshaller(HelloReplySerializer))
        .setSampledToLocalTracing(true)
        .build()
    
  }
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-grpc/tree/v2.2.0/plugin-tester-java/target/scala-2.12/src_managed/main/example/myapp/helloworld/grpc/GreeterService.java" target="_blank" title="Go to snippet source">source</a><code class="language-java"><br/>// Generated by Akka gRPC. DO NOT EDIT.
package example.myapp.helloworld.grpc;

import akka.grpc.ProtobufSerializer;
import akka.grpc.javadsl.GoogleProtobufSerializer;

import akka.grpc.AkkaGrpcGenerated;

/**
 * //////////////////////////////////// The greeting service definition.
 */
public interface GreeterService {
  
  /**
   * ////////////////////
   * Sends a greeting //
   * //////&amp;#42;****&amp;#47;////////
   *      HELLO       //
   * //////&amp;#42;****&amp;#47;////////
   */
  java.util.concurrent.CompletionStage&lt;example.myapp.helloworld.grpc.HelloReply&gt; sayHello(example.myapp.helloworld.grpc.HelloRequest in);
  
  /**
   * Comment spanning
   * on several lines
   */
  java.util.concurrent.CompletionStage&lt;example.myapp.helloworld.grpc.HelloReply&gt; itKeepsTalking(akka.stream.javadsl.Source&lt;example.myapp.helloworld.grpc.HelloRequest, akka.NotUsed&gt; in);
  
  /**
   *  C style comments
   */
  akka.stream.javadsl.Source&lt;example.myapp.helloworld.grpc.HelloReply, akka.NotUsed&gt; itKeepsReplying(example.myapp.helloworld.grpc.HelloRequest in);
  
  /**
   * C style comments
   * on several lines
   * with non-empty heading/trailing line    */
  akka.stream.javadsl.Source&lt;example.myapp.helloworld.grpc.HelloReply, akka.NotUsed&gt; streamHellos(akka.stream.javadsl.Source&lt;example.myapp.helloworld.grpc.HelloRequest, akka.NotUsed&gt; in);
  

  static String name = &quot;helloworld.GreeterService&quot;;
  static akka.grpc.ServiceDescription description = new akka.grpc.internal.ServiceDescriptionImpl(name, HelloWorldProto.getDescriptor());

  @AkkaGrpcGenerated
  public static class Serializers {
    
      public static ProtobufSerializer&lt;example.myapp.helloworld.grpc.HelloRequest&gt; HelloRequestSerializer = new GoogleProtobufSerializer&lt;&gt;(example.myapp.helloworld.grpc.HelloRequest.parser());
    
      public static ProtobufSerializer&lt;example.myapp.helloworld.grpc.HelloReply&gt; HelloReplySerializer = new GoogleProtobufSerializer&lt;&gt;(example.myapp.helloworld.grpc.HelloReply.parser());
    
  }
}</code></pre></dd>
</dl>
<p>and model <span class="group-scala">case </span>classes for <code>HelloRequest</code> and <code>HelloResponse</code>.</p>
<p>The service interface is the same for the client and the server side. On the server side, the service implements the interface, on the client side the Akka gRPC infrastructure implements a stub that will connect to the remote service when called.</p>
<p>There are 4 different types of calls:</p>
<ul>
  <li><strong>unary call</strong> - single request that returns a <span class="group-scala"><code>Future</code></span><span class="group-java"><code>CompletionStage</code></span> with a single response,  see <code>sayHello</code> in above example</li>
  <li><strong>client streaming call</strong> - <code>Source</code> (stream) of requests from the client that returns a  <span class="group-scala"><code>Future</code></span><span class="group-java"><code>CompletionStage</code></span> with a single response,  see <code>itKeepsTalking</code> in above example</li>
  <li><strong>server streaming call</strong> - single request that returns a <code>Source</code> (stream) of responses,  see <code>itKeepsReplying</code> in above example</li>
  <li><strong>client and server streaming call</strong> - <code>Source</code> (stream) of requests from the client that returns a  <code>Source</code> (stream) of responses,  see <code>streamHellos</code> in above example</li>
</ul>
<h2><a href="#implementing-the-service" name="implementing-the-service" class="anchor"><span class="anchor-link"></span></a>Implementing the service</h2>
<p>Let&rsquo;s implement these 4 calls in a new class:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-grpc/tree/v2.2.0/plugin-tester-scala/src/main/scala/example/myapp/helloworld/GreeterServiceImpl.scala#L6-L38" target="_blank" title="Go to snippet source">source</a><code class="language-scala">package example.myapp.helloworld

import scala.concurrent.Future
import akka.NotUsed
import akka.stream.Materializer
import akka.stream.scaladsl.Sink
import akka.stream.scaladsl.Source
import com.google.protobuf.timestamp.Timestamp
import example.myapp.helloworld.grpc._

class GreeterServiceImpl(implicit mat: Materializer) extends GreeterService {
  import mat.executionContext

  override def sayHello(in: HelloRequest): Future[HelloReply] = {
    println(s&quot;sayHello to ${in.name}&quot;)
    Future.successful(HelloReply(s&quot;Hello, ${in.name}&quot;, Some(Timestamp.apply(123456, 123))))
  }

  override def itKeepsTalking(in: Source[HelloRequest, NotUsed]): Future[HelloReply] = {
    println(s&quot;sayHello to in stream...&quot;)
    in.runWith(Sink.seq).map(elements =&gt; HelloReply(s&quot;Hello, ${elements.map(_.name).mkString(&quot;, &quot;)}&quot;))
  }

  override def itKeepsReplying(in: HelloRequest): Source[HelloReply, NotUsed] = {
    println(s&quot;sayHello to ${in.name} with stream of chars...&quot;)
    Source(s&quot;Hello, ${in.name}&quot;.toList).map(character =&gt; HelloReply(character.toString))
  }

  override def streamHellos(in: Source[HelloRequest, NotUsed]): Source[HelloReply, NotUsed] = {
    println(s&quot;sayHello to stream...&quot;)
    in.map(request =&gt; HelloReply(s&quot;Hello, ${request.name}&quot;))
  }
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-grpc/tree/v2.2.0/plugin-tester-java/src/main/java/example/myapp/helloworld/GreeterServiceImpl.java#L6-L65" target="_blank" title="Go to snippet source">source</a><code class="language-java">package example.myapp.helloworld;

import java.util.List;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.CompletionStage;
import java.util.stream.Collectors;

import akka.NotUsed;
import akka.stream.Materializer;
import akka.stream.javadsl.Sink;
import akka.stream.javadsl.Source;

import com.google.protobuf.Timestamp;
import example.myapp.helloworld.grpc.*;

public class GreeterServiceImpl implements GreeterService {
  private final Materializer mat;

  public GreeterServiceImpl(Materializer mat) {
   this.mat = mat;
  }

  @Override
  public CompletionStage&lt;HelloReply&gt; sayHello(HelloRequest in) {
    System.out.println(&quot;sayHello to &quot; + in.getName());
    HelloReply reply = HelloReply.newBuilder()
      .setMessage(&quot;Hello, &quot; + in.getName())
      .setTimestamp(Timestamp.newBuilder().setSeconds(1234567890).setNanos(12345).build())
      .build();
    return CompletableFuture.completedFuture(reply);
  }

  @Override
  public CompletionStage&lt;HelloReply&gt; itKeepsTalking(Source&lt;HelloRequest, NotUsed&gt; in) {
    System.out.println(&quot;sayHello to in stream...&quot;);
    return in.runWith(Sink.seq(), mat)
      .thenApply(elements -&gt; {
        String elementsStr = elements.stream().map(elem -&gt; elem.getName())
            .collect(Collectors.toList()).toString();
        return HelloReply.newBuilder().setMessage(&quot;Hello, &quot; + elementsStr).build();
      });
  }

  @Override
  public Source&lt;HelloReply, NotUsed&gt; itKeepsReplying(HelloRequest in) {
    System.out.println(&quot;sayHello to &quot; + in.getName() + &quot; with stream of chars&quot;);
    List&lt;Character&gt; characters = (&quot;Hello, &quot; + in.getName())
        .chars().mapToObj(c -&gt; (char) c).collect(Collectors.toList());
    return Source.from(characters)
      .map(character -&gt; {
        return HelloReply.newBuilder().setMessage(String.valueOf(character)).build();
      });
  }

  @Override
  public Source&lt;HelloReply, NotUsed&gt; streamHellos(Source&lt;HelloRequest, NotUsed&gt; in) {
    System.out.println(&quot;sayHello to stream...&quot;);
    return in.map(request -&gt; HelloReply.newBuilder().setMessage(&quot;Hello, &quot; + request.getName()).build());
  }
}</code></pre></dd>
</dl>
<h2><a href="#serving-the-service-with-akka-http" name="serving-the-service-with-akka-http" class="anchor"><span class="anchor-link"></span></a>Serving the service with Akka HTTP</h2>
<p>Note, how the implementation we just wrote is free from any gRPC related boilerplate. It only uses the generated model and interfaces from your domain and basic Akka streams classes. We now need to connect this implementation class to the web server to offer it to clients.</p>
<p>Akka gRPC servers are implemented with Akka HTTP. In addition to the above <code>GreeterService</code>, a <span class="group-scala"><code>GreeterServiceHandler</code></span><span class="group-java"><code>GreeterServiceHandlerFactory</code></span> was generated that wraps the implementation with the gRPC functionality to be plugged into an existing Akka HTTP server app.</p>
<p>You create the request handler by calling <span class="group-scala"><code>GreeterServiceHandler(yourImpl)</code></span><span class="group-java"><code>GreeterServiceHandlerFactory.create(yourImpl, ...)</code></span>.</p><div class="callout note "><div class="callout-title">Note</div>
<p>The server will reuse the given instance of the implementation, which means that it is shared between (potentially concurrent) requests. Make sure that the implementation is thread-safe. In the sample above there is no mutable state, so it is safe. For more information about safely implementing servers with state see the advice about <a href="#stateful-services">stateful</a> below.</p></div>
<p>A complete main program that starts an Akka HTTP server with the <code>GreeterService</code> looks like this:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-grpc/tree/v2.2.0/plugin-tester-scala/src/main/scala/example/myapp/helloworld/GreeterServer.scala#L6-L48" target="_blank" title="Go to snippet source">source</a><code class="language-scala">package example.myapp.helloworld

import akka.actor.ActorSystem
import akka.http.scaladsl.model.{ HttpRequest, HttpResponse }
import akka.http.scaladsl.Http
import com.typesafe.config.ConfigFactory
import example.myapp.helloworld.grpc._

import scala.concurrent.{ ExecutionContext, Future }

object GreeterServer {
  def main(args: Array[String]): Unit = {
    // Important: enable HTTP/2 in ActorSystem&#39;s config
    // We do it here programmatically, but you can also set it in the application.conf
    val conf = ConfigFactory
      .parseString(&quot;akka.http.server.preview.enable-http2 = on&quot;)
      .withFallback(ConfigFactory.defaultApplication())
    val system = ActorSystem(&quot;HelloWorld&quot;, conf)
    new GreeterServer(system).run()
    // ActorSystem threads will keep the app alive until `system.terminate()` is called
  }
}

class GreeterServer(system: ActorSystem) {
  def run(): Future[Http.ServerBinding] = {
    // Akka boot up code
    implicit val sys: ActorSystem = system
    implicit val ec: ExecutionContext = sys.dispatcher

    // Create service handlers
    val service: HttpRequest =&gt; Future[HttpResponse] =
      GreeterServiceHandler(new GreeterServiceImpl())

    // Bind service handler servers to localhost:8080/8081
    val binding = Http().newServerAt(&quot;127.0.0.1&quot;, 8080).bind(service)

    // report successful binding
    binding.foreach { binding =&gt; println(s&quot;gRPC server bound to: ${binding.localAddress}&quot;) }

    binding
  }
}
</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-grpc/tree/v2.2.0/plugin-tester-java/src/main/java/example/myapp/helloworld/GreeterServer.java#L6-L48" target="_blank" title="Go to snippet source">source</a><code class="language-java">package example.myapp.helloworld;

import akka.actor.ActorSystem;
import akka.http.javadsl.ConnectHttp;
import akka.http.javadsl.Http;
import akka.http.javadsl.ServerBinding;
import akka.stream.SystemMaterializer;
import akka.stream.Materializer;
import com.typesafe.config.Config;
import com.typesafe.config.ConfigFactory;
import example.myapp.helloworld.grpc.GreeterService;
import example.myapp.helloworld.grpc.GreeterServiceHandlerFactory;

import java.util.concurrent.CompletionStage;

class GreeterServer {
  public static void main(String[] args) throws Exception {
    // important to enable HTTP/2 in ActorSystem&#39;s config
    Config conf = ConfigFactory.parseString(&quot;akka.http.server.preview.enable-http2 = on&quot;)
            .withFallback(ConfigFactory.defaultApplication());

    // Akka ActorSystem Boot
    ActorSystem sys = ActorSystem.create(&quot;HelloWorld&quot;, conf);

    run(sys).thenAccept(binding -&gt; {
      System.out.println(&quot;gRPC server bound to: &quot; + binding.localAddress());
    });

    // ActorSystem threads will keep the app alive until `system.terminate()` is called
  }

  public static CompletionStage&lt;ServerBinding&gt; run(ActorSystem sys) throws Exception {
    Materializer mat = SystemMaterializer.get(sys).materializer();

    // Instantiate implementation
    GreeterService impl = new GreeterServiceImpl(mat);

    return Http
      .get(sys)
      .newServerAt(&quot;127.0.0.1&quot;, 8090)
      .bind(GreeterServiceHandlerFactory.create(impl, sys));
  }
}</code></pre></dd>
</dl><div class="callout note "><div class="callout-title">Note</div>
<p>It&rsquo;s important to enable HTTP/2 in Akka HTTP in the configuration of the <code>ActorSystem</code> by setting</p>
<pre><code>akka.http.server.preview.enable-http2 = on
</code></pre>
<p>In the example this was done from the <code>main</code> method, but you could also do this from within your <code>application.conf</code>.</p></div>
<p>The above example does not use TLS. Find more about how to <a href="../deploy.html">Serve gRPC over TLS</a> on the deployment section.</p>
<h2><a href="#serving-multiple-services" name="serving-multiple-services" class="anchor"><span class="anchor-link"></span></a>Serving multiple services</h2>
<p>When a server handles several services the handlers must be combined with <span class="group-scala"><code>akka.grpc.scaladsl.ServiceHandler.concatOrNotFound</code></span><span class="group-java"><code>akka.grpc.javadsl.ServiceHandler.concatOrNotFound</code></span>:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-grpc/tree/v2.2.0/plugin-tester-scala/src/main/scala/example/myapp/CombinedServer.scala#L21-L51" target="_blank" title="Go to snippet source">source</a><code class="language-scala">import akka.grpc.scaladsl.ServiceHandler

// explicit types not needed but included in example for clarity
val greeterService: PartialFunction[HttpRequest, Future[HttpResponse]] =
  example.myapp.helloworld.grpc.GreeterServiceHandler.partial(new GreeterServiceImpl())
val echoService: PartialFunction[HttpRequest, Future[HttpResponse]] =
  EchoServiceHandler.partial(new EchoServiceImpl)
val reflectionService = ServerReflection.partial(List(GreeterService, EchoService))
val serviceHandlers: HttpRequest =&gt; Future[HttpResponse] =
  ServiceHandler.concatOrNotFound(greeterService, echoService, reflectionService)

Http()
  .newServerAt(&quot;127.0.0.1&quot;, 8080)
  .bind(serviceHandlers)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-grpc/tree/v2.2.0/plugin-tester-java/src/main/java/example/myapp/CombinedServer.java#L18-L22" target="_blank" title="Go to snippet source">source</a><code class="language-java">import akka.grpc.javadsl.ServiceHandler;
import akka.http.javadsl.model.HttpRequest;
import akka.http.javadsl.model.HttpResponse;
import akka.japi.function.Function;

Function&lt;HttpRequest, CompletionStage&lt;HttpResponse&gt;&gt; greeterService =
    GreeterServiceHandlerFactory.create(new GreeterServiceImpl(mat), sys);
Function&lt;HttpRequest, CompletionStage&lt;HttpResponse&gt;&gt; echoService =
  EchoServiceHandlerFactory.create(new EchoServiceImpl(), sys);
@SuppressWarnings(&quot;unchecked&quot;)
Function&lt;HttpRequest, CompletionStage&lt;HttpResponse&gt;&gt; serviceHandlers =
  ServiceHandler.concatOrNotFound(greeterService, echoService);

Http.get(sys)
    .newServerAt(&quot;127.0.0.1&quot;, 8090)
    .bind(serviceHandlers)</code></pre></dd>
</dl>
<p><span class="group-scala">Note that <code>GreeterServiceHandler.partial</code> and <code>EchoServiceHandler.partial</code> are used instead of <code>apply</code> methods to create partial functions that are combined by <code>concatOrNotFound</code>.</span></p>
<h2><a href="#running-the-server" name="running-the-server" class="anchor"><span class="anchor-link"></span></a>Running the server</h2>
<p>To run the server with HTTP/2 using HTTPS on a JVM prior to version 1.8.0_251, you will likely have to configure the Jetty ALPN agent as described <a href="https://doc.akka.io/docs/akka-http/10.1/server-side/http2.html#application-layer-protocol-negotiation-alpn-">in the Akka HTTP documentation</a>. Later JVM versions have this support built-in.</p>
<p>See the detailed chapters on <a href="../buildtools/sbt.html#starting-your-akka-grpc-server-from-sbt">sbt</a>, <a href="../buildtools/gradle.html#starting-your-akka-grpc-server-from-gradle">Gradle</a> and <a href="../buildtools/maven.html#starting-your-akka-grpc-server-from-maven">Maven</a> for details on adding the agent.</p>
<h2><a href="#stateful-services" name="stateful-services" class="anchor"><span class="anchor-link"></span></a>Stateful services</h2>
<p>More often than not, the whole point of the implementing a service is to keep state. Since the service implementation is shared between concurrent incoming requests any state must be thread safe.</p>
<p>There are two recommended ways to deal with this:</p>
<ul>
  <li>Put the mutable state inside an actor and interact with it through <code>ask</code> from unary methods or <code>Flow.ask</code> from streams.</li>
  <li>Keep the state in a thread-safe place. For example, a CRUD application that is backed by a database is thread-safe  when access to the backing database is (which until recently was THE way that applications dealt with request  concurrency).</li>
</ul>
<p>This is an example based on the Hello World above, but allowing users to change the greeting through a unary call:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-grpc/tree/v2.2.0/plugin-tester-scala/src/main/scala/example/myapp/statefulhelloworld/GreeterServiceImpl.scala#L17-L34" target="_blank" title="Go to snippet source">source</a><code class="language-scala">class GreeterServiceImpl(system: ActorSystem) extends GreeterService {
  val greeterActor = system.actorOf(GreeterActor.props(&quot;Hello&quot;), &quot;greeter&quot;)

  def sayHello(in: HelloRequest): Future[HelloReply] = {
    // timeout and execution context for ask
    implicit val timeout: Timeout = 3.seconds
    import system.dispatcher

    (greeterActor ? GreeterActor.GetGreeting)
      .mapTo[GreeterActor.Greeting]
      .map(message =&gt; HelloReply(s&quot;${message.greeting}, ${in.name}&quot;))
  }

  def changeGreeting(in: ChangeRequest): Future[ChangeResponse] = {
    greeterActor ! GreeterActor.ChangeGreeting(in.newGreeting)
    Future.successful(ChangeResponse())
  }
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-grpc/tree/v2.2.0/plugin-tester-java/src/main/java/example/myapp/statefulhelloworld/GreeterServiceImpl.java#L18-L42" target="_blank" title="Go to snippet source">source</a><code class="language-java">public final class GreeterServiceImpl implements GreeterService {

  private final ActorSystem system;
  private final ActorRef greeterActor;

  public GreeterServiceImpl(ActorSystem system) {
    this.system = system;
    this.greeterActor = system.actorOf(GreeterActor.props(&quot;Hello&quot;), &quot;greeter&quot;);
  }

  public CompletionStage&lt;HelloReply&gt; sayHello(HelloRequest in) {
    return ask(greeterActor, GreeterActor.GET_GREETING, Duration.ofSeconds(5))
        .thenApply(message -&gt;
          HelloReply.newBuilder()
            .setMessage(((GreeterActor.Greeting) message).greeting)
            .build()
        );
  }

  public CompletionStage&lt;ChangeResponse&gt; changeGreeting(ChangeRequest in) {
    greeterActor.tell(new GreeterActor.ChangeGreeting(in.getNewGreeting()), ActorRef.noSender());
    return CompletableFuture.completedFuture(ChangeResponse.newBuilder().build());
  }

}</code></pre></dd>
</dl>
<p>The <code>GreeterActor</code> is implemented like this:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-grpc/tree/v2.2.0/plugin-tester-scala/src/main/scala/example/myapp/statefulhelloworld/GreeterActor.scala#L11-L30" target="_blank" title="Go to snippet source">source</a><code class="language-scala">object GreeterActor {
  case class ChangeGreeting(newGreeting: String)

  case object GetGreeting
  case class Greeting(greeting: String)

  def props(initialGreeting: String) = Props(new GreeterActor(initialGreeting))
}

class GreeterActor(initialGreeting: String) extends Actor {
  import GreeterActor._

  var greeting = Greeting(initialGreeting)

  def receive = {
    case GetGreeting =&gt; sender() ! greeting
    case ChangeGreeting(newGreeting) =&gt;
      greeting = Greeting(newGreeting)
  }
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/akka/akka-grpc/tree/v2.2.0/plugin-tester-java/src/main/java/example/myapp/statefulhelloworld/GreeterActor.java#L11-L53" target="_blank" title="Go to snippet source">source</a><code class="language-java">public class GreeterActor extends AbstractActor {

  public static class ChangeGreeting {
    public final String newGreeting;
    public ChangeGreeting(String newGreeting) {
      this.newGreeting = newGreeting;
    }
  }
  public static class GetGreeting {}
  public static GetGreeting GET_GREETING = new GetGreeting();

  public static class Greeting {
    public final String greeting;
    public Greeting(String greeting) {
      this.greeting = greeting;
    }
  }

  public static Props props(final String initialGreeting) {
    return Props.create(GreeterActor.class, () -&gt; new GreeterActor(initialGreeting));
  }

  private Greeting greeting;

  public GreeterActor(String initialGreeting) {
    greeting = new Greeting(initialGreeting);
  }

  public AbstractActor.Receive createReceive() {
    return receiveBuilder()
        .match(GetGreeting.class, this::onGetGreeting)
        .match(ChangeGreeting.class, this::onChangeGreeting)
        .build();
  }

  private void onGetGreeting(GetGreeting get) {
    getSender().tell(greeting, getSelf());
  }

  private void onChangeGreeting(ChangeGreeting change) {
    greeting = new Greeting(change.newGreeting);
  }
}</code></pre></dd>
</dl>
<p>Now the actor mailbox is used to synchronize accesses to the mutable state.</p>
</div>
</article>
<div class="row">
<div class="small-12 column">
<section class="nav-prev-next row">
<div class="nav-prev small-6 column">
<a href="../server/index.html"><i class="icon-prev"></i> <span class="link-prev">Providing Services (Server)</span></a>
</div>
<div class="nav-next small-6 column clearfix">
<a class="float-right" href="../server/grpc-web.html">gRPC-Web <i class="icon-next"></i></a>
</div>
</section>
</div>
</div>
<div class="source-github row">
Found an error in this documentation? The source code for this page can be found <a href="https://github.com/akka/akka-grpc/tree/v2.2.0/docs/src/main/paradox/server/walkthrough.md">here</a>.
Please feel free to edit and contribute a pull request.
</div>

<footer class="page-footer row clearfix">
<img class="akka-icon float-left show-for-medium" src="../images/akka-icon.svg" />
<section class="copyright">
<div>Akka gRPC is available under the <a href="https://www.lightbend.com/akka/license" target="_blank">Business Source License 1.1</a>.</div>
<p class="legal">
&copy; 2011-2022 <a href="https://www.lightbend.com" target="_blank">Lightbend, Inc.</a> |
<a href="https://www.lightbend.com/legal/licenses" target="_blank">Licenses</a> |
<a href="https://www.lightbend.com/legal/terms" target="_blank">Terms</a> |
<a href="https://www.lightbend.com/legal/privacy" target="_blank">Privacy Policy</a> |
<a href="https://akka.io/cookie/" target="_blank">Cookie Listing</a> |
<a class="optanon-toggle-display">Cookie Settings</a>
</p>
</section>

</footer>
</section>
</main>
</div>

<script type="text/javascript" src="../js/scrollsneak.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../js/groups.js"></script>
<script type="text/javascript" src="../js/page.js"></script>
<script type="text/javascript" src="../js/snippets.js"></script>
<script type="text/javascript" src="../js/magellan.js"></script>
<script type="text/javascript" src="../js/metadata-toggle.js"></script>
<script type="text/javascript" src="../js/lbHeader.js"></script>

<style type="text/css">@import "../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(){window.prettyPrint && prettyPrint()});
//]]></script>
<script type="text/javascript" src="../assets/js/warnOldVersion.js"></script>
<script type="text/javascript">//<![CDATA[
jQuery(function(jq){initOldVersionWarnings(jq, '2.2.0', 'https://doc.akka.io/docs/akka-grpc/current/')});
//]]></script>


</body>
</html>
